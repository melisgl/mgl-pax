\label{x-28DREF-3A-40DREF-MANUAL-20MGL-PAX-3ASECTION-29}

\subsubsection*{\normalfont\textcolor[HTML]{606060}{[in package DREF]}}

\section{Links and Systems}\label{links-and-systems}

\label{x-28DREF-3A-40LINKS-AND-SYSTEMS-20MGL-PAX-3ASECTION-29}

Here is the \href{https://github.com/melisgl/mgl-pax/dref}{official
repository} and the
\href{http://melisgl.github.io/mgl-pax-world/dref-manual.html}{HTML
documentation} for the latest version.

DRef is bundled in the same repository with PAX, the documentation
system.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/dref.asd\#L1}{system}\paxname{"dref"}\phantomsection\label{x-28-22dref-22-20ASDF-2FSYSTEM-3ASYSTEM-29}

  \begin{itemize}
  \item
    \emph{Version:} 0.4.1
  \item
    \emph{Description:} Reify definitions, provide portable access to
    docstrings and source locations in an extensible framework.
  \item
    \emph{Long Description:}
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm}{\texttt{defun}}
    defines a first-class object: a
    \texttt{function}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_fn.htm}{\texttt{0}}
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/s_fn.htm}{\texttt{1}}).
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defpar.htm}{\texttt{defvar}}
    does not. This library provides a way to refer to all definitions
    and smooths over the differences between implementations. This
    system has minimal dependencies. It autoloads the
    \paxlink{x-28-22dref-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29}{\texttt{dref/full}}
    \texttt{asdf:system}, which depends Alexandria and Swank.
  \item
    \emph{Licence:} MIT, see COPYING.
  \item
    \emph{Author:} GÃ¡bor Melis
  \item
    \emph{Mailto:}
    \href{mailto:mega@retes.hu}{\nolinkurl{mega@retes.hu}}
  \item
    \emph{Homepage:} \url{http://github.com/melisgl/mgl-pax/dref}
  \item
    \emph{Bug tracker:} \url{https://github.com/melisgl/mgl-pax/issues}
  \item
    \emph{Source control:}
    \href{https://github.com/melisgl/mgl-pax.git}{GIT}
  \item
    \emph{Depends on:} mgl-pax-bootstrap, named-readtables,
    pythonic-string-reader
  \item
    \emph{Defsystem depends on:} mgl-pax.asdf
  \end{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/dref.asd\#L1}{system}\paxname{"dref/full"}\phantomsection\label{x-28-22dref-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29}

  \begin{itemize}
  \item
    \emph{Description:}
    \texttt{dref}(\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{0}}
    \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{1}}) with everything
    loaded. There should be no need to explicitly load this system (or
    depend on it) as it is autoloaded as necessary by all publicly
    accessible functionality in \texttt{dref}.

    However, to get the dependencies, install this system.
  \item
    \emph{Depends on:} alexandria,
    \paxlink{x-28-22dref-22-20ASDF-2FSYSTEM-3ASYSTEM-29}{dref\texttt{}},
    swank(?)
  \item
    \emph{Defsystem depends on:} mgl-pax.asdf
  \end{itemize}
\end{itemize}

\section{Introduction}\label{introduction}

\label{x-28DREF-3A-40INTRODUCTION-20MGL-PAX-3ASECTION-29}

\emph{What if definitions were first-class objects?}

Some
\href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
forms} do not create first-class
\href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_o.htm\#object}{objects}.
For example,
\href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm}{\texttt{defun}}
creates
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_fn.htm}{\texttt{function}}
objects, but
\href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defpar.htm}{\texttt{defvar}}
does not create variable objects as no such thing exists. The main
purpose of this library is to fill this gap with the introduction of
\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} objects:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defvar}\FunctionTok{ *my{-}var* }\KeywordTok{nil}
  \StringTok{"This is my var."}\NormalTok{)}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}*my{-}var*} \DataTypeTok{\textquotesingle{}variable}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF *MY{-}VAR* VARIABLE\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{dref}s just package up a
\paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
(\texttt{*my-var*}) and a
\paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
(\paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}) then
check that the definition actually exists:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}junk} \DataTypeTok{\textquotesingle{}variable}\NormalTok{)}
\NormalTok{.. debugger invoked on LOCATE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ locate JUNK VARIABLE.}
\end{Highlighting}
\end{Shaded}

The
\paxlink{x-28DREF-3A-40BASIC-OPERATIONS-20MGL-PAX-3ASECTION-29}{Basic
Operations\texttt{}} on definitions in DRef are
\paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}},
\paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}} and
\paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(docstring (dref }\DataTypeTok{\textquotesingle{}*my{-}var*} \DataTypeTok{\textquotesingle{}variable}\NormalTok{))}
\OperatorTok{=\textgreater{}} \StringTok{"This is my var."}
\end{Highlighting}
\end{Shaded}

For definitions associated with objects, the definition can be
\paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d from the
object:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{print)}
\NormalTok{==\textgreater{} \#\textless{}DREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

These objects designate their definitions, so
\texttt{(docstring\ \#\textquotesingle{}print)} works. Extending DRef
and these operations is possible through
\paxlink{x-28DREF-EXT-3A-40DEFINING-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Defining
Locative Types\texttt{}}. It is also possible to define new operations.
For example, PAX makes \texttt{pax:document} extensible through
\texttt{pax:document-object*}.

Finally, existing definitions can be queried with
\paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}} and
\paxlink{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}{\texttt{dref-apropos}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\DataTypeTok{\textquotesingle{}dref{-}ext}\NormalTok{:locate*)}
\NormalTok{==\textgreater{} (\#\textless{}DREF LOCATE* GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (GLOSSARY{-}TERM))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (SECTION))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (READTABLE))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (PACKAGE))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (ASDF/SYSTEM:SYSTEM))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (CLASS))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (METHOD))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (GENERIC{-}FUNCTION))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (FUNCTION))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD (:AROUND) (T))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (T))}\OperatorTok{\textgreater{}}\NormalTok{ \#\textless{}DREF LOCATE* (METHOD NIL (XREF))}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF LOCATE* (METHOD NIL (DREF))}\OperatorTok{\textgreater{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\DataTypeTok{\textquotesingle{}locate{-}error}\NormalTok{ :package :dref)}
\NormalTok{==\textgreater{} (\#\textless{}DREF LOCATE{-}ERROR CONDITION\textgreater{} \#\textless{}DREF LOCATE{-}ERROR FUNCTION\textgreater{})}

\NormalTok{(dref{-}apropos }\StringTok{"ate{-}err"}\NormalTok{ :package :dref :external{-}only }\KeywordTok{t}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF LOCATE{-}ERROR CONDITION\textgreater{} \#\textless{}DREF LOCATE{-}ERROR FUNCTION\textgreater{})}
\end{Highlighting}
\end{Shaded}

\section{References}\label{references}

\label{x-28DREF-3A-40REFERENCES-20MGL-PAX-3ASECTION-29}

After the
\paxlink{x-28DREF-3A-40INTRODUCTION-20MGL-PAX-3ASECTION-29}{Introduction\texttt{}},
here we get into the details. Of special interest are:

\begin{itemize}
\item
  The \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{xref}} function to
  construct an arbitrary
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}
  without any checking of validity.
\item
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} and
  \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{dref}} to look up the
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  of an object (e.g \texttt{\#\textquotesingle{}print}) or a
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}
  (e.g.
  \texttt{(xref\ \textquotesingle{}print\ \textquotesingle{}function)}).
\item
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}} to find
  the first-class
  (non-\paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}) object the
  definition refers to, if any.
\end{itemize}

The
\paxlink{x-28DREF-3A-40BASIC-OPERATIONS-20MGL-PAX-3ASECTION-29}{Basic
Operations\texttt{}}
(\paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}},
\paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}},
\paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}})
know how to deal with references (discussed in the
\paxlink{x-28DREF-EXT-3A-40EXTENDING-DREF-20MGL-PAX-3ASECTION-29}{Extending
DRef\texttt{}}).

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L131}{class}\paxname{xref}\phantomsection\label{x-28DREF-3AXREF-20CLASS-29}

  An \texttt{xref} (cross-reference) is a
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}.
  It may represent some kind of
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  of its
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  in the context given by its
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}.
  The definition may not exist and the locative may even be
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{invalid\texttt{}}.
  The subclass \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}
  represents definitions that exist.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L167}{function}\paxname{xref}\phantomsection\label{x-28DREF-3AXREF-20FUNCTION-29}
  \emph{name locative}

  A shorthand for
  \texttt{(make-instance\ \textquotesingle{}xref\ :name\ name\ :locative\ locative)}
  to create \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}} objects.
  It does no error checking: the
  \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}{\texttt{locative-type}}
  of \texttt{locative-type} need not be defined, and the
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
  need not be valid. Use
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} or the
  \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{dref}} function to
  create \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} objects.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L176}{function}\paxname{xref=}\phantomsection\label{x-28DREF-3AXREF-3D-20FUNCTION-29}
  \emph{xref1 xref2}

  See if \texttt{xref1} and \texttt{xref2} have the same
  \paxlink{x-28DREF-3AXREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-name}}
  and
  \paxlink{x-28DREF-3AXREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-locative}}
  under
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_equal.htm}{\texttt{equal}}.
  Comparing like this makes most sense for
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s. However, two
  \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}s different under
  \texttt{xref=} may denote the same
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L193}{class}\paxname{dref}\phantomsection\label{x-28DREF-3ADREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3AXREF-20CLASS-29}{xref\texttt{}}}

  \texttt{dref}s can be thought of as
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}s
  that actually exist, although changes in the system can invalidate
  them (for example, a \texttt{dref} to a function definition can be
  invalidated by
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_fmakun.htm}{\texttt{fmakunbound}}).
  \texttt{dref}s must be created with
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} or the
  \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{dref}} function.

  Two \texttt{dref}s created in the same
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#dynamic_environment}{dynamic
  environment} denote the same thing if and only if they are
  \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L291}{function}\paxname{locate}\phantomsection\label{x-28DREF-3ALOCATE-20FUNCTION-29}
  \emph{object \&optional (errorp t)}

  Return a \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}
  representing the
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  of \texttt{object}.

  \texttt{object} must be a supported first-class object, a
  \texttt{dref}, or an
  \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{print)}
\NormalTok{==\textgreater{} \#\textless{}DREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate (locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{print))}
\NormalTok{==\textgreater{} \#\textless{}DREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate (xref }\DataTypeTok{\textquotesingle{}print} \DataTypeTok{\textquotesingle{}function}\NormalTok{))}
\NormalTok{==\textgreater{} \#\textless{}DREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

  When \texttt{object} is a \texttt{dref}, it is simply returned.

  Else, a
  \texttt{locate-error}(\paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{0}}
  \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20FUNCTION-29}{\texttt{1}}) is
  signalled if \texttt{object} is an \texttt{xref} with an invalid
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}},
  or if no corresponding definition is found. If \texttt{errorp} is
  \texttt{nil}, then \texttt{nil} is returned instead.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate (xref }\DataTypeTok{\textquotesingle{}no{-}such{-}function} \DataTypeTok{\textquotesingle{}function}\NormalTok{))}
\NormalTok{.. debugger invoked on LOCATE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ locate NO{-}SUCH{-}FUNCTION FUNCTION.}
\NormalTok{..   NO{-}SUCH{-}FUNCTION does }\KeywordTok{not}\NormalTok{ name a }\KeywordTok{function}\NormalTok{.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate (xref }\DataTypeTok{\textquotesingle{}print}\NormalTok{ \textquotesingle{}(}\KeywordTok{function}\NormalTok{ xxx)))}
\NormalTok{.. debugger invoked on LOCATE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ locate PRINT }\OperatorTok{\#\textquotesingle{}}\NormalTok{XXX.}
\NormalTok{..   Bad arguments (XXX) for locative FUNCTION with }\KeywordTok{lambda} \KeywordTok{list}\NormalTok{ NIL.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate }\StringTok{"xxx"}\NormalTok{)}
\NormalTok{.. debugger invoked on LOCATE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ locate }\StringTok{"xxx"}\NormalTok{.}
\end{Highlighting}
\end{Shaded}

  Use the \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{xref}}
  function to construct an \texttt{xref} without error checking.

  See
  \paxlink{x-28DREF-EXT-3A-40EXTENDING-LOCATE-20MGL-PAX-3ASECTION-29}{Extending
  \texttt{locate}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L346}{function}\paxname{dref}\phantomsection\label{x-28DREF-3ADREF-20FUNCTION-29}
  \emph{name locative \&optional (errorp t)}

  Shorthand for \texttt{(locate\ (xref\ name\ locative)\ errorp)}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L364}{function}\paxname{resolve}\phantomsection\label{x-28DREF-3ARESOLVE-20FUNCTION-29}
  \emph{object \&optional (errorp t)}

  If \texttt{object} is an
  \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}, then return the
  first-class object associated with its definition if any. Return
  \texttt{object} if it\textquotesingle s not an \texttt{xref}. Thus,
  the value returned is never an \texttt{xref}. The second return value
  is whether resolving succeeded.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve (dref }\DataTypeTok{\textquotesingle{}print} \DataTypeTok{\textquotesingle{}function}\NormalTok{))}
\NormalTok{==\textgreater{} \#\textless{}FUNCTION PRINT\textgreater{}}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve }\OperatorTok{\#\textquotesingle{}}\NormalTok{print)}
\NormalTok{==\textgreater{} \#\textless{}FUNCTION PRINT\textgreater{}}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}

  If \texttt{object} is an \texttt{xref}, and the definition for it
  cannot be \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d,
  then
  \texttt{locate-error}(\paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{0}}
  \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20FUNCTION-29}{\texttt{1}}) is
  signalled.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve (xref }\DataTypeTok{\textquotesingle{}undefined} \DataTypeTok{\textquotesingle{}variable}\NormalTok{))}
\NormalTok{.. debugger invoked on LOCATE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ locate UNDEFINED VARIABLE.}
\end{Highlighting}
\end{Shaded}

  If there is a definition, but there is no first-class object
  corresponding to it, then
  \texttt{resolve-error}(\paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20CONDITION-29}{\texttt{0}}
  \paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20FUNCTION-29}{\texttt{1}}) is
  signalled or \texttt{nil} is returned depending on \texttt{errorp}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve (dref }\DataTypeTok{\textquotesingle{}*print{-}length*} \DataTypeTok{\textquotesingle{}variable}\NormalTok{))}
\NormalTok{.. debugger invoked on RESOLVE{-}ERROR:}
\NormalTok{..   Could }\KeywordTok{not}\NormalTok{ resolve *PRINT{-}LENGTH* VARIABLE.}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve (dref }\DataTypeTok{\textquotesingle{}*print{-}length*} \DataTypeTok{\textquotesingle{}variable}\NormalTok{) }\KeywordTok{nil}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ NIL}
\OperatorTok{=\textgreater{}}\NormalTok{ NIL}
\end{Highlighting}
\end{Shaded}

  \texttt{resolve} is a partial inverse of \texttt{locate}: if a
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} is
  \texttt{resolve}able, then \texttt{locate}ing the object it resolves
  to recovers the \texttt{dref} equivalent to the original
  (\paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}} and of the
  same type but not
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_eq.htm}{\texttt{eq}}).

  Can be extended via
  \paxlink{x-28DREF-EXT-3ARESOLVE-2A-20GENERIC-FUNCTION-29}{\texttt{resolve*}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L254}{condition}\paxname{locate-error}\phantomsection\label{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}
  \emph{\href{http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm}{error}}

  Signalled by
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} when the
  definition cannot be found, and \texttt{errorp} is true.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L350}{condition}\paxname{resolve-error}\phantomsection\label{x-28DREF-EXT-3ARESOLVE-ERROR-20CONDITION-29}
  \emph{\href{http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm}{error}}

  Signalled by
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}} when the
  object defined cannot be returned, and \texttt{errorp} is true.
\end{itemize}

\subsection{Dissecting References}\label{dissecting-references}

\label{x-28DREF-3A-40DISSECTING-REFERENCES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L132}{reader}\paxname{xref-name}\phantomsection\label{x-28DREF-3AXREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}
  \emph{\paxlink{x-28DREF-3AXREF-20CLASS-29}{xref\texttt{}} (:name)}

  The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  of the reference.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L134}{reader}\paxname{xref-locative}\phantomsection\label{x-28DREF-3AXREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}
  \emph{\paxlink{x-28DREF-3AXREF-20CLASS-29}{xref\texttt{}} (:locative)}

  The
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
  of the reference.

  The locative is normalized by replacing single-element lists with
  their only element:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(xref }\DataTypeTok{\textquotesingle{}print} \DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}XREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(xref }\DataTypeTok{\textquotesingle{}print}\NormalTok{ \textquotesingle{}(}\KeywordTok{function}\NormalTok{))}
\NormalTok{==\textgreater{} \#\textless{}XREF PRINT FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L194}{reader}\paxname{dref-name}\phantomsection\label{x-28DREF-3ADREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  The same as
  \paxlink{x-28DREF-3AXREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-name}},
  but only works on
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s. Use it as a
  statement of intent.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L198}{reader}\paxname{dref-locative}\phantomsection\label{x-28DREF-3ADREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  The same as
  \paxlink{x-28DREF-3AXREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-locative}},
  but only works on
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s. Use it as a
  statement of intent.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L202}{reader}\paxname{dref-origin}\phantomsection\label{x-28DREF-3ADREF-ORIGIN-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  The object from which
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} constructed
  this \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}.
  \texttt{dref-origin} may have
  \paxlink{x-28DREF-3A-40PRESENTATION-20MGL-PAX-3AGLOSSARY-TERM-29}{presentation\texttt{}}
  arguments, which are not included in
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
  as is the case with the \texttt{initform} argument of the
  \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}
  locative:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}*standard{-}output*}\NormalTok{ \textquotesingle{}(variable }\StringTok{"see{-}below"}\NormalTok{))}
\NormalTok{==\textgreater{} \#\textless{}DREF *STANDARD{-}OUTPUT* VARIABLE\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}origin (dref }\DataTypeTok{\textquotesingle{}*standard{-}output*}\NormalTok{ \textquotesingle{}(variable }\StringTok{"see{-}below"}\NormalTok{)))}
\NormalTok{==\textgreater{} \#\textless{}XREF *STANDARD{-}OUTPUT* (VARIABLE }\StringTok{"see{-}below"}\NormalTok{)}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

  The \texttt{initform} argument overrides the global binding of
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/v_debug_.htm}{\texttt{*standard-output*}}
  when it\textquotesingle s \texttt{pax:document}ed:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(first{-}line}
\NormalTok{ (pax:document (dref }\DataTypeTok{\textquotesingle{}*standard{-}output*}\NormalTok{ \textquotesingle{}(variable }\StringTok{"see{-}below"}\NormalTok{))}
               \BuiltInTok{:stream} \KeywordTok{nil}\NormalTok{))}
\OperatorTok{=\textgreater{}} \StringTok{"{-} [variable] *STANDARD{-}OUTPUT* }\SpecialCharTok{\textbackslash{}"}\StringTok{see{-}below}\SpecialCharTok{\textbackslash{}"}\StringTok{"}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L439}{function}\paxname{locative-type}\phantomsection\label{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}
  \emph{locative}

  Return
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}} of the
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
  \texttt{locative}. This is the first element of \texttt{locative} if
  it\textquotesingle s a list. If it\textquotesingle s a symbol,
  it\textquotesingle s that symbol itself.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L447}{function}\paxname{locative-args}\phantomsection\label{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}
  \emph{locative}

  Return the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_rest.htm}{\texttt{rest}}
  of
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
  \texttt{locative} if it\textquotesingle s a list. If
  it\textquotesingle s a symbol, then return \texttt{nil}. See
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}.
\end{itemize}

The following convenience functions are compositions of
\{\paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}{\texttt{locative-type}},
\paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}\}
and
\{\paxlink{x-28DREF-3AXREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-locative}},
\paxlink{x-28DREF-3ADREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-locative}}\}.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L455}{function}\paxname{xref-locative-type}\phantomsection\label{x-28DREF-3AXREF-LOCATIVE-TYPE-20FUNCTION-29}
  \emph{xref}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L459}{function}\paxname{xref-locative-args}\phantomsection\label{x-28DREF-3AXREF-LOCATIVE-ARGS-20FUNCTION-29}
  \emph{xref}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L463}{function}\paxname{dref-locative-type}\phantomsection\label{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}
  \emph{dref}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L467}{function}\paxname{dref-locative-args}\phantomsection\label{x-28DREF-3ADREF-LOCATIVE-ARGS-20FUNCTION-29}
  \emph{dref}
\end{itemize}

\subsection{References Glossary}\label{references-glossary}

\label{x-28DREF-3A-40REFERENCES-GLOSSARY-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L479}{glossary-term}\paxname{reference}\phantomsection\label{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}

  A reference is a
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  plus a
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}},
  and it identifies a possible definition. References are of class
  \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}. When a reference
  is a \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}, it may also
  be called a definition.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L484}{glossary-term}\paxname{definition}\phantomsection\label{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}

  A definition is a
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}
  that identifies a concrete definition. Definitions are of class
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}. A definition
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}s to the
  first-class object associated with the definition if such a thing
  exists, and \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}
  on this object returns the canonical
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} object
  that\textquotesingle s unique under
  \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}.

  The kind of a definition is given by its
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}. There is at most one definition for any given
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  and locative type. Equivalently, there can be no two definitions of
  the same
  \paxlink{x-28DREF-3ADREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-name}}
  and
  \paxlink{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{dref-locative-type}}
  but different
  \paxlink{x-28DREF-3ADREF-LOCATIVE-ARGS-20FUNCTION-29}{\texttt{dref-locative-args}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L496}{glossary-term}\paxname{name}\phantomsection\label{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}

  Names are symbols, lists or strings which name
  \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{functions\texttt{}},
  \paxlink{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}{types\texttt{}},
  \paxlink{x-28PACKAGE-20MGL-PAX-3ALOCATIVE-29}{packages\texttt{}}, etc.
  Together with
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}s,
  they form
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}s.

  See
  \paxlink{x-28DREF-3AXREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-name}}
  and
  \paxlink{x-28DREF-3ADREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-name}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L503}{glossary-term}\paxname{locative}\phantomsection\label{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}

  Locatives specify a \emph{type} of definition such as
  \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{function}} or
  \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}.
  Together with
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}s,
  they form
  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}s.

  In their compound form, locatives may have arguments (see
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}})
  as in \texttt{(method\ ()\ (number))}. In fact, their atomic form is
  shorthand for the common no-argument case: that is, \texttt{function}
  is equivalent to \texttt{(function)}.

  A locative is valid if it names an existing
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}} and its \texttt{locative-args} match that
  type\textquotesingle s lambda-list (see
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist (dref }\DataTypeTok{\textquotesingle{}method} \DataTypeTok{\textquotesingle{}locative}\NormalTok{))}
\OperatorTok{=\textgreater{}}\NormalTok{ (METHOD{-}QUALIFIERS METHOD{-}SPECIALIZERS)}
\OperatorTok{=\textgreater{}}\NormalTok{ :DESTRUCTURING}
\end{Highlighting}
\end{Shaded}

  See
  \paxlink{x-28DREF-3AXREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-locative}}
  and
  \paxlink{x-28DREF-3ADREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-locative}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L525}{glossary-term}\paxname{locative type}\phantomsection\label{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}

  The locative type is the part of a
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
  that identifies what kind definition is being referred to. This is
  always a symbol.

  Locative types are defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}}
  or
  \paxlink{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-pseudo-locative-type}}.
  See
  \paxlink{x-28DREF-3A-40BASIC-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Basic
  Locative Types\texttt{}} for the list locative types built into DRef,
  and PAX Locatives for those in PAX.

  Also, see
  \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}{\texttt{locative-type}},
  \paxlink{x-28DREF-3AXREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{xref-locative-type}},
  \paxlink{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{dref-locative-type}},
  \paxlink{x-28DREF-EXT-3A-40DEFINING-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Defining
  Locative Types\texttt{}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L537}{glossary-term}\paxname{presentation}\phantomsection\label{x-28DREF-3A-40PRESENTATION-20MGL-PAX-3AGLOSSARY-TERM-29}

  \paxlink{x-28DREF-3A-40REFERENCE-20MGL-PAX-3AGLOSSARY-TERM-29}{reference\texttt{}}s
  may have arguments (see
  \paxlink{x-28DREF-EXT-3A-40DEFINING-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Defining
  Locative Types\texttt{}}) that do not affect the behaviour of
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} and the
  \paxlink{x-28DREF-3A-40BASIC-OPERATIONS-20MGL-PAX-3ASECTION-29}{Basic
  Operations\texttt{}}, but which may be used for other, "presentation"
  purposes. For example, the
  \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}
  locative\textquotesingle s \texttt{initform} argument is used for
  presentation by \texttt{pax:document}. Presentation arguments are
  available via
  \paxlink{x-28DREF-3ADREF-ORIGIN-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref:dref-origin}}
  but do not feature in
  \paxlink{x-28DREF-3ADREF-LOCATIVE-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-locative}}
  to ensure the uniqueness of the definition under
  \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}.
\end{itemize}

\section{\texorpdfstring{\texttt{dtype}s}{dtypes}}\label{dtypes}

\label{x-28DREF-3A-40DTYPES-20MGL-PAX-3ASECTION-29}

\texttt{dtype}s are to Lisp types what
\paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
type\texttt{}}s are to
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}es.
A \texttt{dtype} is either

\begin{itemize}
\item
  a
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}} such as
  \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{function}},
  \paxlink{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}{\texttt{type}} and
  \texttt{clhs}, or
\item
  a full
  \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative\texttt{}}
  such as \texttt{(method\ ()\ (number))} and \texttt{(clhs\ section)},
  or
\item
  \texttt{nil} (the empty \texttt{dtype}) and \texttt{t} (that
  encompasses all
  \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}),
  or
\item
  named with
  \paxlink{x-28DREF-3ADEFINE-DTYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-dtype}}
  (such as
  \paxlink{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}{\texttt{pseudo}} and
  \paxlink{x-28DREF-3ATOP-20DREF-3ADTYPE-29}{\texttt{top}}), or
\item
  a combination of the above with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_and.htm}{\texttt{and}},
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_or.htm}{\texttt{or}}
  and
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_not.htm}{\texttt{not}},
  or
\item
  a
  \texttt{member}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_mem_m.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_member.htm}{\texttt{1}})
  form with
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}able
  definitions, or
\item
  a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_satisf.htm}{\texttt{satisfies}}
  form with the name of a function that takes a single
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  as its argument.
\end{itemize}

\texttt{dtype}s are used in
\paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}} and
\paxlink{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}{\texttt{dref-apropos}}
to filter the set of definitions as in

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\DataTypeTok{\textquotesingle{}print}\NormalTok{ :dtype \textquotesingle{}(}\KeywordTok{not}\NormalTok{ unknown))}
\NormalTok{==\textgreater{} (\#\textless{}DREF PRINT (CLHS FUNCTION)}\OperatorTok{\textgreater{}}\NormalTok{ \#\textless{}DREF PRINT FUNCTION\textgreater{})}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\StringTok{"type specifier"}\NormalTok{ :dtype }\DataTypeTok{\textquotesingle{}pseudo}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF }\StringTok{"1.4.4.6"}\NormalTok{ \#}\DecValTok{1}\NormalTok{=(CLHS SECTION)}\OperatorTok{\textgreater{}}\NormalTok{ \#\textless{}DREF }\StringTok{"1.4.4.6.1"}\NormalTok{ \#}\DecValTok{1}\NormalTok{\#\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"1.4.4.6.2"}\NormalTok{ \#}\DecValTok{1}\NormalTok{\#\textgreater{} \#\textless{}DREF }\StringTok{"1.4.4.6.3"}\NormalTok{ \#}\DecValTok{1}\NormalTok{\#\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"1.4.4.6.4"}\NormalTok{ \#}\DecValTok{1}\NormalTok{\#\textgreater{} \#\textless{}DREF }\StringTok{"4.2.3"}\NormalTok{ \#}\DecValTok{1}\NormalTok{\#\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"atomic type specifier"}\NormalTok{ \#}\DecValTok{2}\NormalTok{=(CLHS GLOSSARY{-}TERM)}\OperatorTok{\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"compound type specifier"}\NormalTok{ \#}\DecValTok{2}\NormalTok{\#\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"derived type specifier"}\NormalTok{ \#}\DecValTok{2}\NormalTok{\#\textgreater{} \#\textless{}DREF }\StringTok{"type specifier"}\NormalTok{ \#}\DecValTok{2}\NormalTok{\#\textgreater{})}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/early.lisp\#L32}{macro}\paxname{define-dtype}\phantomsection\label{x-28DREF-3ADEFINE-DTYPE-20MGL-PAX-3AMACRO-29}
  \emph{name lambda-list \&body body}

  Like
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_deftp.htm}{\texttt{deftype}},
  but it may expand into other \texttt{dtype}s.

  The following example defines \texttt{method*} as the locative
  \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{\texttt{method}} without
  its direct locative subtypes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}dtype method* () \textquotesingle{}(}\KeywordTok{and} \KeywordTok{method}\NormalTok{ (}\KeywordTok{not}\NormalTok{ reader) (}\KeywordTok{not}\NormalTok{ writer)))}
\end{Highlighting}
\end{Shaded}

  See \paxlink{x-28DREF-3ADTYPEP-20FUNCTION-29}{\texttt{dtypep}} for the
  semantics and also the locative
  \paxlink{x-28DREF-3ADTYPE-20MGL-PAX-3ALOCATIVE-29}{\texttt{dtype}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/dtype.lisp\#L14}{dtype}\paxname{top}\phantomsection\label{x-28DREF-3ATOP-20DREF-3ADTYPE-29}

  This is the top of the \texttt{dtype} hierarchy, much like \texttt{t}
  for Lisp types. It expands to
  (\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_or.htm}{\texttt{or}}
  \texttt{t}
  \paxlink{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}{\texttt{pseudo}}). While
  \texttt{t} matches every normal Lisp object and objectless definitions
  present in the running Lisp (see
  \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}),
  \texttt{top} matches even pseudo definitions (see
  \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}}).
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/dtype.lisp\#L22}{dtype}\paxname{pseudo}\phantomsection\label{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}

  This is the union of all
  \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}}.
  It expands to \texttt{(or\ ,@(pseudo-locative-types))}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/dtype.lisp\#L28}{function}\paxname{dtypep}\phantomsection\label{x-28DREF-3ADTYPEP-20FUNCTION-29}
  \emph{dref dtype}

  See if \texttt{dref} is of \texttt{dtype}.

  \begin{itemize}
  \item
    \emph{\paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{Atomic
    locatives\texttt{}}:} If \texttt{dtype} is a
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}}, then it matches definitions with that locative type
    and its locative subtypes.

    Because
    \paxlink{x-28MGL-PAX-3ACONSTANT-20MGL-PAX-3ALOCATIVE-29}{\texttt{constant}}
    is defined with \texttt{variable} among its
    \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{
    \texttt{locative-supertypes}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dtypep (dref }\DataTypeTok{\textquotesingle{}pi} \DataTypeTok{\textquotesingle{}constant}\NormalTok{) }\DataTypeTok{\textquotesingle{}variable}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dtypep (dref }\DataTypeTok{\textquotesingle{}number} \DataTypeTok{\textquotesingle{}class}\NormalTok{) }\DataTypeTok{\textquotesingle{}type}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}

    It is an error if \texttt{dtype} is an
    \texttt{atom}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_atom.htm}{\texttt{0}}
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_atom.htm}{\texttt{1}})
    but is not a
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}}, but (the empty) argument list of bare locative types
    are not checked even if having no arguments makes them
    \paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{invalid
    locatives\texttt{}}.
  \item
    \emph{\paxlink{x-28DREF-3A-40LOCATIVE-20MGL-PAX-3AGLOSSARY-TERM-29}{Compound
    locatives\texttt{}}:} Locatives in their compound form are validated
    and must match exactly (under
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_equal.htm}{\texttt{equal}},
    as in \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defparameter}\FunctionTok{ *d* }\NormalTok{(dref }\DataTypeTok{\textquotesingle{}dref*}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (}\KeywordTok{t} \KeywordTok{t} \KeywordTok{t}\NormalTok{))))}
\NormalTok{(}\KeywordTok{defparameter}\FunctionTok{ *d2* }\NormalTok{(dref }\DataTypeTok{\textquotesingle{}dref*}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ (:around) (}\KeywordTok{t} \KeywordTok{t} \KeywordTok{t}\NormalTok{))))}
\NormalTok{(dtypep *d* }\DataTypeTok{\textquotesingle{}method}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\NormalTok{(dtypep *d* \textquotesingle{}(}\KeywordTok{method}\NormalTok{))}
\NormalTok{.. debugger invoked on SIMPLE{-}ERROR:}
\NormalTok{..   Bad arguments NIL for locative METHOD with }\KeywordTok{lambda} \KeywordTok{list}
\NormalTok{..   (METHOD{-}QUALIFIERS METHOD{-}SPECIALIZERS).}
\NormalTok{(dtypep *d* \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (}\KeywordTok{t} \KeywordTok{t} \KeywordTok{t}\NormalTok{)))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\NormalTok{(dtypep *d2* \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (}\KeywordTok{t} \KeywordTok{t} \KeywordTok{t}\NormalTok{)))}
\OperatorTok{=\textgreater{}}\NormalTok{ NIL}
\end{Highlighting}
\end{Shaded}
  \item
    \texttt{dtype} may be constructed with
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_and.htm}{\texttt{and}},
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_or.htm}{\texttt{or}}
    and
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_not.htm}{\texttt{not}}
    from Lisp types, locative types, full locatives and named
    \texttt{dtype}s:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dtypep (dref }\DataTypeTok{\textquotesingle{}locate{-}error} \DataTypeTok{\textquotesingle{}condition}\NormalTok{) \textquotesingle{}(}\KeywordTok{or} \KeywordTok{condition} \KeywordTok{class}\NormalTok{))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\NormalTok{(dtypep (dref }\KeywordTok{nil} \DataTypeTok{\textquotesingle{}type}\NormalTok{) \textquotesingle{}(}\KeywordTok{and} \KeywordTok{type}\NormalTok{ (}\KeywordTok{not} \KeywordTok{class}\NormalTok{)))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}
  \item
    For \texttt{(member\ \&rest\ objs)}, each of \texttt{obj}s is
    \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d and
    \texttt{dref} is matched against them with \texttt{xref=}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dtypep (locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{print) \textasciigrave{}(}\KeywordTok{member}\NormalTok{ ,}\OperatorTok{\#\textquotesingle{}}\NormalTok{print))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}
  \item
    For \texttt{(satisfies\ pred)}, the predicate \texttt{pred} is
    funcalled with \texttt{dref}.
  \item
    \texttt{dtype} may be named by
    \paxlink{x-28DREF-3ADEFINE-DTYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-dtype}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dtypep (locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{car) }\DataTypeTok{\textquotesingle{}top}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}
  \end{itemize}
\end{itemize}

\section{Listing Definitions}\label{listing-definitions}

\label{x-28DREF-3A-40LISTING-DEFINITIONS-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/late.lisp\#L5}{function}\paxname{definitions}\phantomsection\label{x-28DREF-3ADEFINITIONS-20FUNCTION-29}
  \emph{name \&key (dtype t)}

  List all definitions of \texttt{name} that are of \texttt{dtype} as
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}s\texttt{}}.

  Just as \texttt{(dref\ name\ locative)} returns the canonical
  definition, the
  \paxlink{x-28DREF-3ADREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-name}}s
  of returned by \texttt{definitions} may be different from
  \texttt{name}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\StringTok{"PAX"}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF }\StringTok{"MGL{-}PAX"}\NormalTok{ PACKAGE\textgreater{})}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\DataTypeTok{\textquotesingle{}mgl{-}pax}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF }\StringTok{"mgl{-}pax"}\NormalTok{ ASDF/SYSTEM:SYSTEM\textgreater{} \#\textless{}DREF }\StringTok{"MGL{-}PAX"}\NormalTok{ PACKAGE\textgreater{})}
\end{Highlighting}
\end{Shaded}

  Similarly,
  \paxlink{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{dref-locative-type}}
  may be more made more specific:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\DataTypeTok{\textquotesingle{}dref}\NormalTok{:locate{-}error :dtype }\DataTypeTok{\textquotesingle{}type}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF LOCATE{-}ERROR CONDITION\textgreater{})}
\end{Highlighting}
\end{Shaded}

  Can be extended via
  \paxlink{x-28DREF-EXT-3AMAP-DEFINITIONS-OF-NAME-20GENERIC-FUNCTION-29}{\texttt{map-definitions-of-name}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/late.lisp\#L43}{function}\paxname{dref-apropos}\phantomsection\label{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}
  \emph{name \&key package external-only case-sensitive (dtype t)}

  Return a list of \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s
  corresponding to existing definitions that match the various
  arguments. First, \texttt{(dref-apropos\ nil)} lists all definitions
  in the running Lisp and maybe more (e.g. \texttt{mgl-pax:clhs}).
  Arguments specify how the list of definitions is filtered.

  \texttt{dref-apropos} itself is similar to
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_apropo.htm}{\texttt{cl:apropos-list}},
  but

  \begin{itemize}
  \item
    it finds
    \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}s
    not
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_symbol.htm}{\texttt{symbol}}s,
  \item
    it supports an extensible definition types, and
  \item
    filtering based on them.
  \end{itemize}

  PAX has a live browsing frontend.

  Roughly speaking, when \texttt{name} or \texttt{package} is a
  \texttt{symbol}, they must match the whole
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  of the definition:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\DataTypeTok{\textquotesingle{}method}\NormalTok{ :package :dref :external{-}only }\KeywordTok{t}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF METHOD CLASS\textgreater{} \#\textless{}DREF METHOD LOCATIVE\textgreater{})}
\end{Highlighting}
\end{Shaded}

  On the other hand, when \texttt{name} or \texttt{package} is a
  \texttt{string}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_string.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_string.htm}{\texttt{1}}),
  they are matched as substrings to the definition\textquotesingle s
  name
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_wr_to_.htm}{\texttt{princ-to-string}}ed:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\StringTok{"method"}\NormalTok{ :package :dref :external{-}only }\KeywordTok{t}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF SETF{-}METHOD LOCATIVE\textgreater{} \#\textless{}DREF METHOD CLASS\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF METHOD LOCATIVE\textgreater{} \#\textless{}DREF METHOD{-}COMBINATION CLASS\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF METHOD{-}COMBINATION LOCATIVE\textgreater{})}
\end{Highlighting}
\end{Shaded}

  Definitions that are not of \texttt{dtype} (see
  \paxlink{x-28DREF-3ADTYPEP-20FUNCTION-29}{\texttt{dtypep}}) are
  filtered out:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\StringTok{"method"}\NormalTok{ :package :dref :external{-}only }\KeywordTok{t}\NormalTok{ :dtype }\DataTypeTok{\textquotesingle{}class}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF METHOD CLASS\textgreater{} \#\textless{}DREF METHOD{-}COMBINATION CLASS\textgreater{})}
\end{Highlighting}
\end{Shaded}

  When \texttt{package} is \texttt{:none}, only non-symbol
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}s
  are matched:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref{-}apropos }\StringTok{"dref"}\NormalTok{ :package :none)}
\NormalTok{==\textgreater{} (\#\textless{}DREF }\StringTok{"DREF"}\NormalTok{ PACKAGE\textgreater{} \#\textless{}DREF }\StringTok{"DREF{-}EXT"}\NormalTok{ PACKAGE\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"DREF{-}TEST"}\NormalTok{ PACKAGE\textgreater{} \#\textless{}DREF }\StringTok{"dref"}\NormalTok{ ASDF/SYSTEM:SYSTEM\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"dref/full"}\NormalTok{ ASDF/SYSTEM:SYSTEM\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"dref/test"}\NormalTok{ ASDF/SYSTEM:SYSTEM\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF }\StringTok{"dref/test{-}autoload"}\NormalTok{ ASDF/SYSTEM:SYSTEM\textgreater{})}
\end{Highlighting}
\end{Shaded}

  The exact rules of filtering are as follows. Let \texttt{c} be the
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  of the candidate definition from the list of all definitions that we
  are matching against the arguments and denote its string
  representation \texttt{(princ-to-string\ c)} with \texttt{p}. Note
  that \texttt{princ-to-string} does not print the package of symbols.
  We say that two strings \emph{match} if \texttt{case-sensitive} is
  \texttt{nil} and they are
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_equalp.htm}{\texttt{equalp}},
  or \texttt{case-sensitive} is true and they are
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_equal.htm}{\texttt{equal}}.
  \texttt{case-sensitive} affects \emph{substring} comparisons too.

  \begin{itemize}
  \item
    If \texttt{name} is a \texttt{symbol}, then its
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_symb_2.htm}{\texttt{symbol-name}}
    must \emph{match} \texttt{p}.
  \item
    If \texttt{name} is a \texttt{string}, then it must be a
    \emph{substring} of \texttt{p}.
  \item
    If \texttt{package} is \texttt{:any}, then \texttt{c} must be a
    \texttt{symbol}.
  \item
    If \texttt{package} is \texttt{:none}, then \texttt{c} must
    \emph{not} be a \texttt{symbol}.
  \item
    If \texttt{package} is not \texttt{nil}, \texttt{:any} or
    \texttt{:none}, then \texttt{c} must be a symbol.
  \item
    If \texttt{package} is a
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_pkg.htm}{\texttt{package}},
    it must be
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_eq.htm}{\texttt{eq}}
    to the
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_symb_3.htm}{\texttt{symbol-package}}
    of \texttt{c}.
  \item
    If \texttt{package} is a \texttt{symbol} other than \texttt{nil},
    \texttt{:any} and \texttt{:none}, then its \texttt{symbol-name} must
    \emph{match} the
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_pkg_na.htm}{\texttt{package-name}}
    or one of the
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_pkg_ni.htm}{\texttt{package-nicknames}}
    of \texttt{symbol-package} of \texttt{c}.
  \item
    If \texttt{package} is a \texttt{string}, then it must be a
    \emph{substring} of the \texttt{package-name} of
    \texttt{symbol-package} of \texttt{c}.
  \item
    If \texttt{external-only} and \texttt{c} is a symbol, then
    \texttt{c} must be external in a matching package.
  \item
    \texttt{dtype} matches candidate definition \texttt{d} if
    \texttt{(dtypep\ d\ dtype)}.
  \end{itemize}

  Can be extended via MAP-REFERENCES-OF-TYPE and
  \paxlink{x-28DREF-EXT-3AMAP-DEFINITIONS-OF-NAME-20GENERIC-FUNCTION-29}{\texttt{map-definitions-of-name}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L609}{glossary-term}\paxname{reverse definition order}\phantomsection\label{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}

  Lists of
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}s and aliases are sometimes in reverse order of the time
  of their definition. This order is not affected by redefinition,
  regardless of whether it\textquotesingle s by
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}},
  \paxlink{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-pseudo-locative-type}},
  \paxlink{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-symbol-locative-type}}
  or
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-ALIAS-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-alias}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L665}{function}\paxname{locative-types}\phantomsection\label{x-28DREF-3ALOCATIVE-TYPES-20FUNCTION-29}

  Return a list of
  non-\paxlink{x-28DREF-3ALOCATIVE-ALIASES-20FUNCTION-29}{alias\texttt{}}
  locative types. This is the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_unionc.htm}{\texttt{union}}
  of
  \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}
  and
  \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}},
  which is the set of constituents of the \texttt{dtype}
  \paxlink{x-28DREF-3ATOP-20DREF-3ADTYPE-29}{\texttt{top}}.

  This list is in
  \paxlink{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}{reverse
  definition order\texttt{}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L673}{function}\paxname{lisp-locative-types}\phantomsection\label{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}

  Return the locative types that correspond to Lisp definitions, which
  typically have
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}.
  These are defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}}
  and
  \paxlink{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-symbol-locative-type}}
  and are the constituents of \texttt{dtype} \texttt{t}.

  This list is in
  \paxlink{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}{reverse
  definition order\texttt{}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L682}{function}\paxname{pseudo-locative-types}\phantomsection\label{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}

  Return the locative types that correspond to non-Lisp definitions.
  These are the ones defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-pseudo-locative-type}}
  and are the constituents of \texttt{dtype}
  \paxlink{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}{\texttt{pseudo}}.

  This list is in
  \paxlink{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}{reverse
  definition order\texttt{}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L690}{function}\paxname{locative-aliases}\phantomsection\label{x-28DREF-3ALOCATIVE-ALIASES-20FUNCTION-29}

  Return the list of locatives aliases, defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-ALIAS-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-alias}}.

  This list is in
  \paxlink{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}{reverse
  definition order\texttt{}}.
\end{itemize}

\section{Basic Operations}\label{basic-operations}

\label{x-28DREF-3A-40BASIC-OPERATIONS-20MGL-PAX-3ASECTION-29}

The following functions take a single argument, which may be a
\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}, or an object
denoting its own definition (see
\paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}).

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L748}{function}\paxname{arglist}\phantomsection\label{x-28DREF-3AARGLIST-20FUNCTION-29}
  \emph{object}

  Return the arglist of the definition of \texttt{object} or
  \texttt{nil} if the arglist cannot be determined.

  The second return value indicates whether the arglist has been found.
  As the second return value, \texttt{:ordinary} indicates an
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_o.htm\#ordinary_lambda_list}{ordinary
  lambda list}, \texttt{:macro} a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_m.htm\#macro_lambda_list}{macro
  lambda list}, \texttt{:deftype} a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#deftype_lambda_list}{deftype
  lambda list}, and \texttt{:destructuring} a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#destructuring_lambda_list}{destructuring
  lambda list}. Other non-\texttt{nil} values are also allowed.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist }\OperatorTok{\#\textquotesingle{}}\NormalTok{arglist)}
\OperatorTok{=\textgreater{}}\NormalTok{ (OBJECT)}
\OperatorTok{=\textgreater{}}\NormalTok{ :ORDINARY}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist (dref }\DataTypeTok{\textquotesingle{}define{-}locative{-}type} \DataTypeTok{\textquotesingle{}macro}\NormalTok{))}
\OperatorTok{=\textgreater{}}\NormalTok{ (LOCATIVE{-}TYPE{-}AND{-}LAMBDA{-}LIST LOCATIVE{-}SUPERTYPES \&OPTIONAL}
\NormalTok{    DOCSTRING DREF{-}DEFCLASS{-}FORM)}
\OperatorTok{=\textgreater{}}\NormalTok{ :MACRO}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist (dref }\DataTypeTok{\textquotesingle{}method} \DataTypeTok{\textquotesingle{}locative}\NormalTok{))}
\OperatorTok{=\textgreater{}}\NormalTok{ (METHOD{-}QUALIFIERS METHOD{-}SPECIALIZERS)}
\OperatorTok{=\textgreater{}}\NormalTok{ :DESTRUCTURING}
\end{Highlighting}
\end{Shaded}

  This function supports
  \paxlink{x-28MGL-PAX-3AMACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{macro}s\texttt{}},
  \paxlink{x-28COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{compiler-macro}s\texttt{}},
  \paxlink{x-28SETF-20MGL-PAX-3ALOCATIVE-29}{\texttt{setf}} functions,
  \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{function}s\texttt{}},
  \paxlink{x-28GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{generic-function}s\texttt{}},
  \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{\texttt{method}s\texttt{}},
  \paxlink{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}{\texttt{type}s\texttt{}},
  \paxlink{x-28MGL-PAX-3ALOCATIVE-20MGL-PAX-3ALOCATIVE-29}{\texttt{locative}s\texttt{}}.
  Note that \texttt{arglist} depends on the quality of
  \texttt{swank-backend:arglist}. With the exception of SBCL, which has
  perfect support, all Lisp implementations have minor omissions:

  \begin{itemize}
  \item
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_deftp.htm}{\texttt{deftype}}
    lambda lists on ABCL, AllegroCL, CLISP, CCL, CMUCL, ECL;
  \item
    default values in \texttt{macro} lambda lists on AllegroCL;
  \item
    various edge cases involving traced functions.
  \end{itemize}

  Can be extended via
  \paxlink{x-28DREF-EXT-3AARGLIST-2A-20GENERIC-FUNCTION-29}{\texttt{arglist*}}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L794}{function}\paxname{docstring}\phantomsection\label{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}
  \emph{object}

  Return the docstring from the definition of \texttt{object}. As the
  second value, return the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/v_pkg.htm}{\texttt{*package*}}
  that was in effect when the docstring was installed or \texttt{nil} if
  it cannot be determined (this is used by \texttt{pax:document} when
  Parsing the docstring). This function is similar in purpose to
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_docume.htm}{\texttt{cl:documentation}}.

  Note that some locative types such as
  \paxlink{x-28ASDF-2FSYSTEM-3ASYSTEM-20MGL-PAX-3ALOCATIVE-29}{\texttt{asdf:system}s\texttt{}}
  and
  \paxlink{x-28DECLARATION-20MGL-PAX-3ALOCATIVE-29}{\texttt{declaration}s\texttt{}}
  have no docstrings, and some Lisp implementations do not record all
  docstrings. The following are known to be missing:

  \begin{itemize}
  \item
    \paxlink{x-28COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{compiler-macro}}
    docstrings on ABCL, AllegroCL, CCL, ECL;
  \item
    \paxlink{x-28METHOD-COMBINATION-20MGL-PAX-3ALOCATIVE-29}{\texttt{method-combination}}
    docstrings on ABCL, AllegroCL.
  \end{itemize}

  Can be extended via
  \paxlink{x-28DREF-EXT-3ADOCSTRING-2A-20GENERIC-FUNCTION-29}{\texttt{docstring*}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/dref.lisp\#L817}{function}\paxname{source-location}\phantomsection\label{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}
  \emph{object \&key error}

  Return the Swank source location for the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} of \texttt{object}.

  The returned Swank location object is to be accessed only through the
  \paxlink{x-28DREF-EXT-3A-40SOURCE-LOCATIONS-20MGL-PAX-3ASECTION-29}{Source
  Locations\texttt{}} API or to be passed to e.g Slime\textquotesingle s
  \texttt{slime-goto-source-location}.

  If no source location was found,

  \begin{itemize}
  \item
    if \texttt{error} is \texttt{nil}, then return \texttt{nil};
  \item
    if \texttt{error} is \texttt{:error}, then return a list of the form
    \texttt{(:error\ \textless{}error-message\textgreater{})} suitable
    for \texttt{slime-goto-source-location};
  \item
    if \texttt{error} is \texttt{t}, then signal an
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/e_error.htm}{\texttt{error}}
    condition with the same error message as in the previous case.
  \end{itemize}

  Note that the availability of source location information varies
  greatly across Lisp implementations.

  Can be extended via
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-2A-20GENERIC-FUNCTION-29}{\texttt{source-location*}}.
\end{itemize}

\section{Basic Locative Types}\label{basic-locative-types}

\label{x-28DREF-3A-40BASIC-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}

The following are the
\paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
type\texttt{}}s supported out of the box. As all locative types, they
are named by symbols. When there is a CL type corresponding to the
reference\textquotesingle s locative type, the references can be
\paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}d to a
unique object as is the case in

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(resolve (dref }\DataTypeTok{\textquotesingle{}print} \DataTypeTok{\textquotesingle{}function}\NormalTok{))}
\NormalTok{==\textgreater{} \#\textless{}FUNCTION PRINT\textgreater{}}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}

Even if there is no such CL type, the
\paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}}, the
\paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}}, and
the
\paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
of the defining form is usually recorded unless otherwise noted.

The basic locative types and their inheritance structure is loosely
based on the \texttt{doc-type} argument of
\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_docume.htm}{\texttt{cl:documentation}}.

\subsection{Locatives for Variables}\label{locatives-for-variables}

\label{x-28DREF-3A-40VARIABLELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L50}{locative}\paxname{variable}\phantomsection\label{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}
  \emph{\&optional initform}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes: glossary-term, section,
    \paxlink{x-28MGL-PAX-3ACONSTANT-20MGL-PAX-3ALOCATIVE-29}{constant\texttt{}}
  \end{itemize}

  Refers to a global special variable. \texttt{initform}, or if not
  specified, the global value of the variable is to be used for
  \paxlink{x-28DREF-3A-40PRESENTATION-20MGL-PAX-3AGLOSSARY-TERM-29}{presentation\texttt{}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}*print{-}length*} \DataTypeTok{\textquotesingle{}variable}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF *PRINT{-}LENGTH* VARIABLE\textgreater{}}
\end{Highlighting}
\end{Shaded}

  \texttt{variable} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L80}{locative}\paxname{constant}\phantomsection\label{x-28MGL-PAX-3ACONSTANT-20MGL-PAX-3ALOCATIVE-29}
  \emph{\&optional initform}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{variable\texttt{}}
  \end{itemize}

  Refers to a constant variable defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcon.htm}{\texttt{defconstant}}.
  \texttt{initform}, or if not specified, the value of the constant is
  included in the documentation. The
  \paxlink{x-28MGL-PAX-3ACONSTANT-20MGL-PAX-3ALOCATIVE-29}{\texttt{constant}}
  locative is like the
  \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}
  locative, but it also checks that its object is
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_consta.htm}{\texttt{constantp}}.

  \texttt{constant} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\end{itemize}

\subsection{Locatives for Macros}\label{locatives-for-macros}

\label{x-28DREF-3A-40MACROLIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L110}{locative}\paxname{setf}\phantomsection\label{x-28SETF-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28DREF-3ASETF-METHOD-20MGL-PAX-3ALOCATIVE-29}{setf-method\texttt{}},
    \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-function\texttt{}}
  \end{itemize}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_s.htm\#setf_expander}{setf
  expander} (see
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defset.htm}{\texttt{defsetf}}
  and
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_3.htm}{\texttt{define-setf-expander}}).

  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_s.htm\#setf_function}{Setf
  functions} (e.g. \texttt{(defun\ (setf\ name)\ ...)} or the same with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm}{\texttt{defgeneric}})
  are handled by the
  \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{setf-function}},
  \paxlink{x-28DREF-3ASETF-GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{setf-generic-function}},
  and \texttt{setf-method} locatives.

  \texttt{setf} expander references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L163}{locative}\paxname{macro}\phantomsection\label{x-28MGL-PAX-3AMACRO-20MGL-PAX-3ALOCATIVE-29}

  Refers to a global macro, typically defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defmac.htm}{\texttt{defmacro}},
  or to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_specia.htm}{special
  operator}.

  \texttt{macro} references resolve to the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_macro_.htm}{\texttt{macro-function}}
  of their \texttt{name} or signal
  \texttt{resolve-error}(\paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20CONDITION-29}{\texttt{0}}
  \paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20FUNCTION-29}{\texttt{1}}) if
  that\textquotesingle s \texttt{nil}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L206}{locative}\paxname{symbol-macro}\phantomsection\label{x-28MGL-PAX-3ASYMBOL-MACRO-20MGL-PAX-3ALOCATIVE-29}

  Refers to a global symbol macro, defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_1.htm}{\texttt{define-symbol-macro}}.
  Note that since \texttt{define-symbol-macro} does not support
  docstrings, PAX defines methods on the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_docume.htm}{\texttt{documentation}}
  generic function specialized on
  \texttt{(doc-type\ (eql\ \textquotesingle{}symbol-macro))}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{define{-}symbol{-}macro}\FunctionTok{ my{-}mac }\DecValTok{42}\NormalTok{)}
\NormalTok{(}\KeywordTok{setf}\NormalTok{ (}\KeywordTok{documentation} \DataTypeTok{\textquotesingle{}my{-}mac} \DataTypeTok{\textquotesingle{}symbol{-}macro}\NormalTok{)}
      \StringTok{"This is MY{-}MAC."}\NormalTok{)}
\NormalTok{(}\KeywordTok{documentation} \DataTypeTok{\textquotesingle{}my{-}mac} \DataTypeTok{\textquotesingle{}symbol{-}macro}\NormalTok{)}
\OperatorTok{=\textgreater{}} \StringTok{"This is MY{-}MAC."}
\end{Highlighting}
\end{Shaded}

  \texttt{symbol-macro} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L264}{locative}\paxname{compiler-macro}\phantomsection\label{x-28COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28DREF-3ASETF-COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{setf-compiler-macro\texttt{}}
  \end{itemize}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_cmp_ma.htm}{\texttt{compiler-macro-function}},
  typically defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_define.htm}{\texttt{define-compiler-macro}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L463}{locative}\paxname{setf-compiler-macro}\phantomsection\label{x-28DREF-3ASETF-COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{compiler-macro\texttt{}}
  \end{itemize}

  Refers to a compiler macro with a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_s.htm\#setf_function_name}{setf
  function name}.

  \texttt{setf-compiler-macro} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\end{itemize}

\subsection{Locatives for Functions and
Methods}\label{locatives-for-functions-and-methods}

\label{x-28DREF-3A-40FUNCTIONLIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L320}{locative}\paxname{function}\phantomsection\label{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20MGL-PAX-3ALOCATIVE-29}{structure-accessor\texttt{}},
    \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-function\texttt{}},
    \paxlink{x-28GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{generic-function\texttt{}}
  \end{itemize}

  Refers to a global function, typically defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm}{\texttt{defun}}.
  The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  must be a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm\#function_name}{function
  name}. It is also allowed to reference
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_generi.htm}{\texttt{generic-function}}s
  as \texttt{function}s:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}docstring} \DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF DOCSTRING FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L485}{locative}\paxname{setf-function}\phantomsection\label{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{function\texttt{}},
    \paxlink{x-28SETF-20MGL-PAX-3ALOCATIVE-29}{setf\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20MGL-PAX-3ALOCATIVE-29}{structure-accessor\texttt{}},
    \paxlink{x-28DREF-3ASETF-GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-generic-function\texttt{}}
  \end{itemize}

  Refers to a global
  \texttt{function}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_fn.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/s_fn.htm}{\texttt{1}})
  with a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_s.htm\#setf_function_name}{setf
  function name}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defun}\FunctionTok{ }\NormalTok{(}\KeywordTok{setf}\NormalTok{ ooh) ())}
\NormalTok{(locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{(}\KeywordTok{setf}\NormalTok{ ooh))}
\NormalTok{==\textgreater{} \#\textless{}DREF OOH SETF{-}FUNCTION\textgreater{}}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}ooh} \DataTypeTok{\textquotesingle{}setf{-}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF OOH SETF{-}FUNCTION\textgreater{}}
\NormalTok{(dref \textquotesingle{}(}\KeywordTok{setf}\NormalTok{ ooh) }\DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF OOH SETF{-}FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L370}{locative}\paxname{generic-function}\phantomsection\label{x-28GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{function\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28DREF-3ASETF-GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-generic-function\texttt{}}
  \end{itemize}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_generi.htm}{\texttt{generic-function}},
  typically defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm}{\texttt{defgeneric}}.
  The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  must be a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm\#function_name}{function
  name}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L515}{locative}\paxname{setf-generic-function}\phantomsection\label{x-28DREF-3ASETF-GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{generic-function\texttt{}},
    \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-function\texttt{}}
  \end{itemize}

  Refers to a global
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_generi.htm}{\texttt{generic-function}}
  with a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_s.htm\#setf_function_name}{setf
  function name}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defgeneric}\FunctionTok{ }\NormalTok{(}\KeywordTok{setf}\NormalTok{ oog) ())}
\NormalTok{(locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{(}\KeywordTok{setf}\NormalTok{ oog))}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG SETF{-}GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}oog} \DataTypeTok{\textquotesingle{}setf{-}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG SETF{-}GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{(dref \textquotesingle{}(}\KeywordTok{setf}\NormalTok{ oog) }\DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG SETF{-}GENERIC{-}FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L393}{locative}\paxname{method}\phantomsection\label{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}
  \emph{method-qualifiers method-specializers}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3AWRITER-20MGL-PAX-3ALOCATIVE-29}{writer\texttt{}},
    \paxlink{x-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATIVE-29}{reader\texttt{}},
    \paxlink{x-28DREF-3ASETF-METHOD-20MGL-PAX-3ALOCATIVE-29}{setf-method\texttt{}}
  \end{itemize}

  Refers to a \texttt{method}.
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  must be a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm\#function_name}{function
  name}.
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_method.htm}{\texttt{method-qualifiers}}
  and \texttt{method-specializers} are similar to the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_find_m.htm}{\texttt{cl:find-method}}\textquotesingle s
  arguments of the same names. For example, the method

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defgeneric}\FunctionTok{ foo{-}gf }\NormalTok{(x y z)}
\NormalTok{  (:method :around (x (y (}\KeywordTok{eql} \DataTypeTok{\textquotesingle{}xxx}\NormalTok{)) (z }\KeywordTok{string}\NormalTok{))}
\NormalTok{    (}\KeywordTok{values}\NormalTok{ x y z)))}
\end{Highlighting}
\end{Shaded}

  can be referred to as

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}foo{-}gf}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ (:around) (}\KeywordTok{t}\NormalTok{ (}\KeywordTok{eql}\NormalTok{ xxx) }\KeywordTok{string}\NormalTok{)))}
\NormalTok{==\textgreater{} \#\textless{}DREF FOO{-}GF (METHOD (:AROUND) (T (EQL XXX) STRING))}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

  \texttt{method} is not \texttt{exportable-locative-type-p}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L546}{locative}\paxname{setf-method}\phantomsection\label{x-28DREF-3ASETF-METHOD-20MGL-PAX-3ALOCATIVE-29}
  \emph{method-qualifiers method-specializers}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{method\texttt{}},
    \paxlink{x-28SETF-20MGL-PAX-3ALOCATIVE-29}{setf\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}{accessor\texttt{}}
  \end{itemize}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_method.htm}{\texttt{method}}
  of a \texttt{setf-generic-function}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defgeneric}\FunctionTok{ }\NormalTok{(}\KeywordTok{setf}\NormalTok{ oog) ()}
\NormalTok{  (:method ()))}
\NormalTok{(locate (}\KeywordTok{find{-}method} \OperatorTok{\#\textquotesingle{}}\NormalTok{(}\KeywordTok{setf}\NormalTok{ oog) () ()))}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG (SETF{-}METHOD NIL NIL)}\OperatorTok{\textgreater{}}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}oog}\NormalTok{ \textquotesingle{}(setf{-}method () ()))}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG (SETF{-}METHOD NIL NIL)}\OperatorTok{\textgreater{}}
\NormalTok{(dref \textquotesingle{}(}\KeywordTok{setf}\NormalTok{ oog) \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () ()))}
\NormalTok{==\textgreater{} \#\textless{}DREF OOG (SETF{-}METHOD NIL NIL)}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L583}{locative}\paxname{method-combination}\phantomsection\label{x-28METHOD-COMBINATION-20MGL-PAX-3ALOCATIVE-29}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_meth_1.htm}{\texttt{method-combination}},
  defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_4.htm}{\texttt{define-method-combination}}.

  \texttt{method-combination} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L610}{locative}\paxname{reader}\phantomsection\label{x-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATIVE-29}
  \emph{class-name}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{method\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}{accessor\texttt{}}
  \end{itemize}

  Refers to a \texttt{:reader} method in a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm}{\texttt{defclass}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defclass}\FunctionTok{ foo }\NormalTok{()}
\NormalTok{  ((xxx :reader foo{-}xxx)))}

\NormalTok{(dref }\DataTypeTok{\textquotesingle{}foo{-}xxx}\NormalTok{ \textquotesingle{}(reader foo))}
\NormalTok{==\textgreater{} \#\textless{}DREF FOO{-}XXX (READER FOO)}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L674}{locative}\paxname{writer}\phantomsection\label{x-28MGL-PAX-3AWRITER-20MGL-PAX-3ALOCATIVE-29}
  \emph{class-name}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{method\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}{accessor\texttt{}}
  \end{itemize}

  Like
  \paxlink{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}{\texttt{accessor}},
  but refers to a \texttt{:writer} method in a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm}{\texttt{defclass}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L738}{locative}\paxname{accessor}\phantomsection\label{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}
  \emph{class-name}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATIVE-29}{reader\texttt{}},
    \paxlink{x-28MGL-PAX-3AWRITER-20MGL-PAX-3ALOCATIVE-29}{writer\texttt{}},
    \paxlink{x-28DREF-3ASETF-METHOD-20MGL-PAX-3ALOCATIVE-29}{setf-method\texttt{}}
  \end{itemize}

  Refers to an \texttt{:accessor} in a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm}{\texttt{defclass}}.

  An \texttt{:accessor} in \texttt{defclass} creates a reader and a
  writer method. Somewhat arbitrarily, \texttt{accessor} references
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}} to the
  writer method but can be
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d with
  either.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L806}{locative}\paxname{structure-accessor}\phantomsection\label{x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20MGL-PAX-3ALOCATIVE-29}
  \emph{\&optional structure-class-name}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{setf-function\texttt{}},
    \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{function\texttt{}}
  \end{itemize}

  Refers to an accessor function generated by
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defstr.htm}{\texttt{defstruct}}.
  A
  \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{locate-error}}
  condition is signalled if the wrong \texttt{structure-class-name} is
  provided.

  Note that there is no portable way to detect structure accessors, and
  on some platforms, \texttt{(locate\ \#\textquotesingle{}my-accessor)},
  \paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}}
  and
  \paxlink{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}{\texttt{dref-apropos}}
  will return
  \texttt{function}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_fn.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/s_fn.htm}{\texttt{1}})
  references instead. On such platforms, \texttt{structure-accessor}
  references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\end{itemize}

\subsection{Locatives for Types and
Declarations}\label{locatives-for-types-and-declarations}

\label{x-28DREF-3A-40TYPELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L891}{locative}\paxname{type}\phantomsection\label{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{class\texttt{}}
  \end{itemize}

  This locative can refer to
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/04_.htm}{types
  and classes} and
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/09_.htm}{conditions},
  simply put, to things defined by
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_deftp.htm}{\texttt{deftype}},
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm}{\texttt{defclass}}
  and
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_5.htm}{\texttt{define-condition}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{deftype}\FunctionTok{ my{-}type }\NormalTok{() }\KeywordTok{t}\NormalTok{)}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}my{-}type} \DataTypeTok{\textquotesingle{}type}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF MY{-}TYPE TYPE\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}xref} \DataTypeTok{\textquotesingle{}type}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF XREF CLASS\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}locate{-}error} \DataTypeTok{\textquotesingle{}type}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF LOCATE{-}ERROR CONDITION\textgreater{}}
\end{Highlighting}
\end{Shaded}

  \texttt{type} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L949}{locative}\paxname{class}\phantomsection\label{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \item
    Direct locative supertypes:
    \paxlink{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}{type\texttt{}}
  \item
    Direct locative subtypes:
    \paxlink{x-28CONDITION-20MGL-PAX-3ALOCATIVE-29}{condition\texttt{}},
    \paxlink{x-28STRUCTURE-20MGL-PAX-3ALOCATIVE-29}{structure\texttt{}}
  \end{itemize}

  Naturally, \texttt{class} is the locative type for
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}es.

  Also, see the related
  \paxlink{x-28CONDITION-20MGL-PAX-3ALOCATIVE-29}{\texttt{condition}}
  locative.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L977}{locative}\paxname{structure}\phantomsection\label{x-28STRUCTURE-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{class\texttt{}}
  \end{itemize}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_stu_cl.htm}{\texttt{structure-class}},
  typically defined with
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defstr.htm}{\texttt{defstruct}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L992}{locative}\paxname{declaration}\phantomsection\label{x-28DECLARATION-20MGL-PAX-3ALOCATIVE-29}

  Refers to a declaration, used in
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/s_declar.htm}{\texttt{declare}},
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_declai.htm}{\texttt{declaim}}
  and
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_procla.htm}{\texttt{proclaim}}.

  User code may also define new declarations with CLTL2 functionality,
  but there is currently no way to provide a docstring, and their
  \paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}} is always
  \texttt{nil}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(cl{-}environments:define{-}declaration my{-}decl (\&}\KeywordTok{rest}\NormalTok{ things)}
\NormalTok{  (}\KeywordTok{values}\NormalTok{ :declare (}\KeywordTok{cons} \DataTypeTok{\textquotesingle{}foo}\NormalTok{ things)))}
\end{Highlighting}
\end{Shaded}

  \texttt{declaration} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}.

  Also,
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
  on declarations currently only works on SBCL.
\end{itemize}

\subsection{Locatives for the Condition
System}\label{locatives-for-the-condition-system}

\label{x-28DREF-3A-40CONDITION-SYSTEM-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1063}{locative}\paxname{condition}\phantomsection\label{x-28CONDITION-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{class\texttt{}}
  \end{itemize}

  Although \texttt{condition} is not
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_subtpp.htm}{\texttt{subtypep}}
  of
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}},
  actual condition objects are commonly instances of a condition class
  that is a CLOS class. HyperSpec
  \href{http://www.lispworks.com/documentation/HyperSpec/Issues/iss049_w.htm}{ISSUE:CLOS-CONDITIONS}
  and
  \href{http://www.lispworks.com/documentation/HyperSpec/Issues/iss048_w.htm}{ISSUE:CLOS-CONDITIONS-AGAIN}
  provide the relevant history.

  Whenever a \texttt{class} denotes a \texttt{condition}, its
  \paxlink{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{dref-locative-type}}
  will be \texttt{condition}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}locate{-}error} \DataTypeTok{\textquotesingle{}class}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF LOCATE{-}ERROR CONDITION\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/early.lisp\#L5}{locative}\paxname{restart}\phantomsection\label{x-28RESTART-20MGL-PAX-3ALOCATIVE-29}

  A locative to refer to the definition of a restart defined by
  \paxlink{x-28DREF-3ADEFINE-RESTART-20MGL-PAX-3AMACRO-29}{\texttt{define-restart}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/early.lisp\#L9}{macro}\paxname{define-restart}\phantomsection\label{x-28DREF-3ADEFINE-RESTART-20MGL-PAX-3AMACRO-29}
  \emph{symbol lambda-list \&body docstring}

  Associate a definition with the name of a restart, which must be a
  symbol. \texttt{lambda-list} should be what calls like
  \texttt{(invoke-restart\ \textquotesingle{}\textless{}symbol\textgreater{}\ ...)}
  must conform to, but this not enforced.

  PAX "defines" standard CL restarts such as
  \texttt{use-value}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_abortc.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/r_use_va.htm}{\texttt{1}})
  with \texttt{define-restart}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(first{-}line (source{-}location{-}snippet}
\NormalTok{             (source{-}location (dref }\DataTypeTok{\textquotesingle{}use{-}value} \DataTypeTok{\textquotesingle{}restart}\NormalTok{))))}
\OperatorTok{=\textgreater{}} \StringTok{"(define{-}restart use{-}value (value)"}
\end{Highlighting}
\end{Shaded}

  Note that while there is a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_rst.htm}{\texttt{cl:restart}}
  class, its instances have no docstring or source location.
\end{itemize}

\subsection{Locatives for Packages and
Readtables}\label{locatives-for-packages-and-readtables}

\label{x-28DREF-3A-40PACKAGELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1122}{locative}\paxname{asdf/system:system}\phantomsection\label{x-28ASDF-2FSYSTEM-3ASYSTEM-20MGL-PAX-3ALOCATIVE-29}

  Refers to an already loaded \texttt{asdf:system} (those in
  \texttt{asdf:registered-systems}). The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  may be anything \texttt{asdf:find-system} supports.

  \texttt{asdf:system} is not \texttt{exportable-locative-type-p}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1166}{locative}\paxname{package}\phantomsection\label{x-28PACKAGE-20MGL-PAX-3ALOCATIVE-29}

  Refers to a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_pkg.htm}{\texttt{package}},
  defined by
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defpkg.htm}{\texttt{defpackage}}
  or
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_mk_pkg.htm}{\texttt{make-package}}.
  The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  may be anything
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_find_p.htm}{\texttt{find-package}}
  supports.

  \texttt{package} is not \texttt{exportable-locative-type-p}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1205}{locative}\paxname{readtable}\phantomsection\label{x-28READTABLE-20MGL-PAX-3ALOCATIVE-29}

  Refers to a named
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_rdtabl.htm}{\texttt{readtable}}
  defined with \texttt{named-readtables:defreadtable}, which associates
  a global name and a docstring with the readtable object. The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  may be anything \texttt{find-readtable} supports.

  \texttt{readtable} references
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}} to
  \texttt{find-readtable} on their
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}.
\end{itemize}

\subsection{Locatives for Unknown
Definitions}\label{locatives-for-unknown-definitions}

\label{x-28DREF-3A-40UNKNOWN-DEFINITIONS-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1356}{locative}\paxname{unknown}\phantomsection\label{x-28MGL-PAX-3AUNKNOWN-20MGL-PAX-3ALOCATIVE-29}
  \emph{dspec}

  This locative type allows PAX to work in a limited way with definition
  types it doesn\textquotesingle t know. \texttt{unknown} definitions
  come from
  \paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}},
  which uses \texttt{swank/backend:find-definitions}. The following
  examples show PAX stuffing the Swank dspec
  \texttt{(:define-alien-type\ double-float)} into an
  \paxlink{x-28MGL-PAX-3AUNKNOWN-20MGL-PAX-3ALOCATIVE-29}{\texttt{unknown}}
  locative on SBCL.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(definitions }\DataTypeTok{\textquotesingle{}double{-}float}\NormalTok{)}
\NormalTok{==\textgreater{} (\#\textless{}DREF DOUBLE{-}FLOAT CLASS\textgreater{}}
\NormalTok{{-}{-}\textgreater{}  \#\textless{}DREF DOUBLE{-}FLOAT (UNKNOWN (:DEFINE{-}ALIEN{-}TYPE DOUBLE{-}FLOAT))}\OperatorTok{\textgreater{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}double{-}float}\NormalTok{ \textquotesingle{}(unknown (:define{-}alien{-}type }\KeywordTok{double{-}float}\NormalTok{)))}
\NormalTok{==\textgreater{} \#\textless{}DREF DOUBLE{-}FLOAT (UNKNOWN (:DEFINE{-}ALIEN{-}TYPE DOUBLE{-}FLOAT))}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

  \paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}} and
  \paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}}
  return \texttt{nil} for \texttt{unknown}s, but
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
  works.
\end{itemize}

\subsection{Locatives for DRef
Constructs}\label{locatives-for-dref-constructs}

\label{x-28DREF-3A-40DREF-LOCATIVES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1248}{locative}\paxname{dtype}\phantomsection\label{x-28DREF-3ADTYPE-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative subtypes:
    \paxlink{x-28MGL-PAX-3ALOCATIVE-20MGL-PAX-3ALOCATIVE-29}{locative\texttt{}}
  \end{itemize}

  Locative for
  \paxlink{x-28DREF-3A-40DTYPES-20MGL-PAX-3ASECTION-29}{\texttt{dtype}s\texttt{}}
  defined with
  \paxlink{x-28DREF-3ADEFINE-DTYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-dtype}}
  and \texttt{locative} types. \texttt{dtype} is to \texttt{locative} as
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/d_type.htm}{\texttt{type}}
  is to
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}.

  The \paxlink{x-28DREF-3ATOP-20DREF-3ADTYPE-29}{\texttt{top}} of the
  \texttt{dtype} hierarchy:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}top} \DataTypeTok{\textquotesingle{}dtype}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF TOP DTYPE\textgreater{}}
\end{Highlighting}
\end{Shaded}

  This very definition:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}dtype} \DataTypeTok{\textquotesingle{}locative}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF DTYPE LOCATIVE\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1274}{locative}\paxname{locative}\phantomsection\label{x-28MGL-PAX-3ALOCATIVE-20MGL-PAX-3ALOCATIVE-29}

  \begin{itemize}
  \tightlist
  \item
    Direct locative supertypes:
    \paxlink{x-28DREF-3ADTYPE-20MGL-PAX-3ALOCATIVE-29}{dtype\texttt{}}
  \end{itemize}

  This is the locative for
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}s defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}},
  \paxlink{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-pseudo-locative-type}}
  and
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-ALIAS-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-alias}}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(first{-}line (source{-}location{-}snippet}
\NormalTok{             (source{-}location (dref }\DataTypeTok{\textquotesingle{}macro} \DataTypeTok{\textquotesingle{}locative}\NormalTok{))))}
\OperatorTok{=\textgreater{}} \StringTok{"(define{-}locative{-}type macro ()"}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1295}{locative}\paxname{lambda}\phantomsection\label{x-28LAMBDA-20MGL-PAX-3ALOCATIVE-29}
  \emph{\&key arglist arglist-type docstring docstring-package file
  file-position snippet \&allow-other-keys}

  A \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{pseudo
  locative type\texttt{}} that carries its
  \paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}},
  \paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}}
  and
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
  in the locative itself. See
  \paxlink{x-28DREF-EXT-3AMAKE-SOURCE-LOCATION-20FUNCTION-29}{\texttt{make-source-location}}
  for the description of \texttt{file},
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_file_p.htm}{\texttt{file-position}},
  and \texttt{snippet}. \texttt{lambda} references do not
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}. The
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}
  must be \texttt{nil}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist (dref }\KeywordTok{nil}\NormalTok{ \textquotesingle{}(}\KeywordTok{lambda}\NormalTok{ :arglist ((x y) z)}
\NormalTok{                            :arglist{-}type :macro)))}
\OperatorTok{=\textgreater{}}\NormalTok{ ((X Y) Z)}
\OperatorTok{=\textgreater{}}\NormalTok{ :MACRO}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(docstring (dref }\KeywordTok{nil}\NormalTok{ \textquotesingle{}(}\KeywordTok{lambda}\NormalTok{ :docstring }\StringTok{"xxx"}
\NormalTok{                              :docstring{-}package :dref)))}
\OperatorTok{=\textgreater{}} \StringTok{"xxx"}
\NormalTok{==\textgreater{} \#\textless{}PACKAGE }\StringTok{"DREF"}\NormalTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(source{-}location{-}file}
\NormalTok{ (source{-}location (dref }\KeywordTok{nil}\NormalTok{ \textquotesingle{}(}\KeywordTok{lambda}\NormalTok{ :file }\StringTok{"xxx.el"}\NormalTok{))))}
\OperatorTok{=\textgreater{}} \StringTok{"xxx.el"}
\end{Highlighting}
\end{Shaded}

  Also, see the \texttt{pax:include} locative.
\end{itemize}

\section{Extending DRef}\label{extending-dref}

\label{x-28DREF-EXT-3A-40EXTENDING-DREF-20MGL-PAX-3ASECTION-29}

\subsection{Extension Tutorial}\label{extension-tutorial}

\label{x-28DREF-EXT-3A-40EXTENSION-TUTORIAL-20MGL-PAX-3ASECTION-29}

Let\textquotesingle s see how to tell DRef about new kinds of
definitions through the example of the implementation of the
\paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{\texttt{class}} locative.
Note that this is a verbatim \texttt{pax:include} of the sources. Please
ignore any internal machinery. The first step is to define the
\paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
type\texttt{}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locative{-}type }\KeywordTok{class}\NormalTok{ (}\KeywordTok{type}\NormalTok{)}
  \StringTok{"Naturally, CLASS is the locative type for [CLASS][class]es.}

\StringTok{  Also, see the related CONDITION locative."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Then, we make it possible to look up
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
definitions:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locator }\KeywordTok{class}\NormalTok{ ((}\KeywordTok{class} \KeywordTok{class}\NormalTok{))}
\NormalTok{  (}\KeywordTok{make{-}instance} \DataTypeTok{\textquotesingle{}class{-}dref} \BuiltInTok{:name}\NormalTok{ (}\KeywordTok{class{-}name} \KeywordTok{class}\NormalTok{) :locative }\DataTypeTok{\textquotesingle{}class}\NormalTok{))}

\NormalTok{(define{-}lookup }\KeywordTok{class}\NormalTok{ (}\KeywordTok{symbol}\NormalTok{ locative{-}args)}
\NormalTok{  (}\KeywordTok{unless}\NormalTok{ (}\KeywordTok{and}\NormalTok{ (}\KeywordTok{symbolp} \KeywordTok{symbol}\NormalTok{)}
\NormalTok{               (}\KeywordTok{find{-}class} \KeywordTok{symbol} \KeywordTok{nil}\NormalTok{))}
\NormalTok{    (locate{-}error }\StringTok{"\textasciitilde{}S does not name a class."} \KeywordTok{symbol}\NormalTok{))}
\NormalTok{  (}\KeywordTok{make{-}instance} \DataTypeTok{\textquotesingle{}class{-}dref} \BuiltInTok{:name} \KeywordTok{symbol}\NormalTok{ :locative }\DataTypeTok{\textquotesingle{}class}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{\texttt{define-locator}}
makes \texttt{(locate\ (find-class\ \textquotesingle{}dref))} work,
while
\paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{\texttt{define-lookup}}
is for \texttt{(dref\ \textquotesingle{}dref\ \textquotesingle{}class)}.
Naturally, for locative types that do not define first-class objects,
the first method cannot be defined.

Finally, we define a
\paxlink{x-28DREF-EXT-3ARESOLVE-2A-20GENERIC-FUNCTION-29}{\texttt{resolve*}}
method to recover the
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
object from a
\paxlink{x-28DREF-EXT-3ACLASS-DREF-20CLASS-29}{\texttt{class-dref}}. We
also specialize
\paxlink{x-28DREF-EXT-3ADOCSTRING-2A-20GENERIC-FUNCTION-29}{\texttt{docstring*}}
and
\paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-2A-20GENERIC-FUNCTION-29}{\texttt{source-location*}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defmethod}\FunctionTok{ resolve* }\NormalTok{((dref class{-}dref))}
\NormalTok{  (}\KeywordTok{find{-}class}\NormalTok{ (dref{-}name dref)))}

\NormalTok{(}\KeywordTok{defmethod}\FunctionTok{ docstring* }\NormalTok{((}\KeywordTok{class} \KeywordTok{class}\NormalTok{))}
\NormalTok{  (documentation* }\KeywordTok{class} \KeywordTok{t}\NormalTok{))}

\NormalTok{(}\KeywordTok{defmethod}\FunctionTok{ source{-}location* }\NormalTok{((dref class{-}dref))}
\NormalTok{  (swank{-}source{-}location* (resolve dref) (dref{-}name dref) }\DataTypeTok{\textquotesingle{}class}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

We took advantage of having just made the class locative type being
\paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}able, by
specializing
\paxlink{x-28DREF-EXT-3ADOCSTRING-2A-20GENERIC-FUNCTION-29}{\texttt{docstring*}}
on the
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
class.
\paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-2A-20GENERIC-FUNCTION-29}{\texttt{source-location*}}
was specialized on
\paxlink{x-28DREF-EXT-3ACLASS-DREF-20CLASS-29}{\texttt{class-dref}} to
demonstrate how this can be done for non-\texttt{resolve}able locative
types.

Classes have no arglist, so no
\paxlink{x-28DREF-EXT-3AARGLIST-2A-20GENERIC-FUNCTION-29}{\texttt{arglist*}}
method is needed. In the following, we describe the pieces in detail.

\subsection{Locative Type Hierarchy}\label{locative-type-hierarchy}

\label{x-28DREF-EXT-3A-40LOCATIVE-TYPE-HIERARCHY-20MGL-PAX-3ASECTION-29}

\paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{Locative
types\texttt{}} form their own hierarchy, that is only superficially
similar to the Lisp
\href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
hierarchy. The hierarchies of
\paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}
and
\paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}}
are distinct. That is, the
\paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}
of a Lisp locative type must not be a subclass of a
\paxlink{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}{\texttt{pseudo}} one, and
vice versa. This is enforced by
\paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}}
and
\paxlink{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-pseudo-locative-type}}.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L103}{function}\paxname{dref-class}\phantomsection\label{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}
  \emph{locative-type}

  Return the name of the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
  used to represent
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}s
  with \texttt{locative-type}. This is always a subclass of
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}. Returns
  \texttt{nil} if \texttt{locative-type} is not a valid locative type.

  Note that the actual
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_tp_of.htm}{\texttt{type-of}}
  a \texttt{dref} is mostly intended for
  \paxlink{x-28DREF-EXT-3A-40EXTENDING-DREF-20MGL-PAX-3ASECTION-29}{Extending
  DRef\texttt{}}. Hence, it is hidden when a \texttt{dref} is printed:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}print} \DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF PRINT FUNCTION\textgreater{}}
\NormalTok{(}\KeywordTok{type{-}of} \OperatorTok{*}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ FUNCTION{-}DREF}
\end{Highlighting}
\end{Shaded}

  Due to
  \paxlink{x-28DREF-EXT-3A-40CANONICALIZATION-20MGL-PAX-3ASECTION-29}{Canonicalization\texttt{}},
  the actual type may be a proper subtype of \texttt{dref-class}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}documentation} \DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF DOCUMENTATION GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{(}\KeywordTok{type{-}of} \OperatorTok{*}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ GENERIC{-}FUNCTION{-}DREF}
\NormalTok{(}\KeywordTok{subtypep} \DataTypeTok{\textquotesingle{}generic{-}function{-}dref} \DataTypeTok{\textquotesingle{}function{-}dref}\NormalTok{)}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L135}{function}\paxname{locative-type-direct-supers}\phantomsection\label{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUPERS-20FUNCTION-29}
  \emph{locative-type}

  List the
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}s whose
  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}es
  are direct superclasses of the \texttt{dref-class} of
  \texttt{locative-type}. These can be considered supertypes of
  \texttt{locative-type} in the sense of
  \paxlink{x-28DREF-3ADTYPEP-20FUNCTION-29}{\texttt{dtypep}}.

  This is ordered as in the corresponding definition.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L143}{function}\paxname{locative-type-direct-subs}\phantomsection\label{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUBS-20FUNCTION-29}
  \emph{locative-type}

  List the
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}s whose
  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}es
  are direct subclasses of the \texttt{dref-class} of
  \texttt{locative-type}. These can be considered subtypes of
  \texttt{locative-type} in the sense of
  \paxlink{x-28DREF-3ADTYPEP-20FUNCTION-29}{\texttt{dtypep}}.

  This list is in
  \paxlink{x-28DREF-3A-40REVERSE-DEFINITION-ORDER-20MGL-PAX-3AGLOSSARY-TERM-29}{reverse
  definition order\texttt{}}.
\end{itemize}

\subsection{Defining Locative Types}\label{defining-locative-types}

\label{x-28DREF-EXT-3A-40DEFINING-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L210}{macro}\paxname{define-locative-type}\phantomsection\label{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}
  \emph{locative-type-and-lambda-list locative-supertypes \&optional
  docstring dref-defclass-form}

  Declare \texttt{locative-type} as a
  \paxlink{x-28MGL-PAX-3ALOCATIVE-20MGL-PAX-3ALOCATIVE-29}{\texttt{locative}},
  which is the first step in
  \paxlink{x-28DREF-EXT-3A-40EXTENDING-DREF-20MGL-PAX-3ASECTION-29}{Extending
  DRef\texttt{}}.

  \begin{itemize}
  \item
    \emph{Simple example}

    To define a locative type called \texttt{dummy} that takes no
    arguments and is not a locative subtype of any other locative type:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locative{-}type dummy ()}
  \StringTok{"Dummy docstring."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

    With this definition, only the locatives \texttt{dummy} and its
    equivalent form \texttt{(dummy)} are valid. The above defines a
    \texttt{dref}(\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{0}}
    \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{1}}) subclass called
    \texttt{dummy-dref} in the current package. All definitions with
    locative type \texttt{dummy} and its locatives subtypes must be
    instances of \texttt{dummy-dref}.

    \texttt{(locate\ \textquotesingle{}dummy\ \textquotesingle{}locative)}
    refers to this definition. That is,
    \paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}},
    \paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}}
    and
    \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
    all work on it.
  \item
    \emph{Complex example}

    \texttt{dummy} may have arguments \texttt{x} and \texttt{y} and
    inherit from locative types \texttt{l1} and \texttt{l2}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locative{-}type (dummy x \&key y) (l1 l2)}
  \StringTok{"Dummy docstring."}
\NormalTok{  (}\KeywordTok{defclass}\FunctionTok{ dummy{-}dref }\NormalTok{()}
\NormalTok{    ((xxx :initform }\KeywordTok{nil}\NormalTok{ :accessor dummy{-}xxx))))}
\end{Highlighting}
\end{Shaded}

    One may change name of \texttt{dummy-dref}, specify superclasses and
    add slots as with
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm}{\texttt{defclass}}.
    Behind the scenes, the \texttt{dref} classes of \texttt{l1} and
    \texttt{l2} are added automatically to the list of superclasses.
  \end{itemize}

  Arguments:

  \begin{itemize}
  \item
    The general form of \texttt{locative-type-and-lambda-list} is
    (\texttt{locative-type}
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/03_da.htm}{\texttt{\&rest}}
    \texttt{lambda-list}), where \texttt{locative-type} is a
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_symbol.htm}{\texttt{symbol}},
    and \texttt{lambda-list} is a
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#destructuring_lambda_list}{destructuring
    lambda list}. The
    \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
    of \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s with
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}} \texttt{locative-type} (the argument given to this
    macro) always conform to this lambda list. See
    \paxlink{x-28DREF-EXT-3ACHECK-LOCATIVE-ARGS-20MGL-PAX-3AMACRO-29}{\texttt{check-locative-args}}.

    If \texttt{locative-type-and-lambda-list} is a single symbol, then
    that\textquotesingle s interpreted as \texttt{locative-type}, and
    \texttt{lambda-list} is \texttt{nil}.
  \item
    \texttt{locative-supertypes} is a list of
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}}s whose
    \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}es
    are added to prepended to the list of superclasses this definition.
  \end{itemize}

  Locative types defined with \texttt{define-locative-type} can be
  listed with
  \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L332}{macro}\paxname{define-pseudo-locative-type}\phantomsection\label{x-28DREF-EXT-3ADEFINE-PSEUDO-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}
  \emph{locative-type-and-lambda-list locative-supertypes \&optional
  docstring dref-defclass-form}

  Like
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}},
  but declare that \texttt{locative-type} does not correspond to
  definitions in the running Lisp. Definitions with pseudo locatives are
  of \texttt{dtype}
  \paxlink{x-28DREF-3APSEUDO-20DREF-3ADTYPE-29}{\texttt{pseudo}} and are
  not listed by default by
  \paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}}.

  Locative types defined with \texttt{define-pseudo-locative-type} can
  be listed with
  \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L370}{macro}\paxname{define-locative-alias}\phantomsection\label{x-28DREF-EXT-3ADEFINE-LOCATIVE-ALIAS-20MGL-PAX-3AMACRO-29}
  \emph{alias locative-type \&body docstring}

  Define \texttt{alias} that can be substituted for
  \texttt{locative-type} (both
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_symbol.htm}{\texttt{symbol}}s)
  for the purposes of
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}ing.
  \texttt{locative-type} must exist (i.e. be among
  \paxlink{x-28DREF-3ALOCATIVE-TYPES-20FUNCTION-29}{\texttt{locative-types}}).
  For example, let\textquotesingle s define \texttt{object} as an alias
  of the \paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{\texttt{class}}
  locative:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locative{-}alias object }\KeywordTok{class}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  Then, \texttt{locate}ing with \texttt{object} will find the
  \texttt{class}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}xref} \DataTypeTok{\textquotesingle{}object}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF XREF CLASS\textgreater{}}
\end{Highlighting}
\end{Shaded}

  The
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
  of \texttt{object} (none in the above) are passed on to
  \texttt{class}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(arglist (dref }\DataTypeTok{\textquotesingle{}object} \DataTypeTok{\textquotesingle{}locative}\NormalTok{))}
\OperatorTok{=\textgreater{}}\NormalTok{ (\&REST ARGS)}
\OperatorTok{=\textgreater{}}\NormalTok{ :DESTRUCTURING}
\end{Highlighting}
\end{Shaded}

  Note that
  \paxlink{x-28DREF-3ALOCATIVE-ALIASES-20FUNCTION-29}{\texttt{locative-aliases}}
  are not \texttt{locative-types} and are not valid \texttt{dtype}s.

  Also, see Locative Aliases in PAX.
\end{itemize}

\subsubsection{Symbol Locatives}\label{symbol-locatives}

\label{x-28DREF-EXT-3A-40SYMBOL-LOCATIVES-20MGL-PAX-3ASECTION-29}

Let\textquotesingle s see how the opaque
\paxlink{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-symbol-locative-type}}
and the obscure
\paxlink{x-28DREF-EXT-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-definer-for-symbol-locative-type}}
macros work together to simplify the common task of associating
definition with a symbol in a certain context.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1088}{macro}\paxname{define-symbol-locative-type}\phantomsection\label{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}
  \emph{locative-type-and-lambda-list locative-supertypes \&optional
  docstring dref-class-def}

  Similar to
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}},
  but it assumes that all things
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}able with
  \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}{\texttt{locative-type}}
  are going to be symbols defined with a definer defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-definer-for-symbol-locative-type}}.
  Symbol locatives are for attaching a definition (along with arglist,
  documentation and source location) to a symbol in a particular
  context. An example will make everything clear:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}symbol{-}locative{-}type direction ()}
  \StringTok{"A direction is a symbol."}\NormalTok{)}

\NormalTok{(define{-}definer{-}for{-}symbol{-}locative{-}type define{-}direction direction}
  \StringTok{"With DEFINE{-}DIRECTION, one can document what a symbol means when}
\StringTok{  interpreted as a DIRECTION."}\NormalTok{)}

\NormalTok{(define{-}direction up ()}
  \StringTok{"UP is equivalent to a coordinate delta of (0, {-}1)."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  After all this,
  \texttt{(dref\ \textquotesingle{}up\ \textquotesingle{}direction)}
  refers to the \texttt{define-direction} form above.

  The
  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}
  of the defined locative type inherits from
  \paxlink{x-28DREF-EXT-3ASYMBOL-LOCATIVE-DREF-20CLASS-29}{\texttt{symbol-locative-dref}},
  which may be used for specializing when implementing new operations.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1143}{macro}\paxname{define-definer-for-symbol-locative-type}\phantomsection\label{x-28DREF-EXT-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}
  \emph{name locative-type \&body docstring}

  Define a macro with \texttt{name} that can be used to attach a lambda
  list, documentation, and source location to a symbol in the context of
  \texttt{locative-type}. The defined macro\textquotesingle s arglist is
  \texttt{(symbol\ lambda-list\ \&optional\ docstring)}.
  \texttt{locative-type} is assumed to have been defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-symbol-locative-type}}.
\end{itemize}

\subsection{\texorpdfstring{Extending
\texttt{locate}}{Extending locate}}\label{extending-locate}

\label{x-28DREF-EXT-3A-40EXTENDING-LOCATE-20MGL-PAX-3ASECTION-29}

Internally, \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}
finds an initial \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} of
its \texttt{object} argument with a
\paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{lookup\texttt{}}
or with a
\paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{locator\texttt{}}.
This initial \texttt{dref} is then canonicalized with a series of
\paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{casts\texttt{}}.
In more detail, the process is as follows.

\begin{itemize}
\tightlist
\item
  If the \texttt{object} argument of \texttt{locate} is a \texttt{dref},
  then it is returned without processing.
\end{itemize}

Else, \texttt{locate} first needs to finds the initial definition.

\subsubsection{Initial Definition}\label{initial-definition}

\label{x-28DREF-EXT-3A-40INITIAL-DEFINITION-20MGL-PAX-3ASECTION-29}

\paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} can find the
initial definition in one of two ways:

\begin{itemize}
\item
  \emph{With direct lookup}

  If \texttt{object} is an
  \texttt{xref}(\paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{0}}
  \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{1}}), then the
  \paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{lookup\texttt{}}
  for
  (\paxlink{x-28DREF-3AXREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{xref-locative-type}}
  \texttt{object}) is invoked. For an \texttt{xref} with the locative
  \texttt{(method\ ()\ (number))}, this would be the lookup defined as

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}lookup }\KeywordTok{method}\NormalTok{ (name locative{-}args) ...)}
\end{Highlighting}
\end{Shaded}
\item
  \emph{With locator search}

  Else, \texttt{object} is a normal Lisp object, such as a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_method.htm}{\texttt{method}}
  object from
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_find_m.htm}{\texttt{find-method}}.
  The first of
  \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}
  whose
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{locator\texttt{}}
  succeeds provides the initial definition, which may be defined like
  this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locator }\KeywordTok{method}\NormalTok{ ((obj }\KeywordTok{method}\NormalTok{)) ...)}
\end{Highlighting}
\end{Shaded}

  This is a locator that returns definitions with the
  \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{\texttt{method}} locative
  type and takes an argument named \texttt{obj} of class
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_method.htm}{\texttt{method}}
  (which is like a specializer in
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_defmet.htm}{\texttt{defmethod}}).

  \begin{itemize}
  \item
    \texttt{lisp-locative-types} are tried one by one in the order
    specified there.
  \item
    For a given locative type, if there are multiple locators, standard
    CLOS method selection applies.
  \end{itemize}
\end{itemize}

\subsubsection{Canonicalization}\label{canonicalization}

\label{x-28DREF-EXT-3A-40CANONICALIZATION-20MGL-PAX-3ASECTION-29}

The initial definition thus found is then canonicalized so that there is
a unique
\paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
under \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(locate }\OperatorTok{\#\textquotesingle{}}\NormalTok{arglist*)}
\NormalTok{==\textgreater{} \#\textless{}DREF ARGLIST* GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}arglist*} \DataTypeTok{\textquotesingle{}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF ARGLIST* GENERIC{-}FUNCTION\textgreater{}}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}arglist*} \DataTypeTok{\textquotesingle{}generic{-}function}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF ARGLIST* GENERIC{-}FUNCTION\textgreater{}}
\end{Highlighting}
\end{Shaded}

Canonicalization is performed by recursively attempting to
\paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{downcast\texttt{}}
the current definition to one of its
\paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUBS-20FUNCTION-29}{\texttt{locative-type-direct-subs}}
in a depth-first manner, backtracking if a cast fails.

\paragraph{Default Downcast}\label{default-downcast}

\label{x-28DREF-EXT-3A-40DEFAULT-DOWNCAST-20MGL-PAX-3ASECTION-29}

Downcasting to
\paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUBS-20FUNCTION-29}{direct
locative subtypes\texttt{}} is performed by default by looking up the
definition where the locative type is replaced with its sub while the
name and the locative args remain the same.

\paragraph{Cast Name Change}\label{cast-name-change}

\label{x-28DREF-EXT-3A-40CAST-NAME-CHANGE-20MGL-PAX-3ASECTION-29}

\paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{Casts\texttt{}}
must be careful about changing
\paxlink{x-28DREF-3ADREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-name}}.

Their \texttt{dref} argument and the
\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}} returned must have
the same \texttt{dref-name} (under
\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_equal.htm}{\texttt{equal}},
see \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}) or it
must be possible to upcast the returned value to the \texttt{dref}
argument\textquotesingle s \texttt{dref-locative-type}.

\begin{itemize}
\item
  \emph{Implementation note}

  The purpose of this rule is to allow
  \paxlink{x-28DREF-3ADTYPEP-20FUNCTION-29}{\texttt{dtypep}} answer this
  correctly:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defclass}\FunctionTok{ foo }\NormalTok{()}
\NormalTok{  ((a :accessor foo{-}a)))}
\NormalTok{(dref \textquotesingle{}(}\KeywordTok{setf}\NormalTok{ foo{-}a) \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (}\KeywordTok{t}\NormalTok{ foo)))}
\NormalTok{==\textgreater{} \#\textless{}DREF FOO{-}A (ACCESSOR FOO)}\OperatorTok{\textgreater{}}
\NormalTok{(dtypep }\OperatorTok{*}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (}\KeywordTok{t}\NormalTok{ foo)))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\CommentTok{;; Internally, DTYPEP upcast \#\textless{}DREF FOO{-}A (ACCESSOR FOO)\textgreater{}}
\CommentTok{;; and checks that the locative args of the resulting}
\CommentTok{;; definition match those in (METHOD () (T FOO)).}
\NormalTok{(locate* }\OperatorTok{**} \DataTypeTok{\textquotesingle{}method}\NormalTok{)}
\NormalTok{==\textgreater{} \#\textless{}DREF (SETF FOO{-}A) (METHOD NIL (T FOO))}\OperatorTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

  For even more background, also note that if the name remains the same
  but locative args change, then \texttt{dtypep} can simply check with
  \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{dref}} if there is a
  definition of the name with the given locative:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{defclass}\FunctionTok{ foo }\NormalTok{()}
\NormalTok{  ((r :reader foo{-}r)))}
\NormalTok{(dref }\DataTypeTok{\textquotesingle{}foo{-}r}\NormalTok{ \textquotesingle{}(reader foo))}
\NormalTok{==\textgreater{} \#\textless{}DREF FOO{-}R (READER FOO)}\OperatorTok{\textgreater{}}
\NormalTok{(dtypep }\OperatorTok{*}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (foo)))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\CommentTok{;; Behind the scenes, DTYPEP does this:}
\NormalTok{(xref= }\OperatorTok{**}\NormalTok{ (dref }\DataTypeTok{\textquotesingle{}foo{-}r}\NormalTok{ \textquotesingle{}(}\KeywordTok{method}\NormalTok{ () (foo))))}
\OperatorTok{=\textgreater{}}\NormalTok{ T}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\subsubsection{Defining Lookups, Locators and
Casts}\label{defining-lookups-locators-and-casts}

\label{x-28DREF-EXT-3A-40DEFINING-LOOKUPS-LOCATORS-AND-CASTS-20MGL-PAX-3ASECTION-29}

As we have seen, the
\paxlink{x-28DREF-EXT-3A-40INITIAL-DEFINITION-20MGL-PAX-3ASECTION-29}{Initial
Definition\texttt{}} is provided either by a lookup or a locator, then
\paxlink{x-28DREF-EXT-3A-40CANONICALIZATION-20MGL-PAX-3ASECTION-29}{Canonicalization\texttt{}}
works with casts. Here, we look at how to define these.

\emph{Implementation note:} All three are currently implemented as
methods of generic functions with
\href{http://www.lispworks.com/documentation/HyperSpec/Body/07_fb.htm}{\texttt{eql}
specializers} for the locative type, which may easily prove to be
problematic down the road. To make future changes easier, the generic
function and the methods are hidden behind e.g. the
\paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{\texttt{define-lookup}}
and
\paxlink{x-28DREF-EXT-3ACALL-LOOKUP-20MGL-PAX-3AMACRO-29}{\texttt{call-lookup}}
macros.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L551}{variable}\paxname{*check-locate*}\phantomsection\label{x-28DREF-EXT-3A-2ACHECK-LOCATE-2A-20VARIABLE-29}
  \emph{nil}

  Enable runtime verification of invariants during
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} calls. This
  carries a performance penalty and is intended for testing and
  debugging.

  In particular, enforce the rule of
  \paxlink{x-28DREF-EXT-3A-40CAST-NAME-CHANGE-20MGL-PAX-3ASECTION-29}{Cast
  Name Change\texttt{}} and that
  \paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{lookups\texttt{}},
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{locators\texttt{}}
  and
  \paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{casts\texttt{}}
  obey the following:

  \begin{itemize}
  \item
    The value returned must be either \texttt{nil} or a
    \texttt{dref}(\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{0}}
    \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{1}}). Alternatively,
    \texttt{locate-error}(\paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{0}}
    \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20FUNCTION-29}{\texttt{1}}) may
    be signalled.
  \item
    If a \texttt{dref} is returned, then its
    \paxlink{x-28DREF-3ADREF-LOCATIVE-TYPE-20FUNCTION-29}{\texttt{dref-locative-type}}
    must be
    \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-20FUNCTION-29}{\texttt{locative-type}},
    and its class must be the
    \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}
    of \texttt{locative-type}.
  \item
    \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
    must be congruent with the destructuring lambda list in the
    definition of \texttt{locative-type}.
  \end{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L738}{macro}\paxname{define-lookup}\phantomsection\label{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}
  \emph{locative-type (name locative-args) \&body body}

  Define a method of looking up
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}s
  of \texttt{locative-type} with the given \texttt{locative-args}.
  Lookups are invoked by
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} when its
  \texttt{object} argument is an
  \texttt{xref}(\paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{0}}
  \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{1}}) with
  \texttt{locative-type} but it is not a
  \texttt{dref}(\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{0}}
  \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{1}}), as in the case
  of
  \texttt{(dref\ \textquotesingle{}print\ \textquotesingle{}function)}.
  When called, the variables \texttt{name} and \texttt{locative-args}
  are bound to
  \paxlink{x-28DREF-3AXREF-NAME-20-28MGL-PAX-3AREADER-20DREF-3AXREF-29-29}{\texttt{xref-name}}
  and
  \paxlink{x-28DREF-3AXREF-LOCATIVE-ARGS-20FUNCTION-29}{\texttt{xref-locative-args}}
  of the \texttt{xref}. \texttt{locative-args} is validated with
  \paxlink{x-28DREF-EXT-3ACHECK-LOCATIVE-ARGS-20MGL-PAX-3AMACRO-29}{\texttt{check-locative-args}}
  before \texttt{body} is evaluated.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}lookup variable (name locative{-}args)}
\NormalTok{  (}\KeywordTok{unless}\NormalTok{ (special{-}variable{-}name{-}p name)}
\NormalTok{    (locate{-}error))}
\NormalTok{  (}\KeywordTok{make{-}instance} \DataTypeTok{\textquotesingle{}variable{-}dref} \BuiltInTok{:name}\NormalTok{ name :locative }\DataTypeTok{\textquotesingle{}variable}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{itemize}
  \item
    \texttt{locative-type} is a valid
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}}.
  \item
    \texttt{name} and \texttt{locative-args} are both
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_symbol.htm}{\texttt{symbol}}s.
  \end{itemize}

  The above are enforced at macro-expansion time.

  \begin{itemize}
  \tightlist
  \item
    \texttt{body} must follow the rules in
    \paxlink{x-28DREF-EXT-3A-2ACHECK-LOCATE-2A-20VARIABLE-29}{\texttt{*check-locate*}}.
  \end{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L770}{macro}\paxname{call-lookup}\phantomsection\label{x-28DREF-EXT-3ACALL-LOOKUP-20MGL-PAX-3AMACRO-29}
  \emph{name locative-type locative-args}

  Call the
  \paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{lookup\texttt{}}
  for \texttt{locative-type} with \texttt{name} and
  \texttt{locative-args}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L775}{macro}\paxname{define-locator}\phantomsection\label{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}
  \emph{locative-type ((object class)) \&body body}

  Define a method of finding the
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  with \texttt{locative-type} of instances of \texttt{class}. When a
  locator\textquotesingle s \texttt{body} is evaluated, \texttt{object}
  is bound to such an instance.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}locator }\KeywordTok{class}\NormalTok{ ((}\KeywordTok{class} \KeywordTok{class}\NormalTok{))}
\NormalTok{  (}\KeywordTok{make{-}instance} \DataTypeTok{\textquotesingle{}class{-}dref} \BuiltInTok{:name}\NormalTok{ (}\KeywordTok{class{-}name} \KeywordTok{class}\NormalTok{) :locative }\DataTypeTok{\textquotesingle{}class}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  \begin{itemize}
  \item
    \texttt{locative-type} is one of
    \paxlink{x-28DREF-3ALISP-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{lisp-locative-types}}.
    This is because
    \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}}
    never \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}
    to first-class objects.
  \item
    \texttt{object} is a
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_symbol.htm}{\texttt{symbol}}.
  \item
    \texttt{class} names a
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}}
    that is not a subtype of
    \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}. For how to
    convert definitions from one locative type to another, see
    \paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{\texttt{define-cast}}.
  \end{itemize}

  The above are enforced at macro-expansion time.

  \begin{itemize}
  \tightlist
  \item
    \texttt{body} must follow the rules in
    \paxlink{x-28DREF-EXT-3A-2ACHECK-LOCATE-2A-20VARIABLE-29}{\texttt{*check-locate*}}.
  \end{itemize}

  In contrast to when the
  \paxlink{x-28DREF-EXT-3A-40INITIAL-DEFINITION-20MGL-PAX-3ASECTION-29}{Initial
  Definition\texttt{}} is created from an \texttt{xref} (see
  \paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{\texttt{define-lookup}}),
  here
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}
  are determined from \texttt{object}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L810}{macro}\paxname{call-locator}\phantomsection\label{x-28DREF-EXT-3ACALL-LOCATOR-20MGL-PAX-3AMACRO-29}
  \emph{object locative-type}

  Call the
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{locator\texttt{}}
  for \texttt{locative-type} with \texttt{object}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L814}{macro}\paxname{define-cast}\phantomsection\label{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}
  \emph{locative-type ((dref dref-class)) \&body body}

  Define a method of converting a
  \paxlink{x-28DREF-3A-40DEFINITION-20MGL-PAX-3AGLOSSARY-TERM-29}{definition\texttt{}}
  to another with \texttt{locative-type}. When a cast\textquotesingle s
  \texttt{body} is evaluated, \texttt{dref} is bound to an instance
  \texttt{dref-class}, which denotes a valid but potentially
  \paxlink{x-28DREF-EXT-3A-40CANONICALIZATION-20MGL-PAX-3ASECTION-29}{non-canonical\texttt{}}
  definition.

  Note the
  \paxlink{x-28DREF-EXT-3A-40DEFAULT-DOWNCAST-20MGL-PAX-3ASECTION-29}{Default
  Downcast\texttt{}} often suffices, and defining a cast is only
  necessary if the
  \paxlink{x-28DREF-EXT-3A-40CAST-NAME-CHANGE-20MGL-PAX-3ASECTION-29}{name\texttt{}}
  or the locative args change:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(define{-}cast accessor ((dref reader{-}dref))}
\NormalTok{  (}\KeywordTok{let}\NormalTok{ ((name (dref{-}name dref))}
\NormalTok{        (}\KeywordTok{class}\NormalTok{ (}\KeywordTok{second}\NormalTok{ (dref{-}locative dref))))}
\NormalTok{    (}\KeywordTok{when}\NormalTok{ (}\KeywordTok{ignore{-}errors}\NormalTok{ (find{-}accessor{-}slot{-}definition name }\KeywordTok{class}\NormalTok{))}
\NormalTok{      (}\KeywordTok{make{-}instance} \DataTypeTok{\textquotesingle{}accessor{-}dref} \BuiltInTok{:name}\NormalTok{ name}
\NormalTok{                      :locative \textasciigrave{}(accessor ,}\KeywordTok{class}\NormalTok{)))))}
\end{Highlighting}
\end{Shaded}

  \begin{itemize}
  \item
    \texttt{locative-type} is a valid
    \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
    type\texttt{}}.
  \item
    If \texttt{locative-type} is one of
    \paxlink{x-28DREF-3APSEUDO-LOCATIVE-TYPES-20FUNCTION-29}{\texttt{pseudo-locative-types}},
    then \texttt{dref-class} must be of another pseudo locative type.
  \item
    \texttt{dref-class} is either a direct \emph{downcast} or an
    potentially non-direct \emph{upcast}.

    \begin{itemize}
    \item
      \emph{Downcast:} In this case, \texttt{locative-type} is one of
      \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUBS-20FUNCTION-29}{\texttt{locative-type-direct-subs}}
      of (\texttt{dref-class-to-locative-type} \texttt{dref-class}).

      Downcasting to non-direct subtypes is done in multiple steps.
      Consequently,the \texttt{body} of a downcast can rely on
      (\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_clas_1.htm}{\texttt{class-of}}
      \texttt{dref}) being
      \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_class.htm}{\texttt{class}},
      not any subclass thereof.
    \item
      \emph{Upcast:} \texttt{locative-type} is different but reachable
      from (\texttt{dref-class-to-locative-type} \texttt{dref-class}) by
      repeatedly choosing one of
      \paxlink{x-28DREF-EXT-3ALOCATIVE-TYPE-DIRECT-SUPERS-20FUNCTION-29}{\texttt{locative-type-direct-supers}}.
      Upcasting to non-direct supertypes is done in one step.
    \end{itemize}
  \end{itemize}

  The above are enforced at macro-expansion time.

  \begin{itemize}
  \tightlist
  \item
    \texttt{body} must follow the rules in
    \paxlink{x-28DREF-EXT-3A-2ACHECK-LOCATE-2A-20VARIABLE-29}{\texttt{*check-locate*}},
    including those in
    \paxlink{x-28DREF-EXT-3A-40CAST-NAME-CHANGE-20MGL-PAX-3ASECTION-29}{Cast
    Name Change\texttt{}}.
  \end{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L884}{macro}\paxname{call-cast}\phantomsection\label{x-28DREF-EXT-3ACALL-CAST-20MGL-PAX-3AMACRO-29}
  \emph{locative-type dref}

  Call the
  \paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{cast\texttt{}}
  to \texttt{locative-type} with \texttt{dref}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L723}{function}\paxname{locate-error}\phantomsection\label{x-28DREF-EXT-3ALOCATE-ERROR-20FUNCTION-29}
  \emph{\&optional format-control \&rest format-args}

  Call this function to signal a
  \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{locate-error}}
  condition from the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#dynamic_extent}{dynamic
  extent} of a
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}} call, that
  is, from the \texttt{body}s of
  \paxlink{x-28DREF-EXT-3ADEFINE-LOOKUP-20MGL-PAX-3AMACRO-29}{\texttt{define-lookup}},
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{\texttt{define-locator}}
  and
  \paxlink{x-28DREF-EXT-3ADEFINE-CAST-20MGL-PAX-3AMACRO-29}{\texttt{define-cast}}.
  It is an error to call \texttt{locate-error} elsewhere.

  \texttt{format-control}, if non-\texttt{nil}, is a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_f.htm\#format_control}{format
  control} for which \texttt{format-args} are suitable.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L345}{macro}\paxname{check-locative-args}\phantomsection\label{x-28DREF-EXT-3ACHECK-LOCATIVE-ARGS-20MGL-PAX-3AMACRO-29}
  \emph{locative-type locative-args}

  Signal a
  \paxlink{x-28DREF-EXT-3ALOCATE-ERROR-20CONDITION-29}{\texttt{locate-error}}
  condition if \texttt{locative-args} do not match the
  \texttt{lambda-list} argument of \texttt{locative-type} (not
  evaluated).
\end{itemize}

\subsection{Extending Everything Else}\label{extending-everything-else}

\label{x-28DREF-EXT-3A-40EXTENDING-EVERYTHING-ELSE-20MGL-PAX-3ASECTION-29}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L901}{generic-function}\paxname{resolve*}\phantomsection\label{x-28DREF-EXT-3ARESOLVE-2A-20GENERIC-FUNCTION-29}
  \emph{dref}

  Return the object defined by the definition \texttt{dref} refers to.
  Signal a
  \paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20CONDITION-29}{\texttt{resolve-error}}
  condition by calling the
  \paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20FUNCTION-29}{\texttt{resolve-error}}
  function if the lookup fails.

  To keep \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}} a
  partial inverse of
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}},
  \paxlink{x-28DREF-EXT-3ADEFINE-LOCATOR-20MGL-PAX-3AMACRO-29}{\texttt{define-locator}}
  may be necessary for \texttt{resolve}able definitions. This function
  is for extending \texttt{resolve}. Do not call it directly.

  It is an error for methods of this generic function to return an
  \paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{xref}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L920}{function}\paxname{resolve-error}\phantomsection\label{x-28DREF-EXT-3ARESOLVE-ERROR-20FUNCTION-29}
  \emph{\&rest format-and-args}

  Call this function to signal a
  \paxlink{x-28DREF-EXT-3ARESOLVE-ERROR-20CONDITION-29}{\texttt{resolve-error}}
  condition from the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#dynamic_extent}{dynamic
  extent} of a
  \paxlink{x-28DREF-EXT-3ARESOLVE-2A-20GENERIC-FUNCTION-29}{\texttt{resolve*}}
  method. It is an error to call \texttt{resolve-error} elsewhere.

  \texttt{format-and-args}, if non-\texttt{nil}, is a format string and
  arguments suitable for
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_format.htm}{\texttt{format}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L933}{generic-function}\paxname{map-definitions-of-name}\phantomsection\label{x-28DREF-EXT-3AMAP-DEFINITIONS-OF-NAME-20GENERIC-FUNCTION-29}
  \emph{fn name locative-type}

  Call \texttt{fn} with
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s which can be
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d with an
  \texttt{xref}(\paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{0}}
  \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{1}}) with
  \texttt{name}, \texttt{locative-type} and some
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}.
  The strange wording here is because there may be multiple ways (and
  thus \texttt{xref}s) that refer to the same definition.

  For most locative types, there is at most one such definition, but for
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_method.htm}{\texttt{method}},
  for example, there may be many. The default method simply does
  \texttt{(dref\ name\ locative-type\ nil)} and calls \texttt{fn} with
  result if \paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{dref}}
  succeeds.

  \texttt{fn} must not be called with the same (under
  \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}}) definition
  multiple times.

  This function is for extending
  \paxlink{x-28DREF-3ADEFINITIONS-20FUNCTION-29}{\texttt{definitions}}
  and
  \paxlink{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}{\texttt{dref-apropos}}.
  Do not call it directly.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L957}{generic-function}\paxname{map-definitions-of-type}\phantomsection\label{x-28DREF-EXT-3AMAP-DEFINITIONS-OF-TYPE-20GENERIC-FUNCTION-29}
  \emph{fn locative-type}

  Call \texttt{fn} with
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}s which can be
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d with an
  \texttt{xref}(\paxlink{x-28DREF-3AXREF-20CLASS-29}{\texttt{0}}
  \paxlink{x-28DREF-3AXREF-20FUNCTION-29}{\texttt{1}}) with
  \texttt{locative-type} with some \texttt{name} and
  \paxlink{x-28DREF-EXT-3ALOCATIVE-ARGS-20FUNCTION-29}{\texttt{locative-args}}.

  The default method forms \texttt{xref}s by combining each interned
  symbol as
  \paxlink{x-28DREF-3A-40NAME-20MGL-PAX-3AGLOSSARY-TERM-29}{name\texttt{}}s
  with \texttt{locative-type} and no \texttt{locative-args} and calls
  \texttt{fn} if it \texttt{locate}s a definition.

  \texttt{fn} may be called with \texttt{dref}s that are
  \paxlink{x-28DREF-3AXREF-3D-20FUNCTION-29}{\texttt{xref=}} but differ
  in the \texttt{xref} in their
  \paxlink{x-28DREF-3ADREF-ORIGIN-20-28MGL-PAX-3AREADER-20DREF-3ADREF-29-29}{\texttt{dref-origin}}.

  This function is for extending
  \paxlink{x-28DREF-3ADREF-APROPOS-20FUNCTION-29}{\texttt{dref-apropos}}.
  Do not call it directly.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L982}{generic-function}\paxname{arglist*}\phantomsection\label{x-28DREF-EXT-3AARGLIST-2A-20GENERIC-FUNCTION-29}
  \emph{object}

  To extend
  \paxlink{x-28DREF-3AARGLIST-20FUNCTION-29}{\texttt{arglist}},
  specialize \texttt{object} on a normal Lisp type or on a subclass of
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}.

  \texttt{arglist} first calls \texttt{arglist*} with its
  \texttt{object} argument. If that doesn\textquotesingle t work (i.e.
  the second value returned is \texttt{nil}), then it calls
  \texttt{arglist*} with \texttt{object} either
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}d (if
  it\textquotesingle s a \texttt{dref}) or
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d (if
  it\textquotesingle s not a \texttt{dref}).

  \begin{itemize}
  \item
    The default method returns \texttt{nil}, \texttt{nil}.
  \item
    There is also a method specialized on
    \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}s\texttt{}}, that
    looks up the
    \paxlink{x-28DREF-EXT-3ADEFINITION-PROPERTY-20FUNCTION-29}{\texttt{definition-property}}
    called \texttt{arglist} and returns its value with
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_vals_l.htm}{\texttt{values-list}}.
    Thus, an arglist and its kind can be specified with something like

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{setf}\NormalTok{ (definition{-}property xref }\DataTypeTok{\textquotesingle{}arglist}\NormalTok{)}
\NormalTok{      (}\KeywordTok{list}\NormalTok{ arglist :destructuring))}
\end{Highlighting}
\end{Shaded}
  \end{itemize}

  This function is for extension only. Do not call it directly.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1010}{generic-function}\paxname{docstring*}\phantomsection\label{x-28DREF-EXT-3ADOCSTRING-2A-20GENERIC-FUNCTION-29}
  \emph{object}

  To extend
  \paxlink{x-28MGL-PAX-3ADOCSTRING-20FUNCTION-29}{\texttt{docstring}},
  specialize \texttt{object} on a normal Lisp type or on a subclass of
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}.

  \texttt{docstring} first calls \texttt{docstring*} with its
  \texttt{object} argument. If that doesn\textquotesingle t work (i.e.
  \texttt{nil} is returned), then it calls \texttt{docstring*} with
  \texttt{object} either
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}d (if
  it\textquotesingle s a \texttt{dref}) or
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d (if
  it\textquotesingle s not a \texttt{dref}).

  \begin{itemize}
  \item
    The default method returns \texttt{nil}.
  \item
    There is also a method specialized on
    \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}s\texttt{}}, that
    looks up the
    \paxlink{x-28DREF-EXT-3ADEFINITION-PROPERTY-20FUNCTION-29}{\texttt{definition-property}}
    called \texttt{docstring} and returns its value with
    \href{http://www.lispworks.com/documentation/HyperSpec/Body/f_vals_l.htm}{\texttt{values-list}}.
    Thus, a docstring and a package can be specified with something like

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{setf}\NormalTok{ (definition{-}property xref }\DataTypeTok{\textquotesingle{}docstring}\NormalTok{)}
\NormalTok{      (}\KeywordTok{list}\NormalTok{ docstring }\VariableTok{*package*}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
  \end{itemize}

  This function is for extension only. Do not call it directly.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1038}{generic-function}\paxname{source-location*}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-2A-20GENERIC-FUNCTION-29}
  \emph{object}

  To extend
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}},
  specialize \texttt{object} on a normal Lisp type or on a subclass of
  \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}}.

  \texttt{source-location} first calls \texttt{source-location*} with
  its \texttt{object} argument. If that doesn\textquotesingle t work
  (i.e. \texttt{nil} or
  \texttt{(:error\ \textless{}message\textgreater{})} is returned), then
  it calls \texttt{source-location*} with \texttt{object} either
  \paxlink{x-28DREF-3ARESOLVE-20FUNCTION-29}{\texttt{resolve}}d (if
  it\textquotesingle s a \texttt{dref}) or
  \paxlink{x-28DREF-3ALOCATE-20FUNCTION-29}{\texttt{locate}}d (if
  it\textquotesingle s not a \texttt{dref}).

  \texttt{source-location} returns the last of the
  \texttt{(:error\ \textless{}message\textgreater{})}s encountered or a
  generic error message if only \texttt{nil}s were returned.

  \begin{itemize}
  \item
    The default method returns \texttt{nil}.
  \item
    There is also a method specialized on
    \paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{dref}s\texttt{}}, that
    looks up the
    \paxlink{x-28DREF-EXT-3ADEFINITION-PROPERTY-20FUNCTION-29}{\texttt{definition-property}}
    called \texttt{source-location}. If present, it must be a function
    of no arguments that returns a source location or \texttt{nil}.
    Typically, this is set up in the defining macro like this:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\KeywordTok{setf}\NormalTok{ (definition{-}property xref }\DataTypeTok{\textquotesingle{}source{-}location}\NormalTok{)}
\NormalTok{      (this{-}source{-}location))}
\end{Highlighting}
\end{Shaded}
  \end{itemize}

  This function is for extension only. Do not call it directly.
\end{itemize}

\subsubsection{Definition Properties}\label{definition-properties}

\label{x-28DREF-EXT-3A-40DEFINITION-PROPERTIES-20MGL-PAX-3ASECTION-29}

Arbitrary data may be associated with definitions. This mechanism is
used by
\paxlink{x-28DREF-EXT-3AARGLIST-2A-20GENERIC-FUNCTION-29}{\texttt{arglist*}},
\paxlink{x-28DREF-EXT-3ADOCSTRING-2A-20GENERIC-FUNCTION-29}{\texttt{docstring*}}
and
\paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-2A-20GENERIC-FUNCTION-29}{\texttt{source-location*}}
for easy extension.

The following functions take an \texttt{xref} argument and not a
\texttt{dref}(\paxlink{x-28DREF-3ADREF-20CLASS-29}{\texttt{0}}
\paxlink{x-28DREF-3ADREF-20FUNCTION-29}{\texttt{1}}) to allow working
with
\paxlink{x-28DREF-EXT-3A-40CANONICALIZATION-20MGL-PAX-3ASECTION-29}{non-canonical\texttt{}}
or non-existent definitions.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1200}{function}\paxname{definition-property}\phantomsection\label{x-28DREF-EXT-3ADEFINITION-PROPERTY-20FUNCTION-29}
  \emph{xref indicator}

  Return the value of the property associated with \texttt{xref} whose
  name is
  \texttt{eql}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_eql.htm}{\texttt{1}})
  to \texttt{indicator}. The second return value indicates whether the
  property was found.
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/m_setf_.htm}{\texttt{setf}}able.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1220}{function}\paxname{delete-definition-property}\phantomsection\label{x-28DREF-EXT-3ADELETE-DEFINITION-PROPERTY-20FUNCTION-29}
  \emph{xref indicator}

  Delete the property associated with \texttt{xref} whose name is
  \texttt{eql}(\href{http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm}{\texttt{0}}
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/t_eql.htm}{\texttt{1}})
  to \texttt{indicator}. Return true if the property was found.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1243}{function}\paxname{definition-properties}\phantomsection\label{x-28DREF-EXT-3ADEFINITION-PROPERTIES-20FUNCTION-29}
  \emph{xref}

  Return the properties of \texttt{xref} as an association list.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1239}{function}\paxname{delete-definition-properties}\phantomsection\label{x-28DREF-EXT-3ADELETE-DEFINITION-PROPERTIES-20FUNCTION-29}
  \emph{xref}

  Delete all properties associated with \texttt{xref}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1230}{function}\paxname{move-definition-properties}\phantomsection\label{x-28DREF-EXT-3AMOVE-DEFINITION-PROPERTIES-20FUNCTION-29}
  \emph{from-xref to-xref}

  Associate all properties of \texttt{from-xref} with \texttt{to-xref},
  as if readding them one-by-one with
  \texttt{(setf\ definition-property)}, and deleting them from
  \texttt{from-xref} with
  \paxlink{x-28DREF-EXT-3ADELETE-DEFINITION-PROPERTY-20FUNCTION-29}{\texttt{delete-definition-property}}.
\end{itemize}

\subsection{\texorpdfstring{\texttt{dref-class}es}{dref-classes}}\label{dref-classes}

\label{x-28DREF-EXT-3A-40DREF-CLASSES-20MGL-PAX-3ASECTION-29}

These are the
\paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-class}}es
corresponding to
\paxlink{x-28DREF-3A-40BASIC-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Basic
Locative Types\texttt{}}. They are exported to make it possible to go
beyond the
\paxlink{x-28DREF-3A-40BASIC-OPERATIONS-20MGL-PAX-3ASECTION-29}{Basic
Operations\texttt{}} (e.g. \texttt{pax:document-object*}). For
\paxlink{x-28DREF-EXT-3A-40DEFINING-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29}{Defining
Locative Types\texttt{}}, they are not necessary, as
\paxlink{x-28DREF-EXT-3ADEFINE-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-locative-type}}
handles inheritance automatically based on its
\texttt{locative-supertypes} argument.

\textbf{\paxlink{x-28DREF-3A-40VARIABLELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
Variables\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L50}{class}\paxname{variable-dref}\phantomsection\label{x-28DREF-EXT-3AVARIABLE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28VARIABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{variable}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L80}{class}\paxname{constant-dref}\phantomsection\label{x-28DREF-EXT-3ACONSTANT-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AVARIABLE-DREF-20CLASS-29}{variable-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3ACONSTANT-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:constant}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40MACROLIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
Macros\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L163}{class}\paxname{macro-dref}\phantomsection\label{x-28DREF-EXT-3AMACRO-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3AMACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:macro}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L206}{class}\paxname{symbol-macro-dref}\phantomsection\label{x-28DREF-EXT-3ASYMBOL-MACRO-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3ASYMBOL-MACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:symbol-macro}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L264}{class}\paxname{compiler-macro-dref}\phantomsection\label{x-28DREF-EXT-3ACOMPILER-MACRO-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{compiler-macro}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L110}{class}\paxname{setf-dref}\phantomsection\label{x-28DREF-EXT-3ASETF-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28SETF-20MGL-PAX-3ALOCATIVE-29}{\texttt{setf}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L463}{class}\paxname{setf-compiler-macro-dref}\phantomsection\label{x-28DREF-EXT-3ASETF-COMPILER-MACRO-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ACOMPILER-MACRO-DREF-20CLASS-29}{compiler-macro-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DREF-3ASETF-COMPILER-MACRO-20MGL-PAX-3ALOCATIVE-29}{\texttt{dref:setf-compiler-macro}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40FUNCTIONLIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
Functions\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L320}{class}\paxname{function-dref}\phantomsection\label{x-28DREF-EXT-3AFUNCTION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{function}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L485}{class}\paxname{setf-function-dref}\phantomsection\label{x-28DREF-EXT-3ASETF-FUNCTION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AFUNCTION-DREF-20CLASS-29}{function-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3ASETF-DREF-20CLASS-29}{setf-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DREF-3ASETF-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{dref:setf-function}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L370}{class}\paxname{generic-function-dref}\phantomsection\label{x-28DREF-EXT-3AGENERIC-FUNCTION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AFUNCTION-DREF-20CLASS-29}{function-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{generic-function}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L515}{class}\paxname{setf-generic-function-dref}\phantomsection\label{x-28DREF-EXT-3ASETF-GENERIC-FUNCTION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AGENERIC-FUNCTION-DREF-20CLASS-29}{generic-function-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3ASETF-FUNCTION-DREF-20CLASS-29}{setf-function-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DREF-3ASETF-GENERIC-FUNCTION-20MGL-PAX-3ALOCATIVE-29}{\texttt{dref:setf-generic-function}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L393}{class}\paxname{method-dref}\phantomsection\label{x-28DREF-EXT-3AMETHOD-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28METHOD-20MGL-PAX-3ALOCATIVE-29}{\texttt{method}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L546}{class}\paxname{setf-method-dref}\phantomsection\label{x-28DREF-EXT-3ASETF-METHOD-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AMETHOD-DREF-20CLASS-29}{method-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3ASETF-DREF-20CLASS-29}{setf-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DREF-3ASETF-METHOD-20MGL-PAX-3ALOCATIVE-29}{\texttt{dref:setf-method}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L583}{class}\paxname{method-combination-dref}\phantomsection\label{x-28DREF-EXT-3AMETHOD-COMBINATION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28METHOD-COMBINATION-20MGL-PAX-3ALOCATIVE-29}{\texttt{method-combination}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L610}{class}\paxname{reader-dref}\phantomsection\label{x-28DREF-EXT-3AREADER-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AMETHOD-DREF-20CLASS-29}{method-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:reader}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L674}{class}\paxname{writer-dref}\phantomsection\label{x-28DREF-EXT-3AWRITER-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AMETHOD-DREF-20CLASS-29}{method-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3AWRITER-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:writer}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L738}{class}\paxname{accessor-dref}\phantomsection\label{x-28DREF-EXT-3AACCESSOR-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3AREADER-DREF-20CLASS-29}{reader-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3AWRITER-DREF-20CLASS-29}{writer-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3ASETF-METHOD-DREF-20CLASS-29}{setf-method-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3AACCESSOR-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:accessor}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L806}{class}\paxname{structure-accessor-dref}\phantomsection\label{x-28DREF-EXT-3ASTRUCTURE-ACCESSOR-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ASETF-FUNCTION-DREF-20CLASS-29}{setf-function-dref\texttt{}}
  \paxlink{x-28DREF-EXT-3AFUNCTION-DREF-20CLASS-29}{function-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:structure-accessor}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40TYPELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
Types and Declarations\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L891}{class}\paxname{type-dref}\phantomsection\label{x-28DREF-EXT-3ATYPE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28TYPE-20MGL-PAX-3ALOCATIVE-29}{\texttt{type}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L949}{class}\paxname{class-dref}\phantomsection\label{x-28DREF-EXT-3ACLASS-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ATYPE-DREF-20CLASS-29}{type-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28CLASS-20MGL-PAX-3ALOCATIVE-29}{\texttt{class}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L992}{class}\paxname{declaration-dref}\phantomsection\label{x-28DREF-EXT-3ADECLARATION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DECLARATION-20MGL-PAX-3ALOCATIVE-29}{\texttt{declaration}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40CONDITION-SYSTEM-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
the Condition System\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1063}{class}\paxname{condition-dref}\phantomsection\label{x-28DREF-EXT-3ACONDITION-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ACLASS-DREF-20CLASS-29}{class-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28CONDITION-20MGL-PAX-3ALOCATIVE-29}{\texttt{condition}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/early.lisp\#L5}{class}\paxname{restart-dref}\phantomsection\label{x-28DREF-EXT-3ARESTART-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ASYMBOL-LOCATIVE-DREF-20CLASS-29}{symbol-locative-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28RESTART-20MGL-PAX-3ALOCATIVE-29}{\texttt{restart}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40PACKAGELIKE-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
Packages and Readtables\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1122}{class}\paxname{asdf-system-dref}\phantomsection\label{x-28DREF-EXT-3AASDF-SYSTEM-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28ASDF-2FSYSTEM-3ASYSTEM-20MGL-PAX-3ALOCATIVE-29}{\texttt{asdf/system:system}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1166}{class}\paxname{package-dref}\phantomsection\label{x-28DREF-EXT-3APACKAGE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28PACKAGE-20MGL-PAX-3ALOCATIVE-29}{\texttt{package}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1205}{class}\paxname{readtable-dref}\phantomsection\label{x-28DREF-EXT-3AREADTABLE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28READTABLE-20MGL-PAX-3ALOCATIVE-29}{\texttt{readtable}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40UNKNOWN-DEFINITIONS-20MGL-PAX-3ASECTION-29}{for
Unknown Definitions\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1356}{class}\paxname{unknown-dref}\phantomsection\label{x-28DREF-EXT-3AUNKNOWN-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3AUNKNOWN-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:unknown}}.
\end{itemize}

\textbf{\paxlink{x-28DREF-3A-40DREF-LOCATIVES-20MGL-PAX-3ASECTION-29}{for
DRef Constructs\texttt{}}}

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1248}{class}\paxname{dtype-dref}\phantomsection\label{x-28DREF-EXT-3ADTYPE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28DREF-3ADTYPE-20MGL-PAX-3ALOCATIVE-29}{\texttt{dref:dtype}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1274}{class}\paxname{locative-dref}\phantomsection\label{x-28DREF-EXT-3ALOCATIVE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-EXT-3ADTYPE-DREF-20CLASS-29}{dtype-dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of
  \paxlink{x-28MGL-PAX-3ALOCATIVE-20MGL-PAX-3ALOCATIVE-29}{\texttt{mgl-pax:locative}}.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1084}{class}\paxname{symbol-locative-dref}\phantomsection\label{x-28DREF-EXT-3ASYMBOL-LOCATIVE-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  All
  \paxlink{x-28DREF-3A-40LOCATIVE-TYPE-20MGL-PAX-3AGLOSSARY-TERM-29}{locative
  type\texttt{}}s defined with
  \paxlink{x-28DREF-EXT-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20MGL-PAX-3AMACRO-29}{\texttt{define-symbol-locative-type}}
  inherit from this class.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/locatives.lisp\#L1295}{class}\paxname{lambda-dref}\phantomsection\label{x-28DREF-EXT-3ALAMBDA-DREF-20CLASS-29}
  \emph{\paxlink{x-28DREF-3ADREF-20CLASS-29}{dref\texttt{}}}

  \paxlink{x-28DREF-EXT-3ADREF-CLASS-20FUNCTION-29}{\texttt{dref-ext:dref-class}}
  of \paxlink{x-28LAMBDA-20MGL-PAX-3ALOCATIVE-29}{\texttt{lambda}}.
\end{itemize}

\subsection{Source Locations}\label{source-locations}

\label{x-28DREF-EXT-3A-40SOURCE-LOCATIONS-20MGL-PAX-3ASECTION-29}

These represent the file or buffer position of a
\href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
form} and are returned by the
\paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}
function. For the details, see the Elisp function
\texttt{slime-goto-source-location}.

\begin{itemize}
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L19}{function}\paxname{make-source-location}\phantomsection\label{x-28DREF-EXT-3AMAKE-SOURCE-LOCATION-20FUNCTION-29}
  \emph{\&key file file-position buffer buffer-position snippet}

  Make a Swank source location. The ultimate reference is
  \texttt{slime.el}. When \texttt{snippet} is provided, the match
  nearest to \texttt{file-position} is determined (see the Elisp
  \texttt{slime-isearch} and
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-ADJUSTED-FILE-POSITION-20FUNCTION-29}{\texttt{source-location-adjusted-file-position}}).
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L37}{function}\paxname{source-location-p}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-P-20FUNCTION-29}
  \emph{object}

  See if \texttt{object} is a source location object.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L42}{function}\paxname{source-location-file}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-FILE-20FUNCTION-29}
  \emph{location}

  Return the name of the file of the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form}. This may be \texttt{nil}, for example, if \texttt{location} is
  of a
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} that was entered at the REPL, or compiled in the
  \texttt{*slime-scratch*} buffer.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L53}{function}\paxname{source-location-file-position}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-FILE-POSITION-20FUNCTION-29}
  \emph{location}

  Return the file position of the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} or \texttt{nil} if it\textquotesingle s not available. The first
  position is 0.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L61}{function}\paxname{source-location-buffer}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-BUFFER-20FUNCTION-29}
  \emph{location}

  Return the name of the Emacs buffer of the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} or \texttt{nil} if there is no such Emacs buffer.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L70}{function}\paxname{source-location-buffer-position}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-BUFFER-POSITION-20FUNCTION-29}
  \emph{location}

  Return the position of the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} in
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-BUFFER-20FUNCTION-29}{\texttt{source-location-buffer}}
  or \texttt{nil} if it\textquotesingle s not available. The first
  position is 1.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L81}{function}\paxname{source-location-snippet}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-SNIPPET-20FUNCTION-29}
  \emph{location}

  Return the
  \href{http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_d.htm\#defining_form}{defining
  form} or a prefix of it as a string or \texttt{nil} if
  it\textquotesingle s not available.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/full/source-location.lisp\#L87}{function}\paxname{source-location-adjusted-file-position}\phantomsection\label{x-28DREF-EXT-3ASOURCE-LOCATION-ADJUSTED-FILE-POSITION-20FUNCTION-29}
  \emph{location}

  Return the actual file position \texttt{location} points to allowing
  for some deviation from the raw
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-FILE-POSITION-20FUNCTION-29}{\texttt{source-location-file-position}},
  which is adjusted by searching for the nearest occurrence of
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-SNIPPET-20FUNCTION-29}{\texttt{source-location-snippet}}
  in the file. Needless to say, this can be a very expensive operation.

  If
  \paxlink{x-28DREF-EXT-3ASOURCE-LOCATION-FILE-20FUNCTION-29}{\texttt{source-location-file}}
  is \texttt{nil}, \texttt{nil} is returned. If there is no snippet, or
  it doesn\textquotesingle t match, then
  \texttt{source-location-file-position} (or 0 if that\textquotesingle s
  \texttt{nil}) is returned.

  This is a non-interactive companion to the Elisp function
  \texttt{slime-location-offset}, supporting only file positions and
  non-partial matching of snippets.
\item
  \paxlocativetypewithsource{https://github.com/melisgl/mgl-pax/blob/master/dref/src/base/extension-api.lisp\#L1251}{macro}\paxname{this-source-location}\phantomsection\label{x-28DREF-EXT-3ATHIS-SOURCE-LOCATION-20MGL-PAX-3AMACRO-29}

  The value of this macro form is a function of no arguments that
  returns its own
  \paxlink{x-28DREF-3ASOURCE-LOCATION-20FUNCTION-29}{\texttt{source-location}}.
\end{itemize}
