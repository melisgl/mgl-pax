<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
<title>PAX Manual</title>
<link type='text/css' href='style.css' rel='stylesheet'/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<script src="jquery.min.js"></script>
<script src="toc.min.js"></script>
<script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         inlineMath: [['$','$']],
         processEscapes: true
       }
     });
   </script>
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
   </script>
   </head>
<body>
<div id="content-container">
<div id="toc">
<div id="page-toc">
</div>
<div id="toc-footer"><ul><li><a href="https://github.com/melisgl/mgl-pax">[generated by MGL-PAX]</a></li></ul></div>
</div>
<div id="content">
<p><a id='x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L48">&#955;</a></span></span></p>

<h1><a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29">PAX Manual</a></h1>

<h2>Table of Contents</h2>

<ul>
<li><a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)">1 mgl-pax ASDF System Details</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29" title="Links">2 Links</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">3 Background</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">4 Tutorial</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">5 Emacs Integration</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">6 Basics</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">7 Locative Types</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">8 Generating Documentation</a>

<ul>
<li><a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)">8.1 mgl-pax/full ASDF System Details</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">8.2 Markdown Support</a>

<ul>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29" title="Indentation">8.2.1 Indentation</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29" title="Syntax Highlighting">8.2.2 Syntax Highlighting</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29" title="MathJax">8.2.3 MathJax</a></li>
</ul></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">8.3 Documentation Printer Variables</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">8.4 Utilities for Generating Documentation</a>

<ul>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29" title="Github Workflow">8.4.1 Github Workflow</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29" title="PAX World">8.4.2 PAX World</a></li>
</ul></li>
</ul></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">9 Transcripts</a>

<ul>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Transcribing with Emacs">9.1 Transcribing with Emacs</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29" title="Transcript API">9.2 Transcript API</a></li>
</ul></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">10 Extension API</a>

<ul>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29" title="Locatives and References">10.1 Locatives and References</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29" title="Adding New Object Types">10.2 Adding New Object Types</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29" title="Reference Based Extensions">10.3 Reference Based Extensions</a></li>
<li><a href="#x-28MGL-PAX-3A-40MGL-PAX-SECTIONS-20MGL-PAX-3ASECTION-29" title="Sections">10.4 Sections</a></li>
</ul></li>
</ul>

<h6>[in package MGL-PAX with nicknames PAX]</h6>

<p><a id='x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8594;</a> <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/mgl-pax.asd#L1">&#955;</a></span></span></p>

<h2><a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29">1 mgl-pax ASDF System Details</a></h2>

<ul>
<li>Version: 0.0.4</li>
<li>Description: Exploratory programming tool and documentation
  generator.</li>
<li>Licence: MIT, see COPYING.</li>
<li>Author: GÃ¡bor Melis</li>
<li>Mailto: <a href="mailto:mega@retes.hu" >mega@retes.hu</a></li>
<li>Homepage: <a href="http://melisgl.github.io/mgl-pax" >http://melisgl.github.io/mgl-pax</a></li>
<li>Bug tracker: <a href="https://github.com/melisgl/mgl-pax/issues" >https://github.com/melisgl/mgl-pax/issues</a></li>
<li>Source control: <a href="https://github.com/melisgl/mgl-pax.git" >GIT</a></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L60">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29">2 Links</a></h2>

<p>Here is the <a href="https://github.com/melisgl/mgl-pax" >official
repository</a> and the <a href="http://melisgl.github.io/mgl-pax-world/mgl-pax-manual.html" >HTML
documentation</a>
for the latest version.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29" title="Links">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L66">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29">3 Background</a></h2>

<p>As a user, I frequently run into documentation that's incomplete
and out of date, so I tend to stay in the editor and explore the
code by jumping around with SLIME's <a href="http://common-lisp.net/project/slime/doc/html/Finding-definitions.html#Finding-definitions" ><code>M-.</code></a>. As a library
author, I spend a great deal of time polishing code, but precious
little writing documentation.</p>

<p>In fact, I rarely write anything more comprehensive than docstrings
for exported stuff. Writing docstrings feels easier than writing a
separate user manual and they are always close at hand during
development. The drawback of this style is that users of the library
have to piece the big picture together themselves.</p>

<p>That's easy to solve, I thought, let's just put all the narrative
that holds docstrings together in the code and be a bit like a
Literate Programming weenie turned inside out. The original
prototype, which did almost everything I wanted was this:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defmacro</span></i> <i><span class="symbol">defsection</span></i> <span class="paren2">(<span class="code">name docstring</span>)</span>
  `<span class="paren2">(<span class="code"><i><span class="symbol">defun</span></i> ,name <span class="paren3">(<span class="code"></span>)</span> ,docstring</span>)</span></span>)</span></span></code></pre>

<p>Armed with <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>, I soon found myself organizing code following
the flow of user level documentation and relegated comments to
implementational details entirely. However, some portions of
<a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> docstrings were just listings of all the functions,
macros and variables related to the narrative, and this list was
effectively repeated in the <code>DEFPACKAGE</code> form complete with little
comments that were like section names. A clear violation of
<a href="http://c2.com/cgi/wiki?OnceAndOnlyOnce" >OAOO</a>, one of them had to go, so <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> got a list of
symbols to export.</p>

<p>That was great, but soon I found that the listing of symbols is
ambiguous if, for example, a function, a compiler macro and a class
are named by the same symbol. This did not concern exporting, of
course, but it didn't help readability. Distractingly, on such
symbols, <code>M-.</code> was popping up selection dialogs. There were two
birds to kill, and the symbol got accompanied by a type, which was
later generalized into the concept of locatives:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> @mgl-pax-introduction <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"A single line for one man ..."</span>
  <span class="paren2">(<span class="code">foo class</span>)</span>
  <span class="paren2">(<span class="code">bar <i><span class="symbol">function</span></i></span>)</span></span>)</span></span></code></pre>

<p>After a bit of elisp hacking, <code>M-.</code> was smart enough to disambiguate
based on the locative found in the vicinity of the symbol and
everything was good for a while.</p>

<p>Then I realized that sections could refer to other sections if there
were a <a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:SECTION (MGL-PAX:LOCATIVE))"><code>SECTION</code></a> locative. Going down that path, I soon began to feel
the urge to generate pretty documentation as all the necessary
information was manifest in the <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> forms. The design
constraint imposed on documentation generation was that following
the typical style of upcasing symbols in docstrings there should be
no need to explicitly mark up links: if <code>M-.</code> works, then the
documentation generator shall also be able find out what's being
referred to.</p>

<p>I settled on <a href="https://daringfireball.net/projects/markdown/" >Markdown</a> as a reasonably non-intrusive
format, and a few thousand lines later <code>PAX</code> was born.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BACKGROUND-20MGL-PAX-3ASECTION-29" title="Background">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L137">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29">4 Tutorial</a></h2>

<p><code>PAX</code> provides an extremely poor man's Explorable Programming
environment. Narrative primarily lives in so called sections that
mix markdown docstrings with references to functions, variables,
etc, all of which should probably have their own docstrings.</p>

<p>The primary focus is on making code easily explorable by using
SLIME's <code>M-.</code> (<code>slime-edit-definition</code>). See how to enable some
fanciness in <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">Emacs Integration</a>. Generating documentation
from sections and all the referenced items in Markdown or HTML
format is also implemented.</p>

<p>With the simplistic tools provided, one may accomplish similar
effects as with Literate Programming, but documentation is generated
from code, not vice versa and there is no support for chunking yet.
Code is first, code must look pretty, documentation is code.</p>

<p>In typical use, <code>PAX</code> packages have no <code>:EXPORT</code>'s defined. Instead the
<a href="#x-28MGL-PAX-3ADEFINE-PACKAGE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-PACKAGE (MGL-PAX:MACRO))"><code>DEFINE-PACKAGE</code></a> form gets a docstring, which may mention section
names (defined with <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>). When the code is loaded into the
lisp, pressing <code>M-.</code> in SLIME on the name of the section will take
you there. Sections can also refer to other sections, packages,
functions, etc and you can keep exploring.</p>

<p>Here is an example of how it all works together:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">mgl-pax:define-package</span></i> <span class="keyword">:foo-random</span>
  <span class="paren2">(<span class="code"><span class="keyword">:documentation</span> <span class="string">"This package provides various utilities for
  random. See FOO-RANDOM:@FOO-RANDOM-MANUAL."</span></span>)</span>
  <span class="paren2">(<span class="code"><span class="keyword">:use</span> <span class="keyword">#:common-lisp</span> <span class="keyword">#:mgl-pax</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code">in-package <span class="keyword">:foo-random</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> @foo-random-manual <span class="paren2">(<span class="code"><span class="keyword">:title</span> <span class="string">"Foo Random manual"</span></span>)</span>
  <span class="string">"Here you describe what's common to all the referenced (and
  exported) functions that follow. They work with *FOO-STATE*,
  and have a :RANDOM-STATE keyword arg. Also explain when to
  choose which."</span>
  <span class="paren2">(<span class="code">foo-random-state class</span>)</span>
  <span class="paren2">(<span class="code">state <span class="paren3">(<span class="code">reader foo-random-state</span>)</span></span>)</span>
  <span class="string">"Hey we can also print states!"</span>
  <span class="paren2">(<span class="code">print-object <span class="paren3">(<span class="code">method <span class="paren4">(<span class="code"></span>)</span> <span class="paren4">(<span class="code">foo-random-state t</span>)</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code"><span class="special">*foo-state*</span> variable</span>)</span>
  <span class="paren2">(<span class="code">gaussian-random <i><span class="symbol">function</span></i></span>)</span>
  <span class="paren2">(<span class="code">uniform-random <i><span class="symbol">function</span></i></span>)</span>
  <span class="comment">;; this is a subsection
</span>  <span class="paren2">(<span class="code">@foo-random-examples section</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defclass</span></i> foo-random-state <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">state <span class="keyword">:reader</span> state</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> print-object <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">object foo-random-state</span>)</span> stream</span>)</span>
  <span class="paren2">(<span class="code">print-unreadable-object <span class="paren3">(<span class="code">object stream <span class="keyword">:type</span> t</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defvar</span></i> <span class="special">*foo-state*</span> <span class="paren2">(<span class="code">make-instance 'foo-random-state</span>)</span>
  <span class="string">"Much like *RANDOM-STATE* but uses the FOO algorithm."</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> uniform-random <span class="paren2">(<span class="code">limit &amp;key <span class="paren3">(<span class="code">random-state <span class="special">*foo-state*</span></span>)</span></span>)</span>
  <span class="string">"Return a random number from the between 0 and LIMIT (exclusive)
  uniform distribution."</span>
  nil</span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> gaussian-random <span class="paren2">(<span class="code">stddev &amp;key <span class="paren3">(<span class="code">random-state <span class="special">*foo-state*</span></span>)</span></span>)</span>
  <span class="string">"Return a random number from a zero mean normal distribution with
  STDDEV."</span>
  nil</span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> @foo-random-examples <span class="paren2">(<span class="code"><span class="keyword">:title</span> <span class="string">"Examples"</span></span>)</span>
  <span class="string">"Let's see the transcript of a real session of someone working
  with FOO:

  ```cl-transcript
  (values (princ :hello) (list 1 2))
  .. HELLO
  =&gt; :HELLO
  =&gt; (1 2)

  (make-instance 'foo-random-state)
  ==&gt; #&lt;FOO-RANDOM-STATE &gt;
  ```"</span></span>)</span></span></code></pre>

<p>Generating documentation in a very stripped down markdown format is
easy:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">describe @foo-random-manual</span>)</span></span></code></pre>

<p>For this example, the generated markdown would look like this:</p>

<pre><code># Foo Random manual

###### \[in package FOO-RANDOM\]
Here you describe what's common to all the referenced (and
exported) functions that follow. They work with *FOO-STATE*,
and have a :RANDOM-STATE keyword arg. Also explain when to
choose which.

- [class] FOO-RANDOM-STATE

- [reader] STATE FOO-RANDOM-STATE

Hey we can also print states!

- [method] PRINT-OBJECT (OBJECT FOO-RANDOM-STATE) STREAM

- [variable] *FOO-STATE* #&lt;FOO-RANDOM-STATE &gt;

    Much like *RANDOM-STATE* but uses the FOO algorithm.

- [function] GAUSSIAN-RANDOM STDDEV &amp;KEY (RANDOM-STATE *FOO-STATE*)

    Return a random number from a zero mean normal distribution with
    STDDEV.

- [function] UNIFORM-RANDOM LIMIT &amp;KEY (RANDOM-STATE *FOO-STATE*)

    Return a random number from the between 0 and LIMIT (exclusive)
    uniform distribution.

## Examples

Let's see the transcript of a real session of someone working
with FOO:

```cl-transcript
(values (princ :hello) (list 1 2))
.. HELLO
=&gt; :HELLO
=&gt; (1 2)

(make-instance 'foo-random-state)
==&gt; #&lt;FOO-RANDOM-STATE &gt;

```
</code></pre>

<p>More fancy markdown or HTML output with automatic markup and linking
of uppercase symbol names found in docstrings, section numbering,
table of contents, etc is possible by calling the <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> function.</p>

<p><em>One can even generate documentation for different but related
libraries at the same time with the output going to different files,
but with cross-page links being automatically added for symbols
mentioned in docstrings. See <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">Generating Documentation</a> for
some convenience functions to cover the most common cases.</em></p>

<p>Note how <code>(VARIABLE *FOO-STATE*)</code> in the <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> form both
exports <code>*FOO-STATE*</code> and includes its documentation in
<code>@FOO-RANDOM-MANUAL</code>. The symbols <a href="#x-28VARIABLE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(VARIABLE (MGL-PAX:LOCATIVE))"><code>VARIABLE</code></a> and <a href="#x-28FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(FUNCTION (MGL-PAX:LOCATIVE))"><code>FUNCTION</code></a> are just two
instances of 'locatives' which are used in <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> to refer to
definitions tied to symbols. See <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">Locative Types</a>.</p>

<p>The transcript in the code block tagged with <code>cl-transcript</code> is
automatically checked for up-to-dateness. See
<a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">Transcripts</a>.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/navigate.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29">5 Emacs Integration</a></h2>

<p>Integration into SLIME's <code>M-.</code> (<code>slime-edit-definition</code>) allows one
to visit the source location of the thing that's identified by a
symbol and the locative before or after the symbol in a buffer. With
this extension, if a locative is the previous or the next expression
around the symbol of interest, then <code>M-.</code> will go straight to the
definition which corresponds to the locative. If that fails, <code>M-.</code>
will try to find the definitions in the normal way, which may
involve popping up an xref buffer and letting the user interactively
select one of possible definitions.</p>

<p><em>Note that the this feature is implemented in terms of
<code>SWANK-BACKEND:FIND-SOURCE-LOCATION</code> and
<code>SWANK-BACKEND:FIND-DEFINITIONS</code> whose support varies across the Lisp
implementations.</em></p>

<p>In the following examples, pressing <code>M-.</code> when the cursor is on one
of the characters of <code>FOO</code> or just after <code>FOO</code>, will visit the
definition of function <code>FOO</code>:</p>

<pre><code>function foo
foo function
(function foo)
(foo function)
</code></pre>

<p>In particular, references in a <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> form are in (<code>SYMBOL</code>
<a href="#x-28MGL-PAX-3ALOCATIVE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:LOCATIVE (MGL-PAX:LOCATIVE))"><code>LOCATIVE</code></a>) format so <code>M-.</code> will work just fine there.</p>

<p>Just like vanilla <code>M-.</code>, this works in comments and docstrings. In
this example pressing <code>M-.</code> on <code>FOO</code> will visit <code>FOO</code>'s default
method:</p>

<pre><code><span class="code"><span class="comment">;;;; See FOO `(method () (t t t))` for how this all works.
</span><span class="comment">;;;; But if the locative has semicolons inside: FOO `(method
</span><span class="comment">;;;; () (t t t))`, then it won't, so be wary of line breaks
</span><span class="comment">;;;; in comments.</span></span></code></pre>

<p>With a prefix argument (<code>C-u M-.</code>), one can enter a symbol plus a
locative separated by whitespace to preselect one of the
possibilities.</p>

<p>The <code>M-.</code> extensions can be enabled by adding this to your Emacs
initialization file (or loading <code>src/pax.el</code>):</p>

<p><a id='x-28MGL-PAX-3APAX-2EEL-20-28MGL-PAX-3AINCLUDE-20-23P-22-2Fhome-2Fmelisgl-2Fown-2Fmgl-pax-2Fsrc-2Fpax-2Eel-22-20-3AHEADER-NL-20-22-60-60-60elisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29'></a></p>

<pre><code><span class="code"><span class="comment">;;; MGL-PAX M-. integration
</span>
<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> slime-edit-locative-definition <span class="paren2">(<span class="code">name &amp;optional where</span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_127.html#IDX392" class="symbol">or</a> <span class="paren3">(<span class="code">slime-locate-definition name <span class="paren4">(<span class="code">slime-locative-before</span>)</span></span>)</span>
      <span class="paren3">(<span class="code">slime-locate-definition name <span class="paren4">(<span class="code">slime-locative-after</span>)</span></span>)</span>
      <span class="paren3">(<span class="code">slime-locate-definition name <span class="paren4">(<span class="code">slime-locative-after-in-brackets</span>)</span></span>)</span>
      <span class="comment">;; support "foo function" and "function foo" syntax in
</span>      <span class="comment">;; interactive use
</span>      <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_141.html#IDX422" class="symbol"><i><span class="symbol">let</span></i></a> <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">pos <span class="paren6">(<span class="code">cl-position ?\s name</span>)</span></span>)</span></span>)</span>
        <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX387" class="symbol">when</a> pos
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_127.html#IDX392" class="symbol">or</a> <span class="paren6">(<span class="code">slime-locate-definition <span class="paren1">(<span class="code">cl-subseq name 0 pos</span>)</span>
                                       <span class="paren1">(<span class="code">cl-subseq name <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX103" class="symbol">1+</a> pos</span>)</span></span>)</span></span>)</span>
              <span class="paren6">(<span class="code">slime-locate-definition <span class="paren1">(<span class="code">cl-subseq name <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX103" class="symbol">1+</a> pos</span>)</span></span>)</span>
                                       <span class="paren1">(<span class="code">cl-subseq name 0 pos</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> slime-locative-before <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">ignore-errors <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
                   <span class="paren4">(<span class="code">slime-beginning-of-symbol</span>)</span>
                   <span class="paren4">(<span class="code">slime-last-expression</span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> slime-locative-after <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">ignore-errors <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
                   <span class="paren4">(<span class="code">slime-end-of-symbol</span>)</span>
                   <span class="paren4">(<span class="code">slime-forward-sexp</span>)</span>
                   <span class="paren4">(<span class="code">slime-last-expression</span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> slime-locative-after-in-brackets <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">ignore-errors <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
                   <span class="paren4">(<span class="code">slime-end-of-symbol</span>)</span>
                   <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_481.html#IDX1689" class="symbol">skip-chars-forward</a> <span class="string">"`"</span> <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX105" class="symbol">+</a> <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> 1</span>)</span></span>)</span>
                   <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX387" class="symbol">when</a> <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_127.html#IDX391" class="symbol">and</a> <span class="paren6">(<span class="code">= 1 <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_481.html#IDX1689" class="symbol">skip-chars-forward</a> <span class="string">"</span><span class="string">\\</span><span class="string">]"</span> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX105" class="symbol">+</a> <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> 1</span>)</span></span>)</span></span>)</span>
                              <span class="paren6">(<span class="code">= 1 <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_481.html#IDX1689" class="symbol">skip-chars-forward</a> <span class="string">"</span><span class="string">\\</span><span class="string">["</span> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX105" class="symbol">+</a> <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> 1</span>)</span></span>)</span></span>)</span></span>)</span>
                     <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_495.html#IDX1750" class="symbol">buffer-substring-no-properties</a>
                      <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span>
                      <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_125.html#IDX383" class="symbol"><i><span class="symbol">progn</span></i></a> <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_564.html#IDX2061" class="symbol">search-forward</a> <span class="string">"]"</span> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX105" class="symbol">+</a> <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> 1000</span>)</span></span>)</span>
                             <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_63.html#IDX104" class="symbol">1-</a> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> slime-locate-definition <span class="paren2">(<span class="code">name locative</span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX387" class="symbol">when</a> locative
    <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_141.html#IDX422" class="symbol"><i><span class="symbol">let</span></i></a> <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">location
           <span class="paren6">(<span class="code">slime-eval
            <span class="comment">;; Silently fail if mgl-pax is not loaded.
</span>            `<span class="paren1">(<span class="code">cl:when <span class="paren2">(<span class="code">cl:find-package <span class="keyword">:mgl-pax</span></span>)</span>
                      <span class="paren2">(<span class="code">cl:funcall
                       <span class="paren3">(<span class="code">cl:find-symbol
                        <span class="paren4">(<span class="code">cl:symbol-name <span class="keyword">:locate-definition-for-emacs</span></span>)</span> <span class="keyword">:mgl-pax</span></span>)</span>
                       ,name ,locative</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX387" class="symbol">when</a> <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_127.html#IDX391" class="symbol">and</a> <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_81.html#IDX199" class="symbol">consp</a> location</span>)</span>
                 <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_127.html#IDX390" class="symbol">not</a> <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_56.html#IDX68" class="symbol">eq</a> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_82.html#IDX205" class="symbol">car</a> location</span>)</span> <span class="keyword">:error</span></span>)</span></span>)</span></span>)</span>
        <span class="paren5">(<span class="code">slime-edit-definition-cont
         <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_83.html#IDX225" class="symbol">list</a> <span class="paren1">(<span class="code">make-slime-xref <span class="keyword">:dspec</span> `<span class="paren2">(<span class="code">,name</span>)</span>
                                <span class="keyword">:location</span> location</span>)</span></span>)</span>
         <span class="string">"dummy name"</span>
         where</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_372.html#IDX1136" class="symbol">add-hook</a> 'slime-edit-definition-hooks 'slime-edit-locative-definition</span>)</span></span></code></pre>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L296">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29">6 Basics</a></h2>

<p>Now let's examine the most important pieces in detail.</p>

<p><a id='x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L12">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" >DEFSECTION</a></span></span> <span class="locative-args">NAME (&amp;KEY (PACKAGE '<code>*PACKAGE*</code>) (READTABLE '<code>*READTABLE*</code>) (EXPORT <code>T</code>) TITLE LINK-TITLE-TO (DISCARD-DOCUMENTATION-P <a href="#x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DISCARD-DOCUMENTATION-P* (VARIABLE))"><code>*DISCARD-DOCUMENTATION-P*</code></a>)) &amp;BODY ENTRIES</span></span></p>

<p>Define a documentation section and maybe export referenced symbols.
A bit behind the scenes, a global variable with <code>NAME</code> is defined and
is bound to a <a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a> object. By convention, section names
start with the character <code>@</code>. See <a href="#x-28MGL-PAX-3A-40MGL-PAX-TUTORIAL-20MGL-PAX-3ASECTION-29" title="Tutorial">Tutorial</a> for an example.</p>

<p><code>ENTRIES</code> consists of docstrings and references. Docstrings are
arbitrary strings in markdown format, references are defined in the
form:</p>

<pre><code>(symbol locative)
</code></pre>

<p>For example, <code>(FOO FUNCTION)</code> refers to the function <code>FOO</code>, <code>(@BAR
SECTION)</code> says that <code>@BAR</code> is a subsection of this
one. <code>(BAZ (METHOD () (T T T)))</code> refers to the default method of the
three argument generic function <code>BAZ</code>. <code>(FOO FUNCTION)</code> is
equivalent to <code>(FOO (FUNCTION))</code>.</p>

<p>A locative in a reference can either be a symbol or it can be a list
whose <code>CAR</code> is a symbol. In either case, the symbol is the called the
type of the locative while the rest of the elements are the locative
arguments. See <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">Locative Types</a> for the list of locative
types available out of the box.</p>

<p>The same symbol can occur multiple times in a reference, typically
with different locatives, but this is not required.</p>

<p>The references are not looked up (see <a href="#x-28MGL-PAX-3ARESOLVE-20FUNCTION-29" title="(MGL-PAX:RESOLVE FUNCTION)"><code>RESOLVE</code></a> in the
<a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">Extension API</a>) until documentation is generated, so it is
allowed to refer to things yet to be defined.</p>

<p>If <code>EXPORT</code> is true (the default), the referenced symbols and <code>NAME</code> are
candidates for exporting. A candidate symbol is exported if</p>

<ul>
<li><p>it is accessible in <code>PACKAGE</code> (it's not <code>OTHER-PACKAGE:SOMETHING</code>)
  and</p></li>
<li><p>there is a reference to it in the section being defined with a
  locative whose type is approved by <a href="#x-28MGL-PAX-3AEXPORTABLE-LOCATIVE-TYPE-P-20GENERIC-FUNCTION-29" title="(MGL-PAX:EXPORTABLE-LOCATIVE-TYPE-P GENERIC-FUNCTION)"><code>EXPORTABLE-LOCATIVE-TYPE-P</code></a>.</p></li>
</ul>

<p>See <a href="#x-28MGL-PAX-3ADEFINE-PACKAGE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-PACKAGE (MGL-PAX:MACRO))"><code>DEFINE-PACKAGE</code></a> if you use the export feature. The idea with
confounding documentation and exporting is to force documentation of
all exported symbols.</p>

<p><code>TITLE</code> is a non-marked-up string or <code>NIL</code>. If non-NIL, it determines
the text of the heading in the generated output. <code>LINK-TITLE-TO</code> is a
reference given as an
(<code>OBJECT</code> <a href="#x-28MGL-PAX-3ALOCATIVE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:LOCATIVE (MGL-PAX:LOCATIVE))"><code>LOCATIVE</code></a>) pair or <code>NIL</code>, to which the heading will link when
generating HTML. If not specified, the heading will link to its own
anchor.</p>

<p>When <code>DISCARD-DOCUMENTATION-P</code> (defaults to <a href="#x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DISCARD-DOCUMENTATION-P* (VARIABLE))"><code>*DISCARD-DOCUMENTATION-P*</code></a>)
is true, <code>ENTRIES</code> will not be recorded to save memory.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L7">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29" >*DISCARD-DOCUMENTATION-P*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>The default value of <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>'s <code>DISCARD-DOCUMENTATION-P</code> argument.
One may want to set <code>*DISCARD-DOCUMENTATION-P*</code> to true before
building a binary application.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADEFINE-PACKAGE-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L306">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-PACKAGE-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-PACKAGE</a></span></span> <span class="locative-args">PACKAGE &amp;REST OPTIONS</span></span></p>

<p>This is like <code>CL:DEFPACKAGE</code> but silences warnings and errors
signaled when the redefined package is at variance with the current
state of the package. Typically this situation occurs when symbols
are exported by calling <code>EXPORT</code> (as is the case with <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>) as
opposed to adding <code>:EXPORT</code> forms to the <code>DEFPACKAGE</code> form and the
package definition is reevaluated. See the section on <a href="http://www.sbcl.org/manual/#Package-Variance" >package
variance</a> in the SBCL
manual.</p>

<p>The bottom line is that if you rely on <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> to do the
exporting, then you'd better use <a href="#x-28MGL-PAX-3ADEFINE-PACKAGE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-PACKAGE (MGL-PAX:MACRO))"><code>DEFINE-PACKAGE</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-BASICS-20MGL-PAX-3ASECTION-29" title="Basics">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29">7 Locative Types</a></h2>

<p>As we have already briefly seen, locatives allow us to refer to,
document and find the source location of various definitions beyond
what standard Common Lisp offers. See <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">Extension API</a> for a
more detailed treatment. The following are the locatives types
supported out of the box. As all locative types, they are symbols
and their names should make it obvious what kind of things they
refer to. Unless otherwise noted, locatives take no arguments.</p>

<p>When there is a corresponding CL type, a locative can be resolved to
a unique object as is the case in <code>(LOCATE 'FOO 'CLASS)</code> returning
<code>#&lt;CLASS FOO&gt;</code>. Even if there is no such CL type, the source
location and the docstring of the defining form is recorded (see
<a href="#x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-FIND-SOURCE GENERIC-FUNCTION)"><code>LOCATE-AND-FIND-SOURCE</code></a>, <a href="#x-28MGL-PAX-3ALOCATE-AND-DOCUMENT-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-DOCUMENT GENERIC-FUNCTION)"><code>LOCATE-AND-DOCUMENT</code></a> in the
<a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">Extension API</a>), which makes navigating the sources with
<code>M-.</code> (see <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">Emacs Integration</a>) and
<a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">Generating Documentation</a> possible.</p>

<p><a id='x-28VARIABLE-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L50">[locative]</a></span> <span class="reference-object"><a href="#x-28VARIABLE-20-28MGL-PAX-3ALOCATIVE-29-29" >VARIABLE</a></span></span> <span class="locative-args">&amp;OPTIONAL INITFORM</span></span></p>

<p>Refers to a global special variable. <code>INITFORM</code>, or if not specified,
the global value of the variable is included in the documentation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ACONSTANT-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L84">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ACONSTANT-20-28MGL-PAX-3ALOCATIVE-29-29" >CONSTANT</a></span></span> <span class="locative-args">&amp;OPTIONAL INITFORM</span></span></p>

<p>Refers to a <code>DEFCONSTANT</code>. <code>INITFORM</code>, or if not specified,
the value of the constant is included in the documentation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AMACRO-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L118">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AMACRO-20-28MGL-PAX-3ALOCATIVE-29-29" >MACRO</a></span></span></span></li>
</ul>

<p><a id='x-28COMPILER-MACRO-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L143">[locative]</a></span> <span class="reference-object"><a href="#x-28COMPILER-MACRO-20-28MGL-PAX-3ALOCATIVE-29-29" >COMPILER-MACRO</a></span></span></span></li>
</ul>

<p><a id='x-28FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L173">[locative]</a></span> <span class="reference-object"><a href="#x-28FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29" >FUNCTION</a></span></span></span></p>

<p>Note that the arglist in the generated documentation depends on
the quality of <code>SWANK-BACKEND:ARGLIST</code>. It may be that default
values of optional and keyword arguments are missing.</p></li>
</ul>

<p><a id='x-28GENERIC-FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L178">[locative]</a></span> <span class="reference-object"><a href="#x-28GENERIC-FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29" >GENERIC-FUNCTION</a></span></span></span></li>
</ul>

<p><a id='x-28METHOD-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L217">[locative]</a></span> <span class="reference-object"><a href="#x-28METHOD-20-28MGL-PAX-3ALOCATIVE-29-29" >METHOD</a></span></span> <span class="locative-args">METHOD-QUALIFIERS METHOD-SPECIALIZERS</span></span></p>

<p>See <code>CL:FIND-METHOD</code> for the description of the arguments.
This <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> entry refers to the default method of the three
argument generic function <code>FOO</code>:</p>

<pre><code>(foo (method () (t t t)))
</code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3AACCESSOR-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L294">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AACCESSOR-20-28MGL-PAX-3ALOCATIVE-29-29" >ACCESSOR</a></span></span> <span class="locative-args">CLASS-NAME</span></span></p>

<p>To refer to an accessor named <code>FOO-SLOT</code> of class
<code>FOO</code>:</p>

<pre><code>(foo-slot (accessor foo))
</code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3AREADER-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L300">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AREADER-20-28MGL-PAX-3ALOCATIVE-29-29" >READER</a></span></span> <span class="locative-args">CLASS-NAME</span></span></p>

<p>To refer to a reader named <code>FOO-SLOT</code> of class
<code>FOO</code>:</p>

<pre><code>(foo-slot (reader foo))
</code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3AWRITER-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L306">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AWRITER-20-28MGL-PAX-3ALOCATIVE-29-29" >WRITER</a></span></span> <span class="locative-args">CLASS-NAME</span></span></p>

<p>To refer to a writer named <code>FOO-SLOT</code> of class
<code>FOO</code>:</p>

<pre><code>(foo-slot (writer foo))
</code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L436">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASTRUCTURE-ACCESSOR-20-28MGL-PAX-3ALOCATIVE-29-29" >STRUCTURE-ACCESSOR</a></span></span></span></p>

<p>This is a synonym of <a href="#x-28FUNCTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(FUNCTION (MGL-PAX:LOCATIVE))"><code>FUNCTION</code></a> with the difference that the often
ugly and certainly uninformative lambda list will not be printed.</p></li>
</ul>

<p><a id='x-28TYPE-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L471">[locative]</a></span> <span class="reference-object"><a href="#x-28TYPE-20-28MGL-PAX-3ALOCATIVE-29-29" >TYPE</a></span></span></span></p>

<p><code>TYPE</code> can refer to classes as well, but it's better style to use the
more specific <a href="#x-28CLASS-20-28MGL-PAX-3ALOCATIVE-29-29" title="(CLASS (MGL-PAX:LOCATIVE))"><code>CLASS</code></a> locative type for that. Another difference to
<a href="#x-28CLASS-20-28MGL-PAX-3ALOCATIVE-29-29" title="(CLASS (MGL-PAX:LOCATIVE))"><code>CLASS</code></a> is that an attempt is made at printing the arguments of type
specifiers.</p></li>
</ul>

<p><a id='x-28CLASS-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L502">[locative]</a></span> <span class="reference-object"><a href="#x-28CLASS-20-28MGL-PAX-3ALOCATIVE-29-29" >CLASS</a></span></span></span></p>

<p>Naturally, <code>CL:CLASS</code> is the locative type for classes. To refer to a
class named <code>FOO</code>:</p>

<pre><code>(foo class)
</code></pre></li>
</ul>

<p><a id='x-28CONDITION-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L508">[locative]</a></span> <span class="reference-object"><a href="#x-28CONDITION-20-28MGL-PAX-3ALOCATIVE-29-29" >CONDITION</a></span></span></span></p>

<p><code>CL:CONDITION</code> is the locative type for condition. To refer to a
condition named <code>FOO</code>:</p>

<pre><code>(foo condition)
</code></pre></li>
</ul>

<p><a id='x-28RESTART-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L570">[locative]</a></span> <span class="reference-object"><a href="#x-28RESTART-20-28MGL-PAX-3ALOCATIVE-29-29" >RESTART</a></span></span></span></p>

<p>A locative to refer to the definition of a restart defined by
<a href="#x-28MGL-PAX-3ADEFINE-RESTART-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-RESTART (MGL-PAX:MACRO))"><code>DEFINE-RESTART</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADEFINE-RESTART-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L574">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-RESTART-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-RESTART</a></span></span> <span class="locative-args">SYMBOL LAMBDA-LIST &amp;BODY DOCSTRING</span></span></p>

<p>A definer macro to hang the documentation of a restart on a
symbol.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">define-restart</span></i> my-ignore-error <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"Available when MY-ERROR is signalled, MY-IGNORE-ERROR unsafely continues."</span></span>)</span></span></code></pre>

<p>Then <code>(MY-IGNORE-ERROR RESTART)</code> refers to the above definition.
Note that while there is a <a href="#x-28RESTART-20-28MGL-PAX-3ALOCATIVE-29-29" title="(RESTART (MGL-PAX:LOCATIVE))"><code>CL:RESTART</code></a> class, there is no
corresponding source location or docstring like for <a href="#x-28CONDITION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(CONDITION (MGL-PAX:LOCATIVE))"><code>CONDITION</code></a>s.</p></li>
</ul>

<p><a id='x-28ASDF-2FSYSTEM-3ASYSTEM-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L591">[locative]</a></span> <span class="reference-object"><a href="#x-28ASDF-2FSYSTEM-3ASYSTEM-20-28MGL-PAX-3ALOCATIVE-29-29" >ASDF/SYSTEM:SYSTEM</a></span></span></span></p>

<p>Refers to an asdf system. The generated documentation will include
meta information extracted from the system definition. This also
serves as an example of a symbol that's not accessible in the
current package and consequently is not exported.</p></li>
</ul>

<p><a id='x-28PACKAGE-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L658">[locative]</a></span> <span class="reference-object"><a href="#x-28PACKAGE-20-28MGL-PAX-3ALOCATIVE-29-29" >PACKAGE</a></span></span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L678">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" >SECTION</a></span></span></span></p>

<p>Refers to a section defined by <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AINCLUDE-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L728">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AINCLUDE-20-28MGL-PAX-3ALOCATIVE-29-29" >INCLUDE</a></span></span> <span class="locative-args">SOURCE &amp;KEY LINE-PREFIX HEADER FOOTER HEADER-NL FOOTER-NL</span></span></p>

<p>Refers to a region of a file. <code>SOURCE</code> can be a string or a
pathname in which case the whole file is being pointed to or it can
explicitly supply <code>START</code>, <code>END</code> locatives. <code>INCLUDE</code> is typically used to
include non-lisp files in the documentation (say markdown or elisp
as in the next example) or regions of lisp source files. This can
reduce clutter and duplication.</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> example-section <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">pax.el <span class="paren3">(<span class="code">include #.<span class="paren4">(<span class="code">asdf:system-relative-pathname <span class="keyword">:mgl-pax</span> <span class="string">"src/pax.el"</span></span>)</span>
                   <span class="keyword">:header-nl</span> <span class="string">"```elisp"</span> <span class="keyword">:footer-nl</span> <span class="string">"```"</span></span>)</span></span>)</span>
  <span class="paren2">(<span class="code">foo-example <span class="paren3">(<span class="code">include <span class="paren4">(<span class="code"><span class="keyword">:start</span> <span class="paren5">(<span class="code">foo <i><span class="symbol">function</span></i></span>)</span>
                         <span class="keyword">:end</span> <span class="paren5">(<span class="code">end-of-foo-example variable</span>)</span></span>)</span>
                        <span class="keyword">:header-nl</span> <span class="string">"```commonlisp"</span>
                        <span class="keyword">:footer-nl</span> <span class="string">"```"</span></span>)</span></span>)</span>

<span class="paren2">(<span class="code"><i><span class="symbol">defun</span></i> foo <span class="paren3">(<span class="code">x</span>)</span>
  <span class="paren3">(<span class="code">1+ x</span>)</span></span>)</span>

<span class="comment">;;; Since file regions are copied verbatim, comments survive.
</span><span class="paren2">(<span class="code"><i><span class="symbol">defmacro</span></i> bar <span class="paren3">(<span class="code"></span>)</span></span>)</span>

<span class="comment">;;; This comment is the last thing in FOO-EXAMPLE's
</span><span class="comment">;;; documentation since we use the dummy END-OF-FOO-EXAMPLE
</span><span class="comment">;;; variable to mark the end location.
</span><span class="paren2">(<span class="code"><i><span class="symbol">defvar</span></i> end-of-foo-example</span>)</span>

<span class="comment">;;; More irrelevant code follows.</span></span></span></span></code></pre>

<p>In the above example, pressing <code>M-.</code> on <a href="#x-28MGL-PAX-3APAX-2EEL-20-28MGL-PAX-3AINCLUDE-20-23P-22-2Fhome-2Fmelisgl-2Fown-2Fmgl-pax-2Fsrc-2Fpax-2Eel-22-20-3AHEADER-NL-20-22-60-60-60elisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29" title="(MGL-PAX:PAX.EL (MGL-PAX:INCLUDE #P\&quot;/home/melisgl/own/mgl-pax/src/pax.el\&quot; :HEADER-NL \&quot;```elisp\&quot; :FOOTER-NL \&quot;```\&quot;))"><code>PAX.EL</code></a> will open the
<code>src/pax.el</code> file and put the cursor on its first character. <code>M-.</code>
on <code>FOO-EXAMPLE</code> will go to the source location of the <code>(asdf:system
locative)</code> locative.</p>

<p>When documentation is generated, the entire <a href="#x-28MGL-PAX-3APAX-2EEL-20-28MGL-PAX-3AINCLUDE-20-23P-22-2Fhome-2Fmelisgl-2Fown-2Fmgl-pax-2Fsrc-2Fpax-2Eel-22-20-3AHEADER-NL-20-22-60-60-60elisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29" title="(MGL-PAX:PAX.EL (MGL-PAX:INCLUDE #P\&quot;/home/melisgl/own/mgl-pax/src/pax.el\&quot; :HEADER-NL \&quot;```elisp\&quot; :FOOTER-NL \&quot;```\&quot;))"><code>pax.el</code></a> file is
included in the markdown surrounded by the strings given as
<code>HEADER-NL</code> and <code>FOOTER-NL</code> (if any). The trailing newline character is
assumed implicitly. If that's undesirable, then use <code>HEADER</code> and
<code>FOOTER</code> instead. The documentation of <code>FOO-EXAMPLE</code> will be the
region of the file from the source location of the <code>START</code>
locative (inclusive) to the source location of the <code>END</code>
locative (exclusive). <code>START</code> and <code>END</code> default to the beginning and end
of the file, respectively.</p>

<p>Note that the file of the source location of <code>:START</code> and <code>:END</code> must be
the same. If <code>SOURCE</code> is pathname designator, then it must be absolute
so that the locative is context independent.</p>

<p>Finally, if specified <code>LINE-PREFIX</code> is a string that's prepended to
each line included in the documentation. For example, a string of
four spaces makes markdown think it's a code block.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AGLOSSARY-TERM-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L927">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AGLOSSARY-TERM-20-28MGL-PAX-3ALOCATIVE-29-29" >GLOSSARY-TERM</a></span></span></span></p>

<p>Refers to a glossary term defined by <a href="#x-28MGL-PAX-3ADEFINE-GLOSSARY-TERM-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-GLOSSARY-TERM (MGL-PAX:MACRO))"><code>DEFINE-GLOSSARY-TERM</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADEFINE-GLOSSARY-TERM-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L901">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-GLOSSARY-TERM-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-GLOSSARY-TERM</a></span></span> <span class="locative-args">NAME (&amp;KEY TITLE (DISCARD-DOCUMENTATION-P <a href="#x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DISCARD-DOCUMENTATION-P* (VARIABLE))"><code>*DISCARD-DOCUMENTATION-P*</code></a>)) DOCSTRING</span></span></p>

<p>Define a global variable with <code>NAME</code> and set it to a glossary term
object. A glossary term is just a symbol to hang a docstring on. It
is a bit like a <code>SECTION</code>(<a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>0</code></a> <a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:SECTION (MGL-PAX:LOCATIVE))"><code>1</code></a>) in that, when linked to, its <code>TITLE</code> will be
the link text instead of the name of the symbol. Unlike sections
though, glossary terms are not rendered with headings, but in the
more lightweight bullet + locative + name/title style.</p>

<p>When <code>DISCARD-DOCUMENTATION-P</code> (defaults to <a href="#x-28MGL-PAX-3A-2ADISCARD-DOCUMENTATION-P-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DISCARD-DOCUMENTATION-P* (VARIABLE))"><code>*DISCARD-DOCUMENTATION-P*</code></a>)
is true, <code>DOCSTRING</code> will not be recorded to save memory.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATIVE-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L955">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATIVE-20-28MGL-PAX-3ALOCATIVE-29-29" >LOCATIVE</a></span></span> <span class="locative-args">LAMBDA-LIST</span></span></p>

<p>This is the locative for locatives. When <code>M-.</code> is pressed on
<code>SOME-NAME</code> in <code>(SOME-NAME LOCATIVE)</code>, this is what makes it
possible to land at the <code>(DEFINE-LOCATIVE-TYPE SOME-NAME ...)</code> form.
Similarly, <code>(LOCATIVE LOCATIVE)</code> leads to this very definition.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADISLOCATED-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L992">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADISLOCATED-20-28MGL-PAX-3ALOCATIVE-29-29" >DISLOCATED</a></span></span></span></p>

<p>Refers to a symbol in a non-specific context. Useful for preventing
autolinking. For example, if there is a function called <code>FOO</code> then</p>

<pre><code>`FOO`
</code></pre>

<p>will be linked to (if <a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-CODE-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-CODE* (VARIABLE))"><code>*DOCUMENT-LINK-CODE*</code></a>) its definition. However,</p>

<pre><code>[`FOO`][dislocated]
</code></pre>

<p>will not be. On a dislocated locative <a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" title="(MGL-PAX:LOCATE FUNCTION)"><code>LOCATE</code></a> always fails with a
<a href="#x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29" title="(MGL-PAX:LOCATE-ERROR CONDITION)"><code>LOCATE-ERROR</code></a> condition.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AARGUMENT-20-28MGL-PAX-3ALOCATIVE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/locatives.lisp#L1013">[locative]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AARGUMENT-20-28MGL-PAX-3ALOCATIVE-29-29" >ARGUMENT</a></span></span></span></p>

<p>An alias for <a href="#x-28MGL-PAX-3ADISLOCATED-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:DISLOCATED (MGL-PAX:LOCATIVE))"><code>DISLOCATED</code></a>, so the one can refer to an argument of a
macro without accidentally linking to a class that has the same name
as that argument. In the following example, <code>FORMAT</code> may link to
<code>CL:FORMAT</code> (if we generated documentation for it):</p>

<pre><code><span class="code">"See the FORMAT in DOCUMENT."</span></code></pre>

<p>Since <code>ARGUMENT</code> is a locative, we can prevent that linking by writing:</p>

<pre><code><span class="code">"See the FORMAT argument of DOCUMENT."</span></code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVE-TYPES-20MGL-PAX-3ASECTION-29" title="Locative Types">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29">8 Generating Documentation</a></h2>

<p><a id='x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L172">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" >DOCUMENT</a></span></span> <span class="locative-args">OBJECT &amp;KEY STREAM PAGES (FORMAT <code>:MARKDOWN</code>)</span></span></p>

<p>Write <code>OBJECT</code> in <code>FORMAT</code> to <code>STREAM</code> diverting some output to <code>PAGES</code>.
<code>FORMAT</code> can be anything <a href="https://github.com/3b/3bmd" >3BMD</a> supports, which is currently
<code>:MARKDOWN</code>, <code>:HTML</code> and <code>:PLAIN</code>. <code>STREAM</code> may be a stream object, <code>T</code> or <code>NIL</code>
as with <code>CL:FORMAT</code>.</p>

<p>Most often, this function is called on section objects
like <code>(DOCUMENT @MGL-PAX-MANUAL)</code>, but it supports all kinds of
objects for which <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a> is defined. To look up the
documentation of function <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a>:</p>

<pre><code>(document #'document)
</code></pre>

<p>To generate the documentation for separate libraries with automatic
cross-links:</p>

<pre><code>(document (list @cube-manual @mat-manual))
</code></pre>

<p>Note that not only first class objects can have documentation. For
instance, variables and deftypes are not represented by objects.
That's why <code>CL:DOCUMENTATION</code> has a <code>DOC-TYPE</code> argument. <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> does
not have anything like that, instead it relies on <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> objects
to carry the extra information. We are going to see later how
references and locatives work. Until then, here is an example on how
to look up the documentation of type <code>FOO</code>:</p>

<pre><code>(document (locate 'foo 'type))
</code></pre>

<p>One can call <code>DESCRIBE</code> on <a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a> objects to get
documentation in markdown format with less markup than the default.
See <a href="#x-28DESCRIBE-OBJECT-20-28METHOD-20NIL-20-28MGL-PAX-3ASECTION-20T-29-29-29" title="(DESCRIBE-OBJECT (METHOD NIL (MGL-PAX:SECTION T)))"><code>DESCRIBE-OBJECT</code></a> <code>(METHOD () (SECTION T))</code>.</p>

<p>There are quite a few special variables that affect how output is
generated, see <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">Documentation Printer Variables</a>.</p>

<p>The rest of this description deals with how to generate multiple
pages.</p>

<p>The <code>PAGES</code> argument is to create multi-page documents by routing some
of the generated output to files, strings or streams. <code>PAGES</code> is a
list of page specification elements. A page spec is a plist with
keys <code>:OBJECTS</code>, <code>:OUTPUT</code>, <code>:URI-FRAGMENT</code>, <code>:SOURCE-URI-FN</code>, <code>:HEADER-FN</code>
and <code>:FOOTER-FN</code>. <code>OBJECTS</code> is a list of objects (references are allowed
but not required) whose documentation is to be sent to <code>OUTPUT</code>.</p>

<p>When documentation for an object is generated, the first matching
page spec is used, where the object matches the page spec if it is
contained in one of its <code>:OBJECTS</code> in the sense of
<a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" title="(MGL-PAX:COLLECT-REACHABLE-OBJECTS GENERIC-FUNCTION)"><code>COLLECT-REACHABLE-OBJECTS</code></a>.</p>

<p><code>OUTPUT</code> can be a number things:</p>

<ul>
<li><p>If it's a list whose first element is a string or a pathname, then
  output will be sent to the file denoted by that and the rest of
  the elements of the list are passed on as arguments to <code>CL:OPEN</code>.
  One extra keyword argument is <code>:ENSURE-DIRECTORIES-EXIST</code>. If it's
  true, <code>ENSURE-DIRECTORIES-EXIST</code> will be called on the pathname
  before it's opened.</p></li>
<li><p>If it's <code>NIL</code>, then output will be collected in a string.</p></li>
<li><p>If it's <code>T</code>, then output will be sent to <code>*STANDARD-OUTPUT*</code>.</p></li>
<li><p>If it's a stream, then output will be sent to that stream.</p></li>
</ul>

<p>If some pages are specified, <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> returns a list of designators
for generated output. If a page whose <code>OUTPUT</code> refers to a file that
was created (which doesn't happen if nothing would be written to
it), then the corresponding pathname is included in the list. For
strings the string itself, while for streams the stream object is
included in the list. This way it's possible to write some pages to
files and some to strings and have the return value indicate what
was created. The output designators in the returned list are ordered
by creation time.</p>

<p>If no <code>PAGES</code> are specified, <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> returns a single pathname,
string or stream object according to the value of the <code>STREAM</code>
argument.</p>

<p>Note that even if <code>PAGES</code> is specified, <code>STREAM</code> acts as a catch all
taking the generated documentation for references not claimed by any
pages. Also, the filename, string or stream corresponding to <code>STREAM</code>
is always the first element in list of generated things that is the
return value.</p>

<p><code>HEADER-FN</code>, if not <code>NIL</code>, is a function of a single stream argument,
which is called just before the first write to the page. Since
<code>:FORMAT</code> <code>:HTML</code> only generates HTML fragments, this makes it possible
to print arbitrary headers, typically setting the title, css
stylesheet, or charset.</p>

<p><code>FOOTER-FN</code> is similar to <code>HEADER-FN</code>, but it's called after the last
write to the page. For HTML, it typically just closes the body.</p>

<p><code>URI-FRAGMENT</code> is a string such as <code>&quot;doc/manual.html&quot;</code> that specifies
where the page will be deployed on a webserver. It defines how links
between pages will look. If it's not specified and <code>OUTPUT</code> refers
to a file, then it defaults to the name of the file. If <code>URI-FRAGMENT</code>
is <code>NIL</code>, then no links will be made to or from that page.</p>

<p>Finally, <code>SOURCE-URI-FN</code> is a function of a single, <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a>
argument. If it returns a value other than <code>NIL</code>, then it must be a
string representing an URI. If <code>FORMAT</code> is <code>:HTML</code> and
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-MARK-UP-SIGNATURES-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-MARK-UP-SIGNATURES* (VARIABLE))"><code>*DOCUMENT-MARK-UP-SIGNATURES*</code></a> is true, then the locative as
displayed in the signature will be a link to this uri. See
<a href="#x-28MGL-PAX-3AMAKE-GITHUB-SOURCE-URI-FN-20FUNCTION-29" title="(MGL-PAX:MAKE-GITHUB-SOURCE-URI-FN FUNCTION)"><code>MAKE-GITHUB-SOURCE-URI-FN</code></a>.</p>

<p><code>PAGES</code> may look something like this:</p>

<pre><code><span class="code">`<span class="paren1">(<span class="code"><span class="paren2">(<span class="code"><span class="comment">;; The section about SECTIONs and everything below it ...
</span>   <span class="keyword">:objects</span> <span class="paren3">(<span class="code">, @mgl-pax-sections</span>)</span>
   <span class="comment">;; ... is so boring that it's not worth the disk space, so
</span>   <span class="comment">;; send it to a string.
</span>   <span class="keyword">:output</span> <span class="paren3">(<span class="code">nil</span>)</span>
   <span class="comment">;; Explicitly tell other pages not to link to these guys.
</span>   <span class="keyword">:uri-fragment</span> nil</span>)</span>
  <span class="comment">;; Send the @MGL-PAX-EXTENSION-API section and everything reachable
</span>  <span class="comment">;; from it ...
</span>  <span class="paren2">(<span class="code"><span class="keyword">:objects</span> <span class="paren3">(<span class="code">, @mgl-pax-extension-api</span>)</span>
   <span class="comment">;; ... to build/tmp/pax-extension-api.html.
</span>   <span class="keyword">:output</span> <span class="paren3">(<span class="code"><span class="string">"build/tmp/pax-extension-api.html"</span></span>)</span>
   <span class="comment">;; However, on the web server html files will be at this
</span>   <span class="comment">;; location relative to some common root, so override the
</span>   <span class="comment">;; default:
</span>   <span class="keyword">:uri-fragment</span> <span class="string">"doc/dev/pax-extension-api.html"</span>
   <span class="comment">;; Set html page title, stylesheet, charset.
</span>   <span class="keyword">:header-fn</span> 'write-html-header
   <span class="comment">;; Just close the body.
</span>   <span class="keyword">:footer-fn</span> 'write-html-footer</span>)</span>
  <span class="comment">;; Catch the reference that were not reachable from the above. It
</span>  <span class="comment">;; is important for this page spec to be last.
</span>  <span class="paren2">(<span class="code"><span class="keyword">:objects</span> <span class="paren3">(<span class="code">, @mgl-pax-manual</span>)</span>
   <span class="keyword">:output</span> <span class="paren3">(<span class="code"><span class="string">"build/tmp/manual.html"</span></span>)</span>
   <span class="comment">;; Links from the extension api page to the manual page will
</span>   <span class="comment">;; be to ../user/pax-manual#&lt;anchor&gt;, while links going to
</span>   <span class="comment">;; the opposite direction will be to
</span>   <span class="comment">;; ../dev/pax-extension-api.html#&lt;anchor&gt;.
</span>   <span class="keyword">:uri-fragment</span> <span class="string">"doc/user/pax-manual.html"</span>
   <span class="keyword">:header-fn</span> 'write-html-header
   <span class="keyword">:footer-fn</span> 'write-html-footer</span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8594;</a> <a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/mgl-pax.asd#L1">&#955;</a></span></span></p>

<h3><a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29">8.1 mgl-pax/full ASDF System Details</a></h3>

<ul>
<li>Description: <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX</code></a> with all dependencies preloaded.</li>
<li>Long Description: To ease deployment, the set of dependencies of
  the <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX</code></a> system is kept light and its heavier dependencies are
  loaded on demand. If this is undesirable, then the <a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX/FULL</code></a>
  system can be loaded.</li>
<li>Licence: MIT, see COPYING.</li>
<li>Author: GÃ¡bor Melis</li>
<li>Mailto: <a href="mailto:mega@retes.hu" >mega@retes.hu</a></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29" title="Indentation">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L473">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29">8.2 Markdown Support</a></h3>

<p>The <a href="https://daringfireball.net/projects/markdown/" >Markdown</a> in docstrings is processed with the
<a href="https://github.com/3b/3bmd" >3BMD</a> library.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29" title="Syntax Highlighting">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29" title="Indentation">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L480">&#955;</a></span></span></p>

<h4><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29">8.2.1 Indentation</a></h4>

<p>Docstrings can be indented in any of the usual styles. <code>PAX</code>
normalizes indentation by converting:</p>

<pre><code>(defun foo ()
  &quot;This is
  indented
  differently&quot;)
</code></pre>

<p>to</p>

<pre><code>(defun foo ()
  &quot;This is
indented
differently&quot;)
</code></pre>

<p>See <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20-28METHOD-20NIL-20-28STRING-20T-29-29-29" title="(MGL-PAX:DOCUMENT-OBJECT (METHOD NIL (STRING T)))"><code>DOCUMENT-OBJECT</code></a> for the details.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-INDENTATION-20MGL-PAX-3ASECTION-29" title="Indentation">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29" title="MathJax">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29" title="Syntax Highlighting">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L498">&#955;</a></span></span></p>

<h4><a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29">8.2.2 Syntax Highlighting</a></h4>

<p>For syntax highlighting, github's <a href="https://help.github.com/articles/github-flavored-markdown#fenced-code-blocks" >fenced code
blocks</a> markdown extension to mark up code
blocks with triple backticks is enabled so all you need to do is
write:</p>

<pre><code>```elisp
(defun foo ())
```
</code></pre>

<p>to get syntactically marked up HTML output. Copy <code>src/style.css</code>
from <code>PAX</code> and you are set. The language tag, <code>elisp</code> in this example,
is optional and defaults to <code>common-lisp</code>.</p>

<p>See the documentation of <a href="https://github.com/3b/3bmd" >3BMD</a> and <a href="https://github.com/redline6561/colorize/" >colorize</a> for
the details.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SYNTAX-HIGHLIGHTING-20MGL-PAX-3ASECTION-29" title="Syntax Highlighting">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MARKDOWN-SUPPORT-20MGL-PAX-3ASECTION-29" title="Markdown Support">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29" title="MathJax">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L519">&#955;</a></span></span></p>

<h4><a href="#x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29">8.2.3 MathJax</a></h4>

<p>Displaying pretty mathematics in TeX format is supported via
MathJax. It can be done inline with <code>$</code> like this:</p>

<pre><code>$\int_0^\infty e^{-x^2} dx=\frac{\sqrt{\pi}}{2}$
</code></pre>

<p>which is diplayed as $\int_0^\infty e^{-x^2}
dx=\frac{\sqrt{\pi}}{2}$, or it can be delimited by <code>$$</code> like this:</p>

<pre><code>$$\int_0^\infty e^{-x^2} dx=\frac{\sqrt{\pi}}{2}$$
</code></pre>

<p>to get: $$\int_0^\infty e^{-x^2} dx=\frac{\sqrt{\pi}}{2}$$</p>

<p>MathJax will leave code blocks (including those inline with
backticks) alone. Outside code blocks, escape <code>$</code> by prefixing it
with a backslash to scare MathJax off.</p>

<p>Escaping all those backslashes in TeX fragments embedded in Lisp
strings can be a pain. <a href="https://github.com/smithzvk/pythonic-string-reader" >Pythonic String
Reader</a> can help
with that.</p>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MATHJAX-20MGL-PAX-3ASECTION-29" title="MathJax">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L542">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29">8.3 Documentation Printer Variables</a></h3>

<p>Docstrings are assumed to be in markdown format and they are pretty
much copied verbatim to the documentation subject to a few knobs
described below.</p>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-UPPERCASE-IS-CODE-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L559">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-UPPERCASE-IS-CODE-2A-20-28VARIABLE-29-29" >*DOCUMENT-UPPERCASE-IS-CODE*</a></span></span> <span class="locative-args">T</span></span></p>

<p>When true, words with at least three characters and no lowercase
characters naming an interned symbol are assumed to be code as if
they were marked up with backticks, which is especially useful when
combined with <a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-CODE-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-CODE* (VARIABLE))"><code>*DOCUMENT-LINK-CODE*</code></a>. For example, this docstring:</p>

<pre><code>&quot;`FOO` and FOO.&quot;
</code></pre>

<p>is equivalent to this:</p>

<pre><code>&quot;`FOO` and `FOO`.&quot;
</code></pre>

<p>iff <code>FOO</code> is an interned symbol. To suppress this behavior, add a
backslash to the beginning of the symbol or right after the leading
* if it would otherwise be parsed as markdown emphasis:</p>

<pre><code>&quot;\\MGL-PAX *\\DOCUMENT-NORMALIZE-PACKAGES*&quot;
</code></pre>

<p>The number of backslashes is doubled above because that's how the
example looks in a docstring. Note that the backslash is discarded
even if <code>*DOCUMENT-UPPERCASE-IS-CODE*</code> is false.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-DOWNCASE-UPPERCASE-CODE-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L581">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-DOWNCASE-UPPERCASE-CODE-2A-20-28VARIABLE-29-29" >*DOCUMENT-DOWNCASE-UPPERCASE-CODE*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>If true, then the names of symbols recognized as code (including
those found if <a href="#x-28MGL-PAX-3A-2ADOCUMENT-UPPERCASE-IS-CODE-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-UPPERCASE-IS-CODE* (VARIABLE))"><code>*DOCUMENT-UPPERCASE-IS-CODE*</code></a>) are downcased in the
output if they only consist of uppercase characters. If it is
<code>:ONLY-IN-MARKUP</code>, then if the output format does not support
markup (e.g. it's <code>:PLAIN</code>), then no downcasing is performed.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-LINK-CODE-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L590">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-CODE-2A-20-28VARIABLE-29-29" >*DOCUMENT-LINK-CODE*</a></span></span> <span class="locative-args">T</span></span></p>

<p>When true, during the process of generating documentation for a
<a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a>, HTML anchors are added before the documentation of
every reference that's not to a section. Also, markdown style
reference links are added when a piece of inline code found in a
docstring refers to a symbol that's referenced by one of the
sections being documented. Assuming <code>BAR</code> is defined, the
documentation for:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> @foo
  <span class="paren2">(<span class="code">foo <i><span class="symbol">function</span></i></span>)</span>
  <span class="paren2">(<span class="code">bar <i><span class="symbol">function</span></i></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> foo <span class="paren2">(<span class="code">x</span>)</span>
  <span class="string">"Calls `BAR` on `X`."</span>
  <span class="paren2">(<span class="code">bar x</span>)</span></span>)</span></span></code></pre>

<p>would look like this:</p>

<pre><code>- [function] FOO X

    Calls [`BAR`][1] on `X`.
</code></pre>

<p>Instead of <code>BAR</code>, one can write <code>[bar][]</code> or <code>[`bar`][]</code> as well.
Since symbol names are parsed according to <code>READTABLE-CASE</code>, character
case rarely matters.</p>

<p>Now, if <code>BAR</code> has references with different locatives:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defsection</span></i> @foo
  <span class="paren2">(<span class="code">foo <i><span class="symbol">function</span></i></span>)</span>
  <span class="paren2">(<span class="code">bar <i><span class="symbol">function</span></i></span>)</span>
  <span class="paren2">(<span class="code">bar type</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> foo <span class="paren2">(<span class="code">x</span>)</span>
  <span class="string">"Calls `BAR` on `X`."</span>
  <span class="paren2">(<span class="code">bar x</span>)</span></span>)</span></span></code></pre>

<p>then documentation would link to all interpretations:</p>

<pre><code>- [function] FOO X

    Calls `BAR`([`1`][link-id-1] [`2`][link-id-2]) on `X`.
</code></pre>

<p>This situation occurs in <code>PAX</code> with <code>SECTION</code>(<a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>0</code></a> <a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:SECTION (MGL-PAX:LOCATIVE))"><code>1</code></a>), which is both a
class (see <a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a>) and a locative type denoted by a
symbol (see <a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:SECTION (MGL-PAX:LOCATIVE))"><code>SECTION</code></a>). Back in the example above,
clearly, there is no reason to link to type <code>BAR</code>, so one may wish
to select the function locative. There are two ways to do that. One
is to specify the locative explicitly as the id of a reference link:</p>

<pre><code>&quot;Calls [BAR][function] on X.&quot;
</code></pre>

<p>However, if in the text there is a locative immediately before or
after the symbol, then that locative is used to narrow down the
range of possibilities. This is similar to what the <code>M-.</code> extension
does. In a nutshell, if <code>M-.</code> works without questions then the
documentation will contain a single link. So this also works without
any markup:</p>

<pre><code>&quot;Calls function `BAR` on X.&quot;
</code></pre>

<p>This last option needs backticks around the locative if it's not a
single symbol.</p>

<p>Note that <a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-CODE-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-CODE* (VARIABLE))"><code>*DOCUMENT-LINK-CODE*</code></a> can be combined with
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-UPPERCASE-IS-CODE-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-UPPERCASE-IS-CODE* (VARIABLE))"><code>*DOCUMENT-UPPERCASE-IS-CODE*</code></a> to have links generated for
uppercase names with no quoting required.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-LINK-SECTIONS-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L663">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-SECTIONS-2A-20-28VARIABLE-29-29" >*DOCUMENT-LINK-SECTIONS*</a></span></span> <span class="locative-args">T</span></span></p>

<p>When true, HTML anchors are generated before the heading of
sections, which allows the table of contents to contain links and
also code-like references to sections (like <code>@FOO-MANUAL</code>) to be
translated to links with the section title being the name of the
link.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-MIN-LINK-HASH-LENGTH-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L670">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-MIN-LINK-HASH-LENGTH-2A-20-28VARIABLE-29-29" >*DOCUMENT-MIN-LINK-HASH-LENGTH*</a></span></span> <span class="locative-args">4</span></span></p>

<p>Recall that markdown reference style links (like <code>[label][id]</code>) are
used for linking to sections and code. It is desirable to have ids
that are short to maintain legibility of the generated markdown, but
also stable to reduce the spurious diffs in the generated
documentation, which can be a pain in a version control system.</p>

<p>Clearly, there is a tradeoff here. This variable controls how many
characters of the md5 sum of the full link id (the reference as a
string) are retained. If collisions are found due to the low number
of characters, then the length of the hash of the colliding
reference is increased.</p>

<p>This variable has no effect on the HTML generated from markdown, but
it can make markdown output more readable.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-MARK-UP-SIGNATURES-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L701">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-MARK-UP-SIGNATURES-2A-20-28VARIABLE-29-29" >*DOCUMENT-MARK-UP-SIGNATURES*</a></span></span> <span class="locative-args">T</span></span></p>

<p>When true, some things such as function names and arglists are
rendered as bold and italic. In <code>:HTML</code> output, locative types become
links to sources (if <code>:SOURCE-URI-FN</code> is provided, see <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a>), and
the symbol becomes a self-link for your permalinking pleasure.</p>

<p>For example, a reference is rendered in markdown roughly as:</p>

<pre><code>- [function] foo x y
</code></pre>

<p>With this option on, the above becomes:</p>

<pre><code>- [function] **foo** *x y*
</code></pre>

<p>Also, in HTML <code>**foo**</code> will be a link to that very entry and
<code>[function]</code> may turn into a link to sources.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-MAX-NUMBERING-LEVEL-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L831">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-MAX-NUMBERING-LEVEL-2A-20-28VARIABLE-29-29" >*DOCUMENT-MAX-NUMBERING-LEVEL*</a></span></span> <span class="locative-args">3</span></span></p>

<p>A non-negative integer. In their hierarchy, sections on levels less
than this value get numbered in the format of <code>3.1.2</code>. Setting it to
0 turns numbering off.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-MAX-TABLE-OF-CONTENTS-LEVEL-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L836">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-MAX-TABLE-OF-CONTENTS-LEVEL-2A-20-28VARIABLE-29-29" >*DOCUMENT-MAX-TABLE-OF-CONTENTS-LEVEL*</a></span></span> <span class="locative-args">3</span></span></p>

<p>A non-negative integer. Top-level sections are given a table of
contents, which includes a nested tree of section titles whose depth
is limited by this value. Setting it to 0 turns generation of the
table of contents off. If <a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-SECTIONS-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-SECTIONS* (VARIABLE))"><code>*DOCUMENT-LINK-SECTIONS*</code></a> is true, then the
table of contents will link to the sections.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-TEXT-NAVIGATION-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L843">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-TEXT-NAVIGATION-2A-20-28VARIABLE-29-29" >*DOCUMENT-TEXT-NAVIGATION*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>If true, then before each heading a line is printed with links to
the previous, parent and next section. Needs
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-SECTIONS-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-SECTIONS* (VARIABLE))"><code>*DOCUMENT-LINK-SECTIONS*</code></a> to be on to work.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-FANCY-HTML-NAVIGATION-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L848">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-FANCY-HTML-NAVIGATION-2A-20-28VARIABLE-29-29" >*DOCUMENT-FANCY-HTML-NAVIGATION*</a></span></span> <span class="locative-args">T</span></span></p>

<p>If true and the output format is HTML, then headings get a
navigation component that consists of links to the previous, parent,
next section and a permalink. This component is normally hidden, it
is visible only when the mouse is over the heading. Needs
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-LINK-SECTIONS-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-LINK-SECTIONS* (VARIABLE))"><code>*DOCUMENT-LINK-SECTIONS*</code></a> to be on to work.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-NORMALIZE-PACKAGES-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1047">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-NORMALIZE-PACKAGES-2A-20-28VARIABLE-29-29" >*DOCUMENT-NORMALIZE-PACKAGES*</a></span></span> <span class="locative-args">T</span></span></p>

<p>If true, symbols are printed relative to <a href="#x-28MGL-PAX-3ASECTION-PACKAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" title="(MGL-PAX:SECTION-PACKAGE (MGL-PAX:READER MGL-PAX:SECTION))"><code>SECTION-PACKAGE</code></a> of the
innermost containing section or with full package names if there is
no containing section. To eliminate ambiguity <code>[in package ...]</code>
messages are printed right after the section heading if necessary.
If false, symbols are always printed relative to the current
package.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GENERATING-DOCUMENTATION-20MGL-PAX-3ASECTION-29" title="Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29" title="Github Workflow">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1627">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29">8.4 Utilities for Generating Documentation</a></h3>

<p>Two convenience functions are provided to serve the common case of
having an <code>ASDF</code> system with some readmes and a directory with for the
HTML documentation and the default css stylesheet.</p>

<p><a id='x-28MGL-PAX-3AUPDATE-ASDF-SYSTEM-READMES-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1645">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AUPDATE-ASDF-SYSTEM-READMES-20FUNCTION-29" >UPDATE-ASDF-SYSTEM-READMES</a></span></span> <span class="locative-args">SECTIONS ASDF-SYSTEM</span></span></p>

<p>Convenience function to generate two readme files in the directory
holding the <code>ASDF-SYSTEM</code> definition.</p>

<p>README.md has anchors, links, inline code, and other markup added.
Not necessarily the easiest on the eye in an editor, but looks good
on github.</p>

<p>README is optimized for reading in text format. Has no links and
cluttery markup.</p>

<p>Example usage:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">update-asdf-system-readmes @mgl-pax-manual <span class="keyword">:mgl-pax</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3AUPDATE-ASDF-SYSTEM-HTML-DOCS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1702">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AUPDATE-ASDF-SYSTEM-HTML-DOCS-20FUNCTION-29" >UPDATE-ASDF-SYSTEM-HTML-DOCS</a></span></span> <span class="locative-args">SECTIONS ASDF-SYSTEM &amp;KEY PAGES (TARGET-DIR (<code>ASDF/SYSTEM:SYSTEM-RELATIVE-PATHNAME</code> <code>ASDF-SYSTEM</code> &quot;doc/&quot;)) (UPDATE-CSS-P <code>T</code>)</span></span></p>

<p>Generate pretty HTML documentation for a single <code>ASDF</code> system,
possibly linking to github. If <code>UPDATE-CSS-P</code>, copy the CSS style
sheet to <code>TARGET-DIR</code>, as well. Example usage:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">update-asdf-system-html-docs @mgl-pax-manual <span class="keyword">:mgl-pax</span></span>)</span></span></code></pre>

<p>The same, linking to the sources on github:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">update-asdf-system-html-docs
  @mgl-pax-manual <span class="keyword">:mgl-pax</span>
  <span class="keyword">:pages</span>
  `<span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="keyword">:objects</span>
    <span class="paren4">(<span class="code">,mgl-pax:@mgl-pax-manual</span>)</span>
    <span class="keyword">:source-uri-fn</span> ,<span class="paren4">(<span class="code">make-github-source-uri-fn
                     <span class="keyword">:mgl-pax</span>
                     <span class="string">"https://github.com/melisgl/mgl-pax"</span></span>)</span></span>)</span></span>)</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-HTML-MAX-NAVIGATION-TABLE-OF-CONTENTS-LEVEL-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1895">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-HTML-MAX-NAVIGATION-TABLE-OF-CONTENTS-LEVEL-2A-20-28VARIABLE-29-29" >*DOCUMENT-HTML-MAX-NAVIGATION-TABLE-OF-CONTENTS-LEVEL*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p><code>NIL</code> or a non-negative integer. If non-NIL, it overrides
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-MAX-NUMBERING-LEVEL-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-MAX-NUMBERING-LEVEL* (VARIABLE))"><code>*DOCUMENT-MAX-NUMBERING-LEVEL*</code></a> in dynamic HTML table of contents on
the left of the page.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-HTML-TOP-BLOCKS-OF-LINKS-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1797">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-HTML-TOP-BLOCKS-OF-LINKS-2A-20-28VARIABLE-29-29" >*DOCUMENT-HTML-TOP-BLOCKS-OF-LINKS*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>A list of blocks of links to be display on the sidebar on the left,
above the table of contents. A block is of the form <code>(&amp;KEY TITLE ID
LINKS)</code>, where <code>TITLE</code> will be displayed at the top of the block in a
HTML <code>DIV</code> with <code>ID</code>, followed by the links. <code>LINKS</code> is a list
of <code>(URI LABEL) elements.</code></p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ADOCUMENT-HTML-BOTTOM-BLOCKS-OF-LINKS-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1804">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ADOCUMENT-HTML-BOTTOM-BLOCKS-OF-LINKS-2A-20-28VARIABLE-29-29" >*DOCUMENT-HTML-BOTTOM-BLOCKS-OF-LINKS*</a></span></span> <span class="locative-args">NIL</span></span></p>

<p>Like <a href="#x-28MGL-PAX-3A-2ADOCUMENT-HTML-TOP-BLOCKS-OF-LINKS-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-HTML-TOP-BLOCKS-OF-LINKS* (VARIABLE))"><code>*DOCUMENT-HTML-TOP-BLOCKS-OF-LINKS*</code></a>, only it is displayed
below the table of contents.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29" title="PAX World">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29" title="Github Workflow">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1908">&#955;</a></span></span></p>

<h4><a href="#x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29">8.4.1 Github Workflow</a></h4>

<p>It is generally recommended to commit generated readmes (see
<a href="#x-28MGL-PAX-3AUPDATE-ASDF-SYSTEM-READMES-20FUNCTION-29" title="(MGL-PAX:UPDATE-ASDF-SYSTEM-READMES FUNCTION)"><code>UPDATE-ASDF-SYSTEM-READMES</code></a>) so that users have something to read
without reading the code and sites like github can display them.</p>

<p>HTML documentation can also be committed, but there is an issue with
that: when linking to the sources (see <a href="#x-28MGL-PAX-3AMAKE-GITHUB-SOURCE-URI-FN-20FUNCTION-29" title="(MGL-PAX:MAKE-GITHUB-SOURCE-URI-FN FUNCTION)"><code>MAKE-GITHUB-SOURCE-URI-FN</code></a>),
the commit id is in the link. This means that code changes need to
be committed first, then HTML documentation regenerated and
committed in a followup commit.</p>

<p>The second issue is that github is not very good at serving HTMLs
files from the repository itself (and
<a href="http://htmlpreview.github.io" >http://htmlpreview.github.io</a> chokes
on links to the sources).</p>

<p>The recommended workflow is to use
<a href="https://pages.github.com/" >gh-pages</a>, which can be made relatively
painless with the <code>git workflow</code> command. The gist of it is to make
the <code>doc/</code> directory a checkout of the branch named <code>gh-pages</code>. A
good description of this process is
<a href="http://sangsoonam.github.io/2019/02/08/using-git-worktree-to-deploy-github-pages.html" >http://sangsoonam.github.io/2019/02/08/using-git-worktree-to-deploy-github-pages.html</a>.
Two commits needed still, but it is somewhat less painful.</p>

<p>This way the HTML documentation will be available at
<code>http://&lt;username&gt;.github.io/&lt;repo-name&gt;</code>. It is probably a good
idea to add section like the <a href="#x-28MGL-PAX-3A-40MGL-PAX-LINKS-20MGL-PAX-3ASECTION-29" title="Links">Links</a> section to allow jumping
between the repository and the gh-pages site.</p>

<p><a id='x-28MGL-PAX-3AMAKE-GITHUB-SOURCE-URI-FN-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1938">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AMAKE-GITHUB-SOURCE-URI-FN-20FUNCTION-29" >MAKE-GITHUB-SOURCE-URI-FN</a></span></span> <span class="locative-args">ASDF-SYSTEM GITHUB-URI &amp;KEY GIT-VERSION</span></span></p>

<p>Return a function suitable as <code>:SOURCE-URI-FN</code> of a page spec (see
the <code>PAGES</code> argument of <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a>). The function looks the source
location of the reference passed to it, and if the location is
found, the path is made relative to the root directory of
<code>ASDF-SYSTEM</code> and finally an URI pointing to github is returned. The
URI looks like this:</p>

<pre><code>https://github.com/melisgl/mgl-pax/blob/master/src/pax-early.lisp#L12
</code></pre>

<p>&quot;master&quot; in the above link comes from <code>GIT-VERSION</code>.</p>

<p>If <code>GIT-VERSION</code> is <code>NIL</code>, then an attempt is made to determine to
current commit id from the <code>.git</code> in the directory holding
<code>ASDF-SYSTEM</code>. If no <code>.git</code> directory is found, then no links to
github will be generated.</p>

<p>A separate warning is signalled whenever source location lookup
fails or if the source location points to a directory not below the
directory of <code>ASDF-SYSTEM</code>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-GITHUB-WORKFLOW-20MGL-PAX-3ASECTION-29" title="Github Workflow">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-UTILITIES-20MGL-PAX-3ASECTION-29" title="Utilities for Generating Documentation">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29" title="PAX World">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L2043">&#955;</a></span></span></p>

<h4><a href="#x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29">8.4.2 PAX World</a></h4>

<p><code>PAX</code> World is a registry of documents, which can generate
cross-linked HTML documentation pages for all the registered
documents.</p>

<p><a id='x-28MGL-PAX-3AREGISTER-DOC-IN-PAX-WORLD-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L2057">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AREGISTER-DOC-IN-PAX-WORLD-20FUNCTION-29" >REGISTER-DOC-IN-PAX-WORLD</a></span></span> <span class="locative-args">NAME SECTIONS PAGE-SPECS</span></span></p>

<p>Register <code>SECTIONS</code> and <code>PAGE-SPECS</code> under <code>NAME</code> in <code>PAX</code> World. By
default, <a href="#x-28MGL-PAX-3AUPDATE-PAX-WORLD-20FUNCTION-29" title="(MGL-PAX:UPDATE-PAX-WORLD FUNCTION)"><code>UPDATE-PAX-WORLD</code></a> generates documentation for all of these.</p></li>
</ul>

<p>For example, this is how <code>PAX</code> registers itself:</p>

<p><a id='x-28MGL-PAX-3AREGISTER-DOC-EXAMPLE-20-28MGL-PAX-3AINCLUDE-20-28-3ASTART-20-28MGL-PAX-3A-3APAX-SECTIONS-20FUNCTION-29-20-3AEND-20-28MGL-PAX-3A-3AEND-OF-REGISTER-DOC-EXAMPLE-20VARIABLE-29-29-20-3AHEADER-NL-20-22-60-60-60commonlisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29'></a></p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> pax-sections <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code">list @mgl-pax-manual</span>)</span></span>)</span>
<span class="paren1">(<span class="code"><i><span class="symbol">defun</span></i> pax-pages <span class="paren2">(<span class="code"></span>)</span>
  `<span class="paren2">(<span class="code"><span class="paren3">(<span class="code"><span class="keyword">:objects</span>
     <span class="paren4">(<span class="code">,mgl-pax:@mgl-pax-manual</span>)</span>
     <span class="keyword">:source-uri-fn</span> ,<span class="paren4">(<span class="code">make-github-source-uri-fn
                      <span class="keyword">:mgl-pax</span>
                      <span class="string">"https://github.com/melisgl/mgl-pax"</span></span>)</span></span>)</span></span>)</span></span>)</span>
<span class="paren1">(<span class="code">register-doc-in-pax-world <span class="keyword">:mgl-pax</span> <span class="paren2">(<span class="code">pax-sections</span>)</span> <span class="paren2">(<span class="code">pax-pages</span>)</span></span>)</span></span></code></pre>

<p><a id='x-28MGL-PAX-3AUPDATE-PAX-WORLD-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L2084">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AUPDATE-PAX-WORLD-20FUNCTION-29" >UPDATE-PAX-WORLD</a></span></span> <span class="locative-args">&amp;KEY DOCS DIR</span></span></p>

<p>Generate HTML documentation for all <code>DOCS</code>. By default, files are
created in <code>*PAX-WORLD-DIR*</code> or <code>(asdf:system-relative-pathname
:mgl-pax &quot;world/&quot;)</code>, if <code>NIL</code>. <code>DOCS</code> is a list of entries of the
form (<code>NAME</code> <code>SECTIONS</code> <code>PAGE-SPECS</code>). The default for <code>DOCS</code> is all the
sections and pages registered with <a href="#x-28MGL-PAX-3AREGISTER-DOC-IN-PAX-WORLD-20FUNCTION-29" title="(MGL-PAX:REGISTER-DOC-IN-PAX-WORLD FUNCTION)"><code>REGISTER-DOC-IN-PAX-WORLD</code></a>.</p>

<p>In the absence of <code>:HEADER-FN</code> <code>:FOOTER-FN</code>, <code>:OUTPUT</code>, every spec in
<code>PAGE-SPECS</code> is augmented with HTML headers, footers and output
location specifications (based on the name of the section).</p>

<p>If necessary a default page spec is created for every section.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-WORLD-20MGL-PAX-3ASECTION-29" title="PAX World">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Transcribing with Emacs">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L18">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29">9 Transcripts</a></h2>

<p>What are transcripts for? When writing a tutorial, one often wants
to include a REPL session with maybe a few defuns and a couple of
forms whose output or return values are shown. Also, in a function's
docstring an example call with concrete arguments and return values
speaks volumes. A transcript is a text that looks like a repl
session, but which has a light markup for printed output and return
values, while no markup (i.e. prompt) for lisp forms. The <code>PAX</code>
transcripts may include output and return values of all forms, or
only selected ones. In either case the transcript itself can be
easily generated from the source code.</p>

<p>The main worry associated with including examples in the
documentation is that they tend to get out-of-sync with the code.
This is solved by being able to parse back and update transcripts.
In fact, this is exactly what happens during documentation
generation with <code>PAX</code>. Code sections tagged <code>cl-transcript</code> are
retranscribed and checked for inconsistency (that is, any difference
in output or return values). If the consistency check fails, an
error is signalled that includes a reference to the object being
documented.</p>

<p>Going beyond documentation, transcript consistency checks can be
used for writing simple tests in a very readable form. For example:</p>

<pre><code>(+ 1 2)
=&gt; 3

(values (princ :hello) (list 1 2))
.. HELLO
=&gt; :HELLO
=&gt; (1 2)
</code></pre>

<p>All in all, transcripts are a handy tool especially when combined
with the Emacs support to regenerate them and with
<code>PYTHONIC-STRING-READER</code> and its triple-quoted strings that allow one
to work with nested strings with less noise. The triple-quote syntax
can be enabled with:</p>

<pre><code>(in-readtable pythonic-string-syntax)
</code></pre>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29" title="Transcript API">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Transcribing with Emacs">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L996">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29">9.1 Transcribing with Emacs</a></h3>

<p>Typical transcript usage from within Emacs is simple: add a lisp
form to a docstring or comment at any indentation level. Move the
cursor right after the end of the form as if you were to evaluate it
with <code>C-x C-e</code>. The cursor is marked by <code>#\^</code>:</p>

<pre><code>This is part of a docstring.

```cl-transcript
(values (princ :hello) (list 1 2))^
```
</code></pre>

<p>Note that the use of fenced code blocks with the language tag
<code>cl-transcript</code> is only to tell <code>PAX</code> to perform consistency checks at
documentation generation time.</p>

<p>Now invoke the elisp function <code>mgl-pax-transcribe</code> where the cursor
is and the fenced code block from the docstring becomes:</p>

<pre><code>(values (princ :hello) (list 1 2))
.. HELLO
=&gt; :HELLO
=&gt; (1 2)
^
</code></pre>

<p>Then you change the printed message and add a comment to the second
return value:</p>

<pre><code>(values (princ :hello-world) (list 1 2))
.. HELLO
=&gt; :HELLO
=&gt; (1
    ;; This value is arbitrary.
    2)
</code></pre>

<p>When generating the documentation you get a
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-CONSISTENCY-ERROR</code></a> because the printed output and the
first return value changed so you regenerate the documentation by
marking the region of bounded by <code>#\|</code> and the cursor at <code>#\^</code> in
the example:</p>

<pre><code>|(values (princ :hello-world) (list 1 2))
.. HELLO
=&gt; :HELLO
=&gt; (1
    ;; This value is arbitrary.
    2)
^
</code></pre>

<p>then invoke the elisp function <code>mgl-pax-retranscribe-region</code> to get:</p>

<pre><code>(values (princ :hello-world) (list 1 2))
.. HELLO-WORLD
=&gt; :HELLO-WORLD
=&gt; (1
    ;; This value is arbitrary.
    2)
^
</code></pre>

<p>Note how the indentation and the comment of <code>(1 2)</code> was left alone
but the output and the first return value got updated.</p>

<p>Alternatively, <code>C-u 1 mgl-pax-transcribe</code> will emit commented markup:</p>

<pre><code>(values (princ :hello) (list 1 2))
;.. HELLO
;=&gt; :HELLO
;=&gt; (1 2)
</code></pre>

<p><code>C-u 0 mgl-pax-retranscribe-region</code> will turn commented into
non-commented markup. In general, the numeric prefix argument is the
index of the syntax to be used in <a href="#x-28-22mgl-pax-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX</code></a>:<a href="#x-28MGL-PAX-3A-2ASYNTAXES-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*SYNTAXES* (VARIABLE))"><code>*SYNTAXES*</code></a>. Without a
prefix argument <code>mgl-pax-retranscribe-region</code> will not change the
markup style.</p>

<p>Finally, not only do both functions work at any indentation level,
but in comments too:</p>

<pre><code>;;;; (values (princ :hello) (list 1 2))
;;;; .. HELLO
;;;; =&gt; :HELLO
;;;; =&gt; (1 2)
</code></pre>

<p>Transcription support in emacs can be enabled by adding this to your
Emacs initialization file (or loading <code>src/transcribe.el</code>):</p>

<p><a id='x-28MGL-PAX-3ATRANSCRIBE-2EEL-20-28MGL-PAX-3AINCLUDE-20-23P-22-2Fhome-2Fmelisgl-2Fown-2Fmgl-pax-2Fsrc-2Ftranscribe-2Eel-22-20-3AHEADER-NL-20-22-60-60-60elisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29'></a></p>

<pre><code><span class="code"><span class="comment">;;; MGL-PAX transcription
</span>
<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> mgl-pax-transcribe-last-expression <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"A bit like C-u C-x C-e (slime-eval-last-expression) that
inserts the output and values of the sexp before the point, this
does the same but with MGL-PAX:TRANSCRIBE. Use a numeric prefix
argument as in index to select one of the Common Lisp
MGL-PAX:*SYNTAXES* as the SYNTAX argument to MGL-PAX:TRANSCRIBE.
Without a prefix argument, the first syntax is used."</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_290.html#SEC290" class="symbol">interactive</a></span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_497.html#IDX1756" class="symbol">insert</a>
   <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
     <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_141.html#IDX423" class="symbol"><i><span class="symbol">let*</span></i></a> <span class="paren5">(<span class="code"><span class="paren6">(<span class="code">end <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span></span>)</span>
            <span class="paren6">(<span class="code">start <span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_125.html#IDX383" class="symbol"><i><span class="symbol">progn</span></i></a> <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_480.html#IDX1680" class="symbol">backward-sexp</a></span>)</span>
                          <span class="paren2">(<span class="code">move-beginning-of-line <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a></span>)</span>
                          <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span></span>)</span></span>)</span></span>)</span>
       <span class="paren5">(<span class="code">mgl-pax-transcribe start end <span class="paren6">(<span class="code">mgl-pax-transcribe-syntax-arg</span>)</span>
                           <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> mgl-pax-retranscribe-region <span class="paren2">(<span class="code">start end</span>)</span>
  <span class="string">"Updates the transcription in the current region (as in calling
MGL-PAX:TRANSCRIBE with :UPDATE-ONLY T). Use a numeric prefix
argument as in index to select one of the Common Lisp
MGL-PAX:*SYNTAXES* as the SYNTAX argument to MGL-PAX:TRANSCRIBE.
Without a prefix argument, the syntax of the input will not be
changed."</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_290.html#SEC290" class="symbol">interactive</a> <span class="string">"r"</span></span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_141.html#IDX423" class="symbol"><i><span class="symbol">let*</span></i></a> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">point-at-start-p <span class="paren5">(<span class="code">= <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> start</span>)</span></span>)</span>
         <span class="paren4">(<span class="code">point-at-end-p <span class="paren5">(<span class="code">= <span class="paren6">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_473.html#IDX1644" class="symbol">point</a></span>)</span> end</span>)</span></span>)</span>
         <span class="paren4">(<span class="code">transcript <span class="paren5">(<span class="code">mgl-pax-transcribe start end
                                         <span class="paren6">(<span class="code">mgl-pax-transcribe-syntax-arg</span>)</span>
                                         <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_266.html#IDX704" class="symbol">t</a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_266.html#IDX704" class="symbol">t</a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a></span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX386" class="symbol"><i><span class="symbol">if</span></i></a> point-at-start-p
        <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_475.html#IDX1650" class="symbol">goto-char</a> start</span>)</span>
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_499.html#IDX1770" class="symbol">delete-region</a> start end</span>)</span>
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_497.html#IDX1756" class="symbol">insert</a> transcript</span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_482.html#IDX1691" class="symbol">save-excursion</a>
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_475.html#IDX1650" class="symbol">goto-char</a> start</span>)</span>
          <span class="paren5">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_499.html#IDX1770" class="symbol">delete-region</a> start end</span>)</span></span>)</span>
      <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_497.html#IDX1756" class="symbol">insert</a> transcript</span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> mgl-pax-transcribe-syntax-arg <span class="paren2">(<span class="code"></span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX386" class="symbol"><i><span class="symbol">if</span></i></a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_318.html#IDX928" class="symbol">current-prefix-arg</a>
      <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_318.html#IDX927" class="symbol">prefix-numeric-value</a> <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_318.html#IDX928" class="symbol">current-prefix-arg</a></span>)</span>
    <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_6.html#SEC6" class="symbol">nil</a></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_167.html#IDX483" class="symbol"><i><span class="symbol">defun</span></i></a> mgl-pax-transcribe <span class="paren2">(<span class="code">start end syntax update-only echo
                                 first-line-special-p</span>)</span>
  <span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_141.html#IDX422" class="symbol"><i><span class="symbol">let</span></i></a> <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">transcription
         <span class="paren5">(<span class="code">slime-eval
          `<span class="paren6">(<span class="code"><i><span class="symbol">cl:if</span></i> <span class="paren1">(<span class="code">cl:find-package <span class="keyword">:mgl-pax</span></span>)</span>
                  <span class="paren1">(<span class="code">cl:funcall
                   <span class="paren2">(<span class="code">cl:find-symbol
                    <span class="paren3">(<span class="code">cl:symbol-name <span class="keyword">:transcribe-for-emacs</span></span>)</span> <span class="keyword">:mgl-pax</span></span>)</span>
                   ,<span class="paren2">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_495.html#IDX1750" class="symbol">buffer-substring-no-properties</a> start end</span>)</span>
                   ',syntax ',update-only ',echo ',first-line-special-p</span>)</span>
                  <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_266.html#IDX704" class="symbol">t</a></span>)</span></span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_126.html#IDX386" class="symbol"><i><span class="symbol">if</span></i></a> <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_56.html#IDX68" class="symbol">eq</a> transcription <a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_266.html#IDX704" class="symbol">t</a></span>)</span>
        <span class="paren4">(<span class="code"><a href="http://www.gnu.org/software/emacs/elisp-manual/html_node/elisp_231.html#IDX610" class="symbol">error</a> <span class="string">"MGL-PAX is not loaded."</span></span>)</span>
      transcription</span>)</span></span>)</span></span>)</span></span></code></pre>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Transcribing with Emacs">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-20MGL-PAX-3ASECTION-29" title="Transcripts">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29" title="Transcript API">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L64">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29">9.2 Transcript API</a></h3>

<p><a id='x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L125">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" >TRANSCRIBE</a></span></span> <span class="locative-args">INPUT OUTPUT &amp;KEY UPDATE-ONLY (INCLUDE-NO-OUTPUT <code>UPDATE-ONLY</code>) (INCLUDE-NO-VALUE <code>UPDATE-ONLY</code>) (ECHO <code>T</code>) CHECK-CONSISTENCY DEFAULT-SYNTAX (INPUT-SYNTAXES <a href="#x-28MGL-PAX-3A-2ASYNTAXES-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*SYNTAXES* (VARIABLE))"><code>*SYNTAXES*</code></a>) (OUTPUT-SYNTAXES <a href="#x-28MGL-PAX-3A-2ASYNTAXES-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*SYNTAXES* (VARIABLE))"><code>*SYNTAXES*</code></a>)</span></span></p>

<p>Read forms from <code>INPUT</code> and write them (iff <code>ECHO</code>) to <code>OUTPUT</code>
followed by any output and return values produced by calling <code>EVAL</code> on
the form. <code>INPUT</code> can be a stream or a string, while <code>OUTPUT</code> can be a
stream or <code>NIL</code> in which case transcription goes into a string. The
return value is the <code>OUTPUT</code> stream or the string that was
constructed.</p>

<p>A simple example is this:</p>

<pre><code>(transcribe "(princ 42) " nil)
=&gt; "(princ 42)
.. 42
=&gt; 42
"
</code></pre>

<p>However, the above may be a bit confusing since this documentation
uses <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> markup syntax in this very example, so let's do it
differently. If we have a file with these contents:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values <span class="paren2">(<span class="code">princ 42</span>)</span> <span class="paren2">(<span class="code">list 1 2</span>)</span></span>)</span></span></code></pre>

<p>it is transcribed to:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values <span class="paren2">(<span class="code">princ 42</span>)</span> <span class="paren2">(<span class="code">list 1 2</span>)</span></span>)</span>
.. 42
=&gt; 42
=&gt; <span class="paren1">(<span class="code">1 2</span>)</span></span></code></pre>

<p>Output to all standard streams is captured and printed with
the <code>:OUTPUT</code> prefix (<code>&quot;..&quot;</code>). The return values above are printed
with the <code>:READABLE</code> prefix (<code>&quot;=&gt;&quot;</code>). Note how these prefixes are
always printed on a new line to facilitate parsing.</p>

<p><strong>Updating</strong></p>

<p><a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> is able to parse its own output. If we transcribe the
previous output above, we get it back exactly. However, if we remove
all output markers, leave only a placeholder value marker and
pass <code>:UPDATE-ONLY</code> <code>T</code> with source:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values <span class="paren2">(<span class="code">princ 42</span>)</span> <span class="paren2">(<span class="code">list 1 2</span>)</span></span>)</span>
=&gt;</span></code></pre>

<p>we get this:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values <span class="paren2">(<span class="code">princ 42</span>)</span> <span class="paren2">(<span class="code">list 1 2</span>)</span></span>)</span>
=&gt; 42
=&gt; <span class="paren1">(<span class="code">1 2</span>)</span></span></code></pre>

<p>With <code>UPDATE-ONLY</code>, printed output of a form is only transcribed if
there were output markers in the source. Similarly, with
<code>UPDATE-ONLY</code>, return values are only transcribed if there were value
markers in the source.</p>

<p><strong>No Output/Values</strong></p>

<p>If the form produces no output or returns no values, then whether or
not output and values are transcribed is controlled by
<code>INCLUDE-NO-OUTPUT</code> and <code>INCLUDE-NO-VALUE</code>, respectively. By default,
neither is on so:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values</span>)</span>
..
=&gt;</span></code></pre>

<p>is transcribed to</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values</span>)</span></span></code></pre>

<p>With <code>UPDATE-ONLY</code> true, we probably wouldn't like to lose those
markers since they were put there for a reason. Hence, with
<code>UPDATE-ONLY</code>, <code>INCLUDE-NO-OUTPUT</code> and <code>INCLUDE-NO-VALUE</code> default to true.
So with <code>UPDATE-ONLY</code> the above example is transcribed to:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">values</span>)</span>
..
=&gt; <span class="comment">; No value</span></span></code></pre>

<p>where the last line is the <code>:NO-VALUE</code> prefix.</p>

<p><strong>Consistency Checks</strong></p>

<p>If <code>CHECK-CONSISTENCY</code> is true, then <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> signals a continuable
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR</code></a> whenever a form's output as a
string is different from what was in <code>INPUT</code>, provided that <code>INPUT</code>
contained the output. Similary, for values, a continuable
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-VALUES-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-VALUES-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-VALUES-CONSISTENCY-ERROR</code></a> is signalled if a value read
from the source does not print as the as the value returned by <code>EVAL</code>.
This allows readable values to be hand-indented without failing
consistency checks:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">list 1 2</span>)</span>
=&gt; <span class="paren1">(<span class="code">1
      2</span>)</span></span></code></pre>

<p><strong>Unreadable Values</strong></p>

<p>The above scheme involves <code>READ</code>, so consistency of unreadable values
cannot be treated the same. In fact, unreadable values must even be
printed differently for transcribe to be able to read them back:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">defclass</span></i> some-class <span class="paren2">(<span class="code"></span>)</span> <span class="paren2">(<span class="code"></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> print-object <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">obj some-class</span>)</span> stream</span>)</span>
  <span class="paren2">(<span class="code">print-unreadable-object <span class="paren3">(<span class="code">obj stream <span class="keyword">:type</span> t</span>)</span>
    <span class="paren3">(<span class="code">format stream \"~%~%end\"</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code">make-instance 'some-class</span>)</span>
==&gt; #&lt;SOME-CLASS 
--&gt;
--&gt; end&gt;</span></code></pre>

<p>where <code>&quot;==&gt;&quot;</code> is the <code>:UNREADABLE</code> prefix and <code>&quot;--&gt;&quot;</code> is
the <code>:UNREADABLE-CONTINUATION</code> prefix. As with outputs, a consistency
check between an unreadable value from the source and the value from
<code>EVAL</code> is performed with <code>STRING=</code>. That is, the value from <code>EVAL</code> is
printed to a string and compared to the source value. Hence, any
change to unreadable values will break consistency checks. This is
most troublesome with instances of classes with the default
<code>PRINT-OBJECT</code> method printing the memory address. There is currently
no remedy for that, except for customizing <code>PRINT-OBJECT</code> or not
transcribing that kind of stuff.</p>

<p><strong>Syntaxes</strong></p>

<p>Finally, a transcript may employ different syntaxes for the output
and values of different forms. When <code>INPUT</code> is read, the syntax for
each form is determined by trying to match all prefixes from all
syntaxes in <code>INPUT-SYNTAXES</code> against a line. If there are no output or
values for a form in <code>INPUT</code>, then the syntax remains undetermined.</p>

<p>When <code>OUTPUT</code> is written, the prefixes to be used are looked up in
<code>DEFAULT-SYNTAX</code> of <code>OUTPUT-SYNTAXES</code>, if <code>DEFAULT-SYNTAX</code> is not <code>NIL</code>. If
<code>DEFAULT-SYNTAX</code> is <code>NIL</code>, then the syntax used by the same form in the
<code>INPUT</code> is used or (if that could not be determined) the syntax of the
previous form. If there was no previous form, then the first syntax
if <code>OUTPUT-SYNTAXES</code> is used.</p>

<p>To produce a transcript that's executable Lisp code,
use <code>:DEFAULT-SYNTAX</code> <code>:COMMENTED-1:</code></p>

<pre><code><span class="code"><span class="paren1">(<span class="code">make-instance 'some-class</span>)</span>
<span class="comment">;==&gt; #&lt;SOME-CLASS
</span><span class="comment">;--&gt;
</span><span class="comment">;--&gt; end&gt;
</span>
<span class="paren1">(<span class="code">list 1 2</span>)</span>
<span class="comment">;=&gt; (1
</span><span class="comment">;-&gt;    2)</span></span></code></pre>

<p>To translate the above to uncommented syntax,
use <code>:DEFAULT-SYNTAX</code> <code>:DEFAULT</code>. If <code>DEFAULT-SYNTAX</code> is <code>NIL</code> (the
default), the same syntax will be used in the output as in the input
as much as possible.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-2ASYNTAXES-2A-20-28VARIABLE-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L72">[variable]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3A-2ASYNTAXES-2A-20-28VARIABLE-29-29" >*SYNTAXES*</a></span></span> <span class="locative-args">((:DEFAULT (:OUTPUT &quot;..&quot;) (:NO-VALUE &quot;=&gt; ; No value&quot;) (:READABLE &quot;=&gt;&quot;)
  (:UNREADABLE &quot;==&gt;&quot;) (:UNREADABLE-CONTINUATION &quot;--&gt;&quot;))
 (:COMMENTED-1 (:OUTPUT &quot;;..&quot;) (:NO-VALUE &quot;;=&gt; ; No value&quot;) (:READABLE &quot;;=&gt;&quot;)
  (:READABLE-CONTINUATION &quot;;-&gt;&quot;) (:UNREADABLE &quot;;==&gt;&quot;)
  (:UNREADABLE-CONTINUATION &quot;;--&gt;&quot;))
 (:COMMENTED-2 (:OUTPUT &quot;;;..&quot;) (:NO-VALUE &quot;;;=&gt; ; No value&quot;)
  (:READABLE &quot;;;=&gt;&quot;) (:READABLE-CONTINUATION &quot;;;-&gt;&quot;) (:UNREADABLE &quot;;;==&gt;&quot;)
  (:UNREADABLE-CONTINUATION &quot;;;--&gt;&quot;)))</span></span></p>

<p>The default syntaxes used by <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> for reading and writing
lines containing output and values of an evaluated form.</p>

<p>A syntax is a list of of the form <code>(SYNTAX-ID &amp;REST PREFIXES)</code> where
<code>PREFIXES</code> is a list of <code>(PREFIX-ID PREFIX-STRING)</code> elements. For
example the syntax <code>:COMMENTED-1</code> looks like this:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><span class="keyword">:commented-1</span>
 <span class="paren2">(<span class="code"><span class="keyword">:output</span> <span class="string">";.."</span></span>)</span>
 <span class="paren2">(<span class="code"><span class="keyword">:no-value</span> <span class="string">";=&gt;  No value"</span></span>)</span>
 <span class="paren2">(<span class="code"><span class="keyword">:readable</span> <span class="string">";=&gt;"</span></span>)</span>
 <span class="paren2">(<span class="code"><span class="keyword">:readable-continuation</span> <span class="string">";-&gt;"</span></span>)</span>
 <span class="paren2">(<span class="code"><span class="keyword">:unreadable</span> <span class="string">";==&gt;"</span></span>)</span>
 <span class="paren2">(<span class="code"><span class="keyword">:unreadable-continuation</span> <span class="string">";--&gt;"</span></span>)</span></span>)</span></span></code></pre>

<p>All of the above prefixes must be defined for every syntax except
for <code>:READABLE-CONTINUATION</code>. If that's missing (as in the <code>:DEFAULT</code>
syntax), then the following value is read with <code>READ</code> and printed with
<code>PRIN1</code> (hence no need to mark up the following lines).</p>

<p>When writing, an extra space is added automatically if the line to
be prefixed is not empty. Similarly, the first space following the
prefix discarded when reading.</p>

<p>See <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> for how the actual syntax to be used is selected.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ATRANSCRIPTION-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L896">[condition]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ATRANSCRIPTION-ERROR-20CONDITION-29" >TRANSCRIPTION-ERROR</a></span></span> <span class="locative-args">ERROR</span></span></p>

<p>Represents syntactic errors in the <code>SOURCE</code> argument
of <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> and also serves as the superclass of
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-CONSISTENCY-ERROR</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ATRANSCRIPTION-CONSISTENCY-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L962">[condition]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ATRANSCRIPTION-CONSISTENCY-ERROR-20CONDITION-29" >TRANSCRIPTION-CONSISTENCY-ERROR</a></span></span> <span class="locative-args">TRANSCRIPTION-ERROR</span></span></p>

<p>A common superclass for
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR</code></a> and
<a href="#x-28MGL-PAX-3ATRANSCRIPTION-VALUES-CONSISTENCY-ERROR-20CONDITION-29" title="(MGL-PAX:TRANSCRIPTION-VALUES-CONSISTENCY-ERROR CONDITION)"><code>TRANSCRIPTION-VALUES-CONSISTENCY-ERROR</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ATRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L968">[condition]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ATRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR-20CONDITION-29" >TRANSCRIPTION-OUTPUT-CONSISTENCY-ERROR</a></span></span> <span class="locative-args">TRANSCRIPTION-CONSISTENCY-ERROR</span></span></p>

<p>Signaled (with <code>CERROR</code>) by <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> when invoked
with <code>:CHECK-CONSISTENCY</code> and the output of a form is not the same as
what was parsed.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ATRANSCRIPTION-VALUES-CONSISTENCY-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/transcribe.lisp#L975">[condition]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ATRANSCRIPTION-VALUES-CONSISTENCY-ERROR-20CONDITION-29" >TRANSCRIPTION-VALUES-CONSISTENCY-ERROR</a></span></span> <span class="locative-args">TRANSCRIPTION-CONSISTENCY-ERROR</span></span></p>

<p>Signaled (with <code>CERROR</code>) by <a href="#x-28MGL-PAX-3ATRANSCRIBE-20FUNCTION-29" title="(MGL-PAX:TRANSCRIBE FUNCTION)"><code>TRANSCRIBE</code></a> when invoked
with <code>:CHECK-CONSISTENCY</code> and the values of a form are inconsistent
with their parsed representation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-TRANSCRIPT-API-20MGL-PAX-3ASECTION-29" title="Transcript API">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-MANUAL-20MGL-PAX-3ASECTION-29" title="PAX Manual">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29" title="Locatives and References">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L5">&#955;</a></span></span></p>

<h2><a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29">10 Extension API</a></h2>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29" title="Adding New Object Types">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29" title="Locatives and References">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L327">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29">10.1 Locatives and References</a></h3>

<p>While Common Lisp has rather good introspective abilities, not
everything is first class. For example, there is no object
representing the variable defined with <code>(DEFVAR
FOO)</code>. <code>(MAKE-REFERENCE 'FOO 'VARIABLE)</code> constructs a <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> that
captures the path to take from an object (the symbol <code>FOO</code>) to an
entity of interest (for example, the documentation of the variable).
The path is called the locative. A locative can be applied to an
object like this:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code">locate 'foo 'variable</span>)</span></span></code></pre>

<p>which will return the same reference as <code>(MAKE-REFERENCE 'FOO
'VARIABLE)</code>. Operations need to know how to deal with references,
which we will see in <a href="#x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-COLLECT-REACHABLE-OBJECTS GENERIC-FUNCTION)"><code>LOCATE-AND-COLLECT-REACHABLE-OBJECTS</code></a>,
<a href="#x-28MGL-PAX-3ALOCATE-AND-DOCUMENT-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-DOCUMENT GENERIC-FUNCTION)"><code>LOCATE-AND-DOCUMENT</code></a> and <a href="#x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-FIND-SOURCE GENERIC-FUNCTION)"><code>LOCATE-AND-FIND-SOURCE</code></a>.</p>

<p>Naturally, <code>(LOCATE 'FOO 'FUNCTION)</code> will simply return <code>#'FOO</code>, no
need to muck with references when there is a perfectly good object.</p>

<p><a id='x-28MGL-PAX-3ALOCATE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L362">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" >LOCATE</a></span></span> <span class="locative-args">OBJECT LOCATIVE &amp;KEY (ERRORP <code>T</code>)</span></span></p>

<p>Follow <code>LOCATIVE</code> from <code>OBJECT</code> and return the object it leads to or a
<a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> if there is no first class object corresponding to the
location. If <code>ERRORP</code>, then a <a href="#x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29" title="(MGL-PAX:LOCATE-ERROR CONDITION)"><code>LOCATE-ERROR</code></a> condition is signaled when
the lookup fails.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L375">[condition]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29" >LOCATE-ERROR</a></span></span> <span class="locative-args">ERROR</span></span></p>

<p>Signaled by <a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" title="(MGL-PAX:LOCATE FUNCTION)"><code>LOCATE</code></a> when the lookup fails and <code>ERRORP</code>
is true.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-ERROR-MESSAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L375">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-ERROR-MESSAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29" >LOCATE-ERROR-MESSAGE</a></span></span> <span class="locative-args">LOCATE-ERROR</span> <span class="locative-args">(:MESSAGE)</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-ERROR-OBJECT-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L375">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-ERROR-OBJECT-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29" >LOCATE-ERROR-OBJECT</a></span></span> <span class="locative-args">LOCATE-ERROR</span> <span class="locative-args">(:OBJECT)</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-ERROR-LOCATIVE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L375">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-ERROR-LOCATIVE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29" >LOCATE-ERROR-LOCATIVE</a></span></span> <span class="locative-args">LOCATE-ERROR</span> <span class="locative-args">(:LOCATIVE)</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3ARESOLVE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax.lisp#L387">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ARESOLVE-20FUNCTION-29" >RESOLVE</a></span></span> <span class="locative-args">REFERENCE &amp;KEY (ERRORP <code>T</code>)</span></span></p>

<p>A convenience function to <a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" title="(MGL-PAX:LOCATE FUNCTION)"><code>LOCATE</code></a> <code>REFERENCE</code>'s object with its
locative.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AREFERENCE-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L86">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" >REFERENCE</a></span></span></span></p>

<p>A <code>REFERENCE</code> represents a path (<a href="#x-28MGL-PAX-3AREFERENCE-LOCATIVE-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29" title="(MGL-PAX:REFERENCE-LOCATIVE (MGL-PAX:READER MGL-PAX:REFERENCE))"><code>REFERENCE-LOCATIVE</code></a>)
to take from an object (<a href="#x-28MGL-PAX-3AREFERENCE-OBJECT-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29" title="(MGL-PAX:REFERENCE-OBJECT (MGL-PAX:READER MGL-PAX:REFERENCE))"><code>REFERENCE-OBJECT</code></a>).</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AREFERENCE-OBJECT-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L87">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AREFERENCE-OBJECT-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29" >REFERENCE-OBJECT</a></span></span> <span class="locative-args">REFERENCE</span> <span class="locative-args">(:OBJECT)</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3AREFERENCE-LOCATIVE-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L88">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AREFERENCE-LOCATIVE-20-28MGL-PAX-3AREADER-20MGL-PAX-3AREFERENCE-29-29" >REFERENCE-LOCATIVE</a></span></span> <span class="locative-args">REFERENCE</span> <span class="locative-args">(:LOCATIVE)</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3AMAKE-REFERENCE-20FUNCTION-29'></a></p>

<ul>
<li><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L92">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AMAKE-REFERENCE-20FUNCTION-29" >MAKE-REFERENCE</a></span></span> <span class="locative-args">OBJECT LOCATIVE</span></span></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATIVE-TYPE-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L140">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATIVE-TYPE-20FUNCTION-29" >LOCATIVE-TYPE</a></span></span> <span class="locative-args">LOCATIVE</span></span></p>

<p>The first element of <code>LOCATIVE</code> if it's a list. If it's a symbol then
it's that symbol itself. Typically, methods of generic functions
working with locatives take locative type and locative args as
separate arguments to allow methods have eql specializers on the
type symbol.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATIVE-ARGS-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L150">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATIVE-ARGS-20FUNCTION-29" >LOCATIVE-ARGS</a></span></span> <span class="locative-args">LOCATIVE</span></span></p>

<p>The <code>REST</code> of <code>LOCATIVE</code> if it's a list. If it's a symbol then
it's ().</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-LOCATIVES-AND-REFERENCES-20MGL-PAX-3ASECTION-29" title="Locatives and References">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29" title="Reference Based Extensions">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29" title="Adding New Object Types">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L12">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29">10.2 Adding New Object Types</a></h3>

<p>One may wish to make the <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> function and <code>M-.</code> navigation
work with new object types. Extending <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> can be done by
defining a <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a> method. To allow these objects to be
referenced from <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>, a <a href="#x-28MGL-PAX-3ALOCATE-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-OBJECT GENERIC-FUNCTION)"><code>LOCATE-OBJECT</code></a> method is to be defined.
For <code>M-.</code> <a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:FIND-SOURCE GENERIC-FUNCTION)"><code>FIND-SOURCE</code></a> can be specialized. Finally,
<a href="#x-28MGL-PAX-3AEXPORTABLE-LOCATIVE-TYPE-P-20GENERIC-FUNCTION-29" title="(MGL-PAX:EXPORTABLE-LOCATIVE-TYPE-P GENERIC-FUNCTION)"><code>EXPORTABLE-LOCATIVE-TYPE-P</code></a> may be overridden if exporting does not
makes sense. Here is a stripped down example of how all this is done
for <a href="#x-28ASDF-2FSYSTEM-3ASYSTEM-20-28MGL-PAX-3ALOCATIVE-29-29" title="(ASDF/SYSTEM:SYSTEM (MGL-PAX:LOCATIVE))"><code>ASDF:SYSTEM:</code></a></p>

<p><a id='x-28MGL-PAX-3AASDF-EXAMPLE-20-28MGL-PAX-3AINCLUDE-20-28-3ASTART-20-28ASDF-2FSYSTEM-3ASYSTEM-20MGL-PAX-3ALOCATIVE-29-20-3AEND-20-28MGL-PAX-3A-3AEND-OF-ASDF-EXAMPLE-20VARIABLE-29-29-20-3AHEADER-NL-20-22-60-60-60commonlisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29'></a></p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">define-locative-type</span></i> asdf:system <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"Refers to an asdf system. The generated documentation will include
  meta information extracted from the system definition. This also
  serves as an example of a symbol that's not accessible in the
  current package and consequently is not exported."</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> locate-object <span class="paren2">(<span class="code">symbol <span class="paren3">(<span class="code">locative-type <span class="paren4">(<span class="code">eql 'asdf:system</span>)</span></span>)</span>
                          locative-args</span>)</span>
  <span class="paren2">(<span class="code">assert <span class="paren3">(<span class="code">endp locative-args</span>)</span></span>)</span>
  <span class="comment">;; FIXME: This is slow as hell.
</span>  <span class="paren2">(<span class="code">or <span class="paren3">(<span class="code">asdf:find-system symbol nil</span>)</span>
      <span class="paren3">(<span class="code">locate-error</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> canonical-reference <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">system asdf:system</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">make-reference <span class="paren3">(<span class="code">slot-value system 'asdf::name</span>)</span> 'asdf:system</span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> document-object <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">system asdf:system</span>)</span> stream</span>)</span>
  <span class="paren2">(<span class="code"><i><span class="symbol">with-heading</span></i> <span class="paren3">(<span class="code">stream system
                        <span class="paren4">(<span class="code">format nil <span class="string">"~A ASDF System Details"</span>
                                <span class="paren5">(<span class="code">slot-value system 'asdf::name</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">flet</span></i> <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">foo <span class="paren6">(<span class="code">name fn &amp;key type</span>)</span>
             <span class="paren6">(<span class="code"><i><span class="symbol">let</span></i> <span class="paren1">(<span class="code"><span class="paren2">(<span class="code">value <span class="paren3">(<span class="code">funcall fn system</span>)</span></span>)</span></span>)</span>
               <span class="paren1">(<span class="code">when value
                 <span class="paren2">(<span class="code">case type
                   <span class="paren3">(<span class="code"><span class="paren4">(<span class="code"><span class="keyword">:link</span></span>)</span>
                    <span class="paren4">(<span class="code">format stream <span class="string">"- ~A: [~A](~A)~%"</span> name value value</span>)</span></span>)</span>
                   <span class="paren3">(<span class="code"><span class="paren4">(<span class="code"><span class="keyword">:mailto</span></span>)</span>
                    <span class="paren4">(<span class="code">format stream <span class="string">"- ~A: [~A](mailto:~A)~%"</span>
                            name value value</span>)</span></span>)</span>
                   <span class="paren3">(<span class="code"><span class="paren4">(<span class="code"><span class="keyword">:source-control</span></span>)</span>
                    <span class="paren4">(<span class="code">format stream <span class="string">"- ~A: [~A](~A)"</span>
                            name <span class="paren5">(<span class="code">first value</span>)</span> <span class="paren5">(<span class="code">second value</span>)</span></span>)</span></span>)</span>
                   <span class="paren3">(<span class="code"><span class="paren4">(<span class="code"><span class="keyword">:docstring</span></span>)</span>
                    <span class="paren4">(<span class="code">format stream <span class="string">"- ~A: ~A~%"</span> name
                            <span class="comment">;; Like MASSAGE-DOCSTRING but without
</span>                            <span class="comment">;; indenting.
</span>                            <span class="paren5">(<span class="code">prefix-lines <span class="string">"  "</span>
                                          <span class="paren6">(<span class="code">replace-known-references
                                           <span class="paren1">(<span class="code">strip-docstring-indentation value</span>)</span></span>)</span>
                                          <span class="keyword">:exclude-first-line-p</span> t</span>)</span></span>)</span></span>)</span>
                   <span class="paren3">(<span class="code"><span class="paren4">(<span class="code">nil</span>)</span>
                    <span class="paren4">(<span class="code">format stream <span class="string">"- ~A: ~A~%"</span> name value</span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Version"</span> 'asdf/component:component-version</span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Description"</span> 'asdf/system:system-description <span class="keyword">:type</span> <span class="keyword">:docstring</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Long Description"</span> 'asdf/system:system-long-description
           <span class="keyword">:type</span> <span class="keyword">:docstring</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Licence"</span> 'asdf/system:system-licence</span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Author"</span> 'asdf/system:system-author</span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Maintainer"</span> 'asdf/system:system-maintainer</span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Mailto"</span> 'asdf/system:system-mailto <span class="keyword">:type</span> <span class="keyword">:mailto</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Homepage"</span> 'asdf/system:system-homepage <span class="keyword">:type</span> <span class="keyword">:link</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Bug tracker"</span> 'asdf/system:system-bug-tracker <span class="keyword">:type</span> <span class="keyword">:link</span></span>)</span>
      <span class="paren4">(<span class="code">foo <span class="string">"Source control"</span> 'asdf/system:system-source-control
           <span class="keyword">:type</span> <span class="keyword">:source-control</span></span>)</span>
      <span class="paren4">(<span class="code">terpri stream</span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> find-source <span class="paren2">(<span class="code"><span class="paren3">(<span class="code">system asdf:system</span>)</span></span>)</span>
  `<span class="paren2">(<span class="code"><span class="keyword">:location</span>
    <span class="paren3">(<span class="code"><span class="keyword">:file</span> ,<span class="paren4">(<span class="code">namestring <span class="paren5">(<span class="code">asdf/system:system-source-file system</span>)</span></span>)</span></span>)</span>
    <span class="paren3">(<span class="code"><span class="keyword">:position</span> 1</span>)</span>
    <span class="paren3">(<span class="code"><span class="keyword">:snippet</span> <span class="string">""</span></span>)</span></span>)</span></span>)</span>
</span></code></pre>

<p><a id='x-28MGL-PAX-3ADEFINE-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L36">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-LOCATIVE-TYPE</a></span></span> <span class="locative-args">LOCATIVE-TYPE LAMBDA-LIST &amp;BODY DOCSTRING</span></span></p>

<p>Declare <code>LOCATIVE-TYPE</code> as a <a href="#x-28MGL-PAX-3ALOCATIVE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:LOCATIVE (MGL-PAX:LOCATIVE))"><code>LOCATIVE</code></a>. One gets two
things in return: first, a place to document the format and
semantics of <code>LOCATIVE-TYPE</code> (in <code>LAMBDA-LIST</code> and <code>DOCSTRING</code>); second,
being able to reference <code>(LOCATIVE-TYPE LOCATIVE)</code>. For example, if
you have:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">define-locative-type</span></i> variable <span class="paren2">(<span class="code">&amp;optional initform</span>)</span>
  <span class="string">"Dummy docstring."</span></span>)</span></span></code></pre>

<p>then <code>(VARIABLE LOCATIVE)</code> refers to this form.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AEXPORTABLE-LOCATIVE-TYPE-P-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L197">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AEXPORTABLE-LOCATIVE-TYPE-P-20GENERIC-FUNCTION-29" >EXPORTABLE-LOCATIVE-TYPE-P</a></span></span> <span class="locative-args">LOCATIVE-TYPE</span></span></p>

<p>Return true iff symbols in references with
<code>LOCATIVE-TYPE</code> are to be exported by default when they occur in a
<a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>. The default method returns <code>T</code>, while the methods for
<a href="#x-28PACKAGE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(PACKAGE (MGL-PAX:LOCATIVE))"><code>PACKAGE</code></a>, <a href="#x-28ASDF-2FSYSTEM-3ASYSTEM-20-28MGL-PAX-3ALOCATIVE-29-29" title="(ASDF/SYSTEM:SYSTEM (MGL-PAX:LOCATIVE))"><code>ASDF:SYSTEM</code></a> and <a href="#x-28METHOD-20-28MGL-PAX-3ALOCATIVE-29-29" title="(METHOD (MGL-PAX:LOCATIVE))"><code>METHOD</code></a> return <code>NIL</code>.</p>

<p><a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> calls this function to decide what symbols to export when
its <code>EXPORT</code> argument is true.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-OBJECT-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L61">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-OBJECT-20GENERIC-FUNCTION-29" >LOCATE-OBJECT</a></span></span> <span class="locative-args">OBJECT LOCATIVE-TYPE LOCATIVE-ARGS</span></span></p>

<p>Return the object to which <code>OBJECT</code> and the locative
refer. For example, if <code>LOCATIVE-TYPE</code> is the symbol <a href="#x-28PACKAGE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(PACKAGE (MGL-PAX:LOCATIVE))"><code>PACKAGE</code></a>, this
returns <code>(FIND-PACKAGE SYMBOL)</code>. Signal a <a href="#x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29" title="(MGL-PAX:LOCATE-ERROR CONDITION)"><code>LOCATE-ERROR</code></a> condition by
calling the <a href="#x-28MGL-PAX-3ALOCATE-ERROR-20FUNCTION-29" title="(MGL-PAX:LOCATE-ERROR FUNCTION)"><code>LOCATE-ERROR</code></a> function if the lookup fails. Signal other
errors if the types of the argument are bad, for instance
<code>LOCATIVE-ARGS</code> is not the empty list in the package example. If a
<a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> is returned then it must be canonical in the sense that
calling <a href="#x-28MGL-PAX-3ACANONICAL-REFERENCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:CANONICAL-REFERENCE GENERIC-FUNCTION)"><code>CANONICAL-REFERENCE</code></a> on it will return the same reference.
For extension only, don't call this directly.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-ERROR-20FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L72">[function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-ERROR-20FUNCTION-29" >LOCATE-ERROR</a></span></span> <span class="locative-args">&amp;REST FORMAT-AND-ARGS</span></span></p>

<p>Call this function to signal a <a href="#x-28MGL-PAX-3ALOCATE-ERROR-20CONDITION-29" title="(MGL-PAX:LOCATE-ERROR CONDITION)"><code>LOCATE-ERROR</code></a> condition from a
<a href="#x-28MGL-PAX-3ALOCATE-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-OBJECT GENERIC-FUNCTION)"><code>LOCATE-OBJECT</code></a> method. <code>FORMAT-AND-ARGS</code> contains a format string and
args suitable for <code>FORMAT</code> from which the <a href="#x-28MGL-PAX-3ALOCATE-ERROR-MESSAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ALOCATE-ERROR-29-29" title="(MGL-PAX:LOCATE-ERROR-MESSAGE (MGL-PAX:READER MGL-PAX:LOCATE-ERROR))"><code>LOCATE-ERROR-MESSAGE</code></a> is
constructed. If <code>FORMAT-AND-ARGS</code> is <code>NIL</code>, then the message will be <code>NIL</code>
too.</p>

<p>The object and the locative are not specified, they are added by
<a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" title="(MGL-PAX:LOCATE FUNCTION)"><code>LOCATE</code></a> when it resignals the condition.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ACANONICAL-REFERENCE-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L85">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ACANONICAL-REFERENCE-20GENERIC-FUNCTION-29" >CANONICAL-REFERENCE</a></span></span> <span class="locative-args">OBJECT</span></span></p>

<p>Return a <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> that resolves to <code>OBJECT</code>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L98">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" >COLLECT-REACHABLE-OBJECTS</a></span></span> <span class="locative-args">OBJECT</span></span></p>

<p>Return a list of objects representing all things
that would be documented in a (<a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> <code>OBJECT</code>) call. For sections
this is simply the union of references reachable from references in
<a href="#x-28MGL-PAX-3ASECTION-ENTRIES-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" title="(MGL-PAX:SECTION-ENTRIES (MGL-PAX:READER MGL-PAX:SECTION))"><code>SECTION-ENTRIES</code></a>. The returned objects can be anything provided that
<a href="#x-28MGL-PAX-3ACANONICAL-REFERENCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:CANONICAL-REFERENCE GENERIC-FUNCTION)"><code>CANONICAL-REFERENCE</code></a> works on them. The list need not include <code>OBJECT</code>
itself.</p>

<p>One only has to specialize this for new container-like objects.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28T-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L108">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28T-29-29-29" >COLLECT-REACHABLE-OBJECTS</a></span></span> <span class="locative-args">OBJECT</span></span></p>

<p>This default implementation returns the empty list. This means that
nothing is reachable from <code>OBJECT</code>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L114">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" >DOCUMENT-OBJECT</a></span></span> <span class="locative-args">OBJECT STREAM</span></span></p>

<p>Write <code>OBJECT</code> (and its references recursively) in
<code>FORMAT</code> to <code>STREAM</code>.</p>

<p>The <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> function calls this generic function with <code>LEVEL</code> 0,
passing <code>FORMAT</code> on. Add methods specializing on <code>OBJECT</code> to customize
how objects of that type are presented in the documentation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADOCUMENT-OBJECT-20-28METHOD-20NIL-20-28STRING-20T-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L122">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20-28METHOD-20NIL-20-28STRING-20T-29-29-29" >DOCUMENT-OBJECT</a></span></span> <span class="locative-args">(STRING STRING) STREAM</span></span></p>

<p>Print <code>STRING</code> verbatim to <code>STREAM</code> after cleaning up indentation.</p>

<p>Docstrings in sources are indented in various ways, which can easily
mess up markdown. To handle the most common cases leave the first
line alone, but from the rest of the lines strip the longest run of
leading spaces that is common to all non-blank lines.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L136">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" >FIND-SOURCE</a></span></span> <span class="locative-args">OBJECT</span></span></p>

<p>Like <code>SWANK:FIND-DEFINITION-FOR-THING</code>, but this
one is a generic function to be extensible. In fact, the default
implementation simply defers to <code>SWANK:FIND-DEFINITION-FOR-THING</code>.
This function is called by <code>LOCATE-DEFINITION-FOR-EMACS</code>, which lies
behind the <code>M-.</code> extension (see <a href="#x-28MGL-PAX-3A-40MGL-PAX-EMACS-INTEGRATION-20MGL-PAX-3ASECTION-29" title="Emacs Integration">Emacs Integration</a>).</p>

<p>If successful, the return value looks like this:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><span class="keyword">:location</span> <span class="paren2">(<span class="code"><span class="keyword">:file</span> <span class="string">"/home/mega/own/mgl/pax/test/test.lisp"</span></span>)</span>
           <span class="paren2">(<span class="code"><span class="keyword">:position</span> 24</span>)</span> nil</span>)</span></span></code></pre>

<p>The <code>NIL</code> is the source snippet, which is optional. Note that position
1 is the first character. If unsuccessful, the return values is
like:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><span class="keyword">:error</span> <span class="string">"Unknown source location for SOMETHING"</span></span>)</span></span></code></pre></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-NEW-OBJECT-TYPES-20MGL-PAX-3ASECTION-29" title="Adding New Object Types">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-SECTIONS-20MGL-PAX-3ASECTION-29" title="Sections">&#8594;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29" title="Reference Based Extensions">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L204">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29">10.3 Reference Based Extensions</a></h3>

<p>Let's see how to extend <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> and <code>M-.</code> navigation if there is
no first class object to represent the thing of interest. Recall
that <a href="#x-28MGL-PAX-3ALOCATE-20FUNCTION-29" title="(MGL-PAX:LOCATE FUNCTION)"><code>LOCATE</code></a> returns a <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> object in this case. <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a>
and <a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:FIND-SOURCE GENERIC-FUNCTION)"><code>FIND-SOURCE</code></a> defer to <a href="#x-28MGL-PAX-3ALOCATE-AND-DOCUMENT-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-DOCUMENT GENERIC-FUNCTION)"><code>LOCATE-AND-DOCUMENT</code></a> and
<a href="#x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-FIND-SOURCE GENERIC-FUNCTION)"><code>LOCATE-AND-FIND-SOURCE</code></a>, which have <a href="#x-28MGL-PAX-3ALOCATIVE-TYPE-20FUNCTION-29" title="(MGL-PAX:LOCATIVE-TYPE FUNCTION)"><code>LOCATIVE-TYPE</code></a> in their argument
list for <code>EQL</code> specializing pleasure. Here is a stripped down example
of how the <a href="#x-28VARIABLE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(VARIABLE (MGL-PAX:LOCATIVE))"><code>VARIABLE</code></a> locative is defined:</p>

<p><a id='x-28MGL-PAX-3AVARIABLE-EXAMPLE-20-28MGL-PAX-3AINCLUDE-20-28-3ASTART-20-28VARIABLE-20MGL-PAX-3ALOCATIVE-29-20-3AEND-20-28MGL-PAX-3A-3AEND-OF-VARIABLE-EXAMPLE-20VARIABLE-29-29-20-3AHEADER-NL-20-22-60-60-60commonlisp-22-20-3AFOOTER-NL-20-22-60-60-60-22-29-29'></a></p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">define-locative-type</span></i> variable <span class="paren2">(<span class="code">&amp;optional initform</span>)</span>
  <span class="string">"Refers to a global special variable. INITFORM, or if not specified,
  the global value of the variable is included in the documentation."</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> locate-object <span class="paren2">(<span class="code">symbol <span class="paren3">(<span class="code">locative-type <span class="paren4">(<span class="code">eql 'variable</span>)</span></span>)</span> locative-args</span>)</span>
  <span class="paren2">(<span class="code">assert <span class="paren3">(<span class="code">&lt;= <span class="paren4">(<span class="code">length locative-args</span>)</span> 1</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">make-reference symbol <span class="paren3">(<span class="code">cons locative-type locative-args</span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> locate-and-document <span class="paren2">(<span class="code">symbol <span class="paren3">(<span class="code">locative-type <span class="paren4">(<span class="code">eql 'variable</span>)</span></span>)</span>
                                locative-args stream</span>)</span>
  <span class="paren2">(<span class="code">destructuring-bind <span class="paren3">(<span class="code">&amp;optional <span class="paren4">(<span class="code">initform nil initformp</span>)</span></span>)</span> locative-args
    <span class="paren3">(<span class="code">locate-and-print-bullet locative-type locative-args symbol stream</span>)</span>
    <span class="paren3">(<span class="code">write-char <span class="character">#\Space</span> stream</span>)</span>
    <span class="paren3">(<span class="code">multiple-value-bind <span class="paren4">(<span class="code">value unboundp</span>)</span> <span class="paren4">(<span class="code">symbol-global-value symbol</span>)</span>
      <span class="paren4">(<span class="code">print-arglist <span class="paren5">(<span class="code">prin1-to-string <span class="paren6">(<span class="code"><i><span class="symbol">cond</span></i> <span class="paren1">(<span class="code">initformp initform</span>)</span>
                                            <span class="paren1">(<span class="code">unboundp <span class="string">"-unbound-"</span></span>)</span>
                                            <span class="paren1">(<span class="code">t value</span>)</span></span>)</span></span>)</span>
                     stream</span>)</span></span>)</span>
    <span class="paren3">(<span class="code">print-end-bullet stream</span>)</span>
    <span class="paren3">(<span class="code"><i><span class="symbol">with-dislocated-symbols</span></i> <span class="paren4">(<span class="code"><span class="paren5">(<span class="code">list symbol</span>)</span></span>)</span>
      <span class="paren4">(<span class="code">maybe-print-docstring symbol locative-type stream</span>)</span></span>)</span></span>)</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">defmethod</span></i> locate-and-find-source <span class="paren2">(<span class="code">symbol <span class="paren3">(<span class="code">locative-type <span class="paren4">(<span class="code">eql 'variable</span>)</span></span>)</span>
                                   locative-args</span>)</span>
  <span class="paren2">(<span class="code">declare <span class="paren3">(<span class="code">ignore locative-args</span>)</span></span>)</span>
  <span class="paren2">(<span class="code">find-one-location <span class="paren3">(<span class="code">swank-backend:find-definitions symbol</span>)</span>
                     '<span class="paren3">(<span class="code"><span class="string">"variable"</span> <span class="string">"defvar"</span> <span class="string">"defparameter"</span>
                       <span class="string">"special-declaration"</span></span>)</span></span>)</span></span>)</span>
</span></code></pre>

<p><a id='x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L233">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-29-29-29" >COLLECT-REACHABLE-OBJECTS</a></span></span> <span class="locative-args">(REFERENCE REFERENCE)</span></span></p>

<p>If <code>REFERENCE</code> can be resolved to a non-reference, call
<a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" title="(MGL-PAX:COLLECT-REACHABLE-OBJECTS GENERIC-FUNCTION)"><code>COLLECT-REACHABLE-OBJECTS</code></a> with it, else call
<a href="#x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-COLLECT-REACHABLE-OBJECTS GENERIC-FUNCTION)"><code>LOCATE-AND-COLLECT-REACHABLE-OBJECTS</code></a> on the object, locative-type,
locative-args of <code>REFERENCE</code></p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L246">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" >LOCATE-AND-COLLECT-REACHABLE-OBJECTS</a></span></span> <span class="locative-args">OBJECT LOCATIVE-TYPE LOCATIVE-ARGS</span></span></p>

<p>Called by <a href="#x-28MGL-PAX-3ACOLLECT-REACHABLE-OBJECTS-20GENERIC-FUNCTION-29" title="(MGL-PAX:COLLECT-REACHABLE-OBJECTS GENERIC-FUNCTION)"><code>COLLECT-REACHABLE-OBJECTS</code></a> on <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a>
objects, this function has essentially the same purpose as its
caller but it has different arguments to allow specializing on
<code>LOCATIVE-TYPE</code>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28T-20T-20T-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L253">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-AND-COLLECT-REACHABLE-OBJECTS-20-28METHOD-20NIL-20-28T-20T-20T-29-29-29" >LOCATE-AND-COLLECT-REACHABLE-OBJECTS</a></span></span> <span class="locative-args">OBJECT LOCATIVE-TYPE LOCATIVE-ARGS</span></span></p>

<p>This default implementation returns the empty list. This means that
nothing is reachable from the reference.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADOCUMENT-OBJECT-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-20T-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/document.lisp#L1609">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-20T-29-29-29" >DOCUMENT-OBJECT</a></span></span> <span class="locative-args">(REFERENCE REFERENCE) STREAM</span></span></p>

<p>If <code>REFERENCE</code> can be resolved to a non-reference, call
<a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a> with it, else call LOCATE-AND-DOCUMENT-OBJECT on the
object, locative-type, locative-args of <code>REFERENCE</code></p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-AND-DOCUMENT-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L260">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-AND-DOCUMENT-20GENERIC-FUNCTION-29" >LOCATE-AND-DOCUMENT</a></span></span> <span class="locative-args">OBJECT LOCATIVE-TYPE LOCATIVE-ARGS STREAM</span></span></p>

<p>Called by <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a> on <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> objects,
this function has essentially the same purpose as <a href="#x-28MGL-PAX-3ADOCUMENT-OBJECT-20GENERIC-FUNCTION-29" title="(MGL-PAX:DOCUMENT-OBJECT GENERIC-FUNCTION)"><code>DOCUMENT-OBJECT</code></a>
but it has different arguments to allow specializing on
<code>LOCATIVE-TYPE</code>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3AFIND-SOURCE-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L267">[method]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3AFIND-SOURCE-20-28METHOD-20NIL-20-28MGL-PAX-3AREFERENCE-29-29-29" >FIND-SOURCE</a></span></span> <span class="locative-args">(REFERENCE REFERENCE)</span></span></p>

<p>If <code>REFERENCE</code> can be resolved to a non-reference, call <a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:FIND-SOURCE GENERIC-FUNCTION)"><code>FIND-SOURCE</code></a>
with it, else call <a href="#x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:LOCATE-AND-FIND-SOURCE GENERIC-FUNCTION)"><code>LOCATE-AND-FIND-SOURCE</code></a> on the object,
locative-type, locative-args of <code>REFERENCE</code></p></li>
</ul>

<p><a id='x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L276">[generic-function]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ALOCATE-AND-FIND-SOURCE-20GENERIC-FUNCTION-29" >LOCATE-AND-FIND-SOURCE</a></span></span> <span class="locative-args">OBJECT LOCATIVE-TYPE LOCATIVE-ARGS</span></span></p>

<p>Called by <a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:FIND-SOURCE GENERIC-FUNCTION)"><code>FIND-SOURCE</code></a> on <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> objects, this
function has essentially the same purpose as <a href="#x-28MGL-PAX-3AFIND-SOURCE-20GENERIC-FUNCTION-29" title="(MGL-PAX:FIND-SOURCE GENERIC-FUNCTION)"><code>FIND-SOURCE</code></a> but it has
different arguments to allow specializing on <code>LOCATIVE-TYPE</code>.</p></li>
</ul>

<p>We have covered the basic building blocks of reference based
extensions. Now let's see how the obscure
<a href="#x-28MGL-PAX-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-SYMBOL-LOCATIVE-TYPE (MGL-PAX:MACRO))"><code>DEFINE-SYMBOL-LOCATIVE-TYPE</code></a> and
<a href="#x-28MGL-PAX-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE (MGL-PAX:MACRO))"><code>DEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE</code></a> macros work together to
simplify the common task of associating definition and documentation
with symbols in a certain context.</p>

<p><a id='x-28MGL-PAX-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L281">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-SYMBOL-LOCATIVE-TYPE</a></span></span> <span class="locative-args">LOCATIVE-TYPE LAMBDA-LIST &amp;BODY DOCSTRING</span></span></p>

<p>Similar to <a href="#x-28MGL-PAX-3ADEFINE-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-LOCATIVE-TYPE (MGL-PAX:MACRO))"><code>DEFINE-LOCATIVE-TYPE</code></a> but it assumes that all things
locatable with <code>LOCATIVE-TYPE</code> are going to be just symbols defined
with a definer defined with <a href="#x-28MGL-PAX-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE (MGL-PAX:MACRO))"><code>DEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE</code></a>.
It is useful to attach documentation and source location to symbols
in a particular context. An example will make everything clear:</p>

<pre><code><span class="code"><span class="paren1">(<span class="code"><i><span class="symbol">define-symbol-locative-type</span></i> direction <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"A direction is a symbol. (After this `M-.` on `DIRECTION LOCATIVE`
  works and it can also be included in DEFSECTION forms.)"</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">define-definer-for-symbol-locative-type</span></i> <i><span class="symbol">define-direction</span></i> direction
  <span class="string">"With DEFINE-DIRECTION one can document what a symbol means when
  interpreted as a direction."</span></span>)</span>

<span class="paren1">(<span class="code"><i><span class="symbol">define-direction</span></i> up <span class="paren2">(<span class="code"></span>)</span>
  <span class="string">"UP is equivalent to a coordinate delta of (0, -1)."</span></span>)</span></span></code></pre>

<p>After all this, <code>(UP DIRECTION)</code> refers to the <code>DEFINE-DIRECTION</code>
form above.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L345">[macro]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ADEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" >DEFINE-DEFINER-FOR-SYMBOL-LOCATIVE-TYPE</a></span></span> <span class="locative-args">NAME LOCATIVE-TYPE &amp;BODY DOCSTRING</span></span></p>

<p>Define a macro with <code>NAME</code> which can be used to attach documentation,
a lambda-list and source location to a symbol in the context of
<code>LOCATIVE-TYPE</code>. The defined macro's arglist is (<code>SYMBOL</code> <code>LAMBDA-LIST</code>
<code>&amp;OPTIONAL</code> <code>DOCSTRING</code>). <code>LOCATIVE-TYPE</code> is assumed to have been defined
with <a href="#x-28MGL-PAX-3ADEFINE-SYMBOL-LOCATIVE-TYPE-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFINE-SYMBOL-LOCATIVE-TYPE (MGL-PAX:MACRO))"><code>DEFINE-SYMBOL-LOCATIVE-TYPE</code></a>.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3A-40MGL-PAX-SECTIONS-20MGL-PAX-3ASECTION-29'></a></p>

<p><span class="outer-navigation"><span class="navigation"> <a href="#x-28MGL-PAX-3A-40MGL-PAX-REFERENCE-BASED-EXTENSIONS-20MGL-PAX-3ASECTION-29" title="Reference Based Extensions">&#8592;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-EXTENSION-API-20MGL-PAX-3ASECTION-29" title="Extension API">&#8593;</a> <a href="#x-28MGL-PAX-3A-40MGL-PAX-SECTIONS-20MGL-PAX-3ASECTION-29" title="Sections">&#8634;</a> <a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/extension-api.lisp#L365">&#955;</a></span></span></p>

<h3><a href="#x-28MGL-PAX-3A-40MGL-PAX-SECTIONS-20MGL-PAX-3ASECTION-29">10.4 Sections</a></h3>

<p><a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>Section</code></a> objects rarely need to be dissected since
<a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> and <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> cover most needs. However, it is plausible
that one wants to subclass them and maybe redefine how they are
presented.</p>

<p><a id='x-28MGL-PAX-3ASECTION-20CLASS-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L109">[class]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" >SECTION</a></span></span></span></p>

<p><a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a> stores its <code>NAME</code>, <code>TITLE</code>, <a href="#x-28PACKAGE-20-28MGL-PAX-3ALOCATIVE-29-29" title="(PACKAGE (MGL-PAX:LOCATIVE))"><code>PACKAGE</code></a>,
<code>READTABLE</code> and <code>ENTRIES</code> in <a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a> objects.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-NAME-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L110">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-NAME-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-NAME</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:NAME)</span></span></p>

<p>The name of the global variable whose value is
this <code>SECTION</code>(<a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>0</code></a> <a href="#x-28MGL-PAX-3ASECTION-20-28MGL-PAX-3ALOCATIVE-29-29" title="(MGL-PAX:SECTION (MGL-PAX:LOCATIVE))"><code>1</code></a>) object.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-PACKAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L114">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-PACKAGE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-PACKAGE</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:PACKAGE)</span></span></p>

<p><code>*PACKAGE*</code> will be bound to this package when
generating documentation for this section.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-READTABLE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L118">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-READTABLE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-READTABLE</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:READTABLE)</span></span></p>

<p><code>*READTABLE*</code> will be bound to this when generating
documentation for this section.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-TITLE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L122">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-TITLE-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-TITLE</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:TITLE)</span></span></p>

<p><code>STRING</code> or <code>NIL</code>. Used in generated documentation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-LINK-TITLE-TO-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L125">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-LINK-TITLE-TO-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-LINK-TITLE-TO</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:LINK-TITLE-TO = <code>NIL</code>)</span></span></p>

<p>A <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> or <code>NIL</code>. Used in generated documentation.</p></li>
</ul>

<p><a id='x-28MGL-PAX-3ASECTION-ENTRIES-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/pax-early.lisp#L129">[reader]</a></span> <span class="reference-object"><a href="#x-28MGL-PAX-3ASECTION-ENTRIES-20-28MGL-PAX-3AREADER-20MGL-PAX-3ASECTION-29-29" >SECTION-ENTRIES</a></span></span> <span class="locative-args">SECTION</span> <span class="locative-args">(:ENTRIES)</span></span></p>

<p>A list of strings and <a href="#x-28MGL-PAX-3AREFERENCE-20CLASS-29" title="(MGL-PAX:REFERENCE CLASS)"><code>REFERENCE</code></a> objects in the
order they occurred in <a href="#x-28MGL-PAX-3ADEFSECTION-20-28MGL-PAX-3AMACRO-29-29" title="(MGL-PAX:DEFSECTION (MGL-PAX:MACRO))"><code>DEFSECTION</code></a>.</p></li>
</ul>

<p><a id='x-28DESCRIBE-OBJECT-20-28METHOD-20NIL-20-28MGL-PAX-3ASECTION-20T-29-29-29'></a></p>

<ul>
<li><p><span class=reference-bullet><span class=reference><span class="locative-type"><a href="https://github.com/melisgl/mgl-pax/blob/e6df2d855834caedeb4f14d617df5a2e140cd8e0/src/describe.lisp#L5">[method]</a></span> <span class="reference-object"><a href="#x-28DESCRIBE-OBJECT-20-28METHOD-20NIL-20-28MGL-PAX-3ASECTION-20T-29-29-29" >DESCRIBE-OBJECT</a></span></span> <span class="locative-args">(SECTION SECTION) STREAM</span></span></p>

<p><a href="#x-28MGL-PAX-3ASECTION-20CLASS-29" title="(MGL-PAX:SECTION CLASS)"><code>SECTION</code></a> objects are printed by calling <a href="#x-28MGL-PAX-3ADOCUMENT-20FUNCTION-29" title="(MGL-PAX:DOCUMENT FUNCTION)"><code>DOCUMENT</code></a> on them
with all <a href="#x-28MGL-PAX-3A-40MGL-PAX-DOCUMENTATION-PRINTER-VARIABLES-20MGL-PAX-3ASECTION-29" title="Documentation Printer Variables">Documentation Printer Variables</a>, except for
<a href="#x-28MGL-PAX-3A-2ADOCUMENT-NORMALIZE-PACKAGES-2A-20-28VARIABLE-29-29" title="(MGL-PAX:*DOCUMENT-NORMALIZE-PACKAGES* (VARIABLE))"><code>*DOCUMENT-NORMALIZE-PACKAGES*</code></a> turned off to reduce clutter. This
method is only defined if <a href="#x-28-22mgl-pax-2Ffull-22-20ASDF-2FSYSTEM-3ASYSTEM-29" title="(\&quot;mgl-pax/full\&quot; ASDF/SYSTEM:SYSTEM)"><code>MGL-PAX/FULL</code></a> is loaded to allow non-fancy
descriptions to be printed when using <code>CL:DESCRIBE</code>.</p></li>
</ul>
  </div>
</div>
<script>$('#page-toc').toc({'selectors': 'h1,h2,h3,h4'});</script>
</body>
</html>
